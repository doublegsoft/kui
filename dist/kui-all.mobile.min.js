xhr={request:function(e,t){var i=e.url,n=e.data||e.params||{};let s=e.type||"json",a=e.success,o=e.error;n={...utils.getParameters(e.url),...n},e=e.usecase||"";let l=new XMLHttpRequest;l.timeout=1e4,l.onload=function(){let t=l.responseText;if("json"==s)try{t=JSON.parse(t)}catch(e){return void(o&&o(t))}4==l.readyState&&"200"==l.status?a&&a(t):o&&o(t)},l.onerror=function(){o&&o({error:{code:-500,message:"网络访问错误！"}})},l.ontimeout=function(){o&&o({error:{code:-501,message:"网络请求超时！"}})},l.open(t,i,!0),l.setRequestHeader("Content-Type","application/json"),l.setRequestHeader("usecase",e),"undefined"!=typeof APPTOKEN&&l.setRequestHeader("apptoken",APPTOKEN),window.user?l.setRequestHeader("_current_user",window.user.userId):l.setRequestHeader("_current_user","unauthorized user"),l.send(JSON.stringify(n))},get:function(e){var t=e.url;e.data;let i=e.success,n=e.error,s=new XMLHttpRequest;s.open("GET",t,!0),s.onload=function(){var e=s.responseText;4==s.readyState&&"200"==s.status?i&&i(e):n&&n(e)},s.send(null)},post:function(e){let t=e.url;"undefined"!=typeof HOST&&-1==t.indexOf("http")&&(t=HOST+t,e.url=t),xhr.request(e,"POST")},put:function(e){xhr.request(e,"PUT")},delete:function(e){xhr.request(e,"DELETE")},connect:function(e){xhr.request(e,"CONNECT")},upload:function(t){var e,i=t.url,n=t.data||t.params;let s=t.type||"json",a=t.success,o=t.error,l=new FormData;for(e in n)l.append(e,n[e]);l.append("file",t.file);let r=new XMLHttpRequest;r.timeout=1e4,r.onload=function(){let t=r.responseText;if("json"==s)try{t=JSON.parse(t)}catch(e){return void(o&&o(t))}4==r.readyState&&"200"==r.status?a&&a(t):o&&o(t)},t.progress&&(r.onprogress=function(e){t.progress(e.loaded,e.total)}),r.onerror=function(){o&&o({error:{code:-500,message:"网络访问错误！"}})},r.ontimeout=function(){o&&o({error:{code:-501,message:"网络请求超时！"}})},r.open("POST",i,!0),"undefined"!=typeof APPTOKEN&&r.setRequestHeader("apptoken",APPTOKEN),r.send(l)},chain:function(i){if(0!=i.length){var e=i[0];let t=e.success;xhr.promise(e,function(e){t(e),xhr.chain(i.slice(1))})}},asyncGet:function(i,n){return new Promise(function(t,e){i.success=function(e){t(e)},i.error=n,xhr.get(i)})},promise:function(i,n){return new Promise(function(t,e){i.success=function(e){if(e.error)return dialog.error(e.error.message),void(n&&n(e.error));t(e.data)},i.error=n,xhr.post(i)})},longpromise:function(i,n){let e=i.container||dom.find("#container");var t=i.tooltip||"操作处理中...";let s=dom.element(`
    <div class="page-loading hide">
      <div class="ring">${t}
        <span></span>
      </div>
    </div>
  `);return e.appendChild(s),s.classList.remove("hide"),new Promise(function(t,e){i.success=function(e){if(e.error)return setTimeout(()=>{s.classList.add("hide"),s.remove()},600),dialog.error(e.error.message),void(n&&n(e.error));setTimeout(()=>{s.classList.add("hide"),s.remove()},1200),t(e.data)},i.error=n,xhr.post(i)})},download:function(a){let o=new XMLHttpRequest;o.open("POST",a.url,!0),o.responseType="arraybuffer",o.onload=function(){if(200===this.status){let i="",n=o.getResponseHeader("Content-Disposition");if(n&&-1!==n.indexOf("attachment")){let e=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/,t=e.exec(n);null!=t&&t[1]&&(i=t[1].replace(/['"]/g,""))}var e,t,s=o.getResponseHeader("Content-Type"),s=new Blob([this.response],{type:s});void 0!==window.navigator.msSaveBlob?window.navigator.msSaveBlob(s,i):(e=window.URL||window.webkitURL,t=e.createObjectURL(s),void 0===(s=document.createElement("a")).download?window.location=t:(s.href=t,s.download=a.filename||"下载的文件",document.body.appendChild(s),s.click()),setTimeout(function(){e.revokeObjectURL(t)},100))}},o.setRequestHeader("Content-type","application/json"),"undefined"!=typeof APPTOKEN&&o.setRequestHeader("apptoken",APPTOKEN),o.send(JSON.stringify(a.params||{}))},asyncRequest:function(e,s){let a=e.url,o=e.data||e.params,l=e.type||"json",r=e.usecase||"";return new Promise((i,n)=>{if(a){let t=new XMLHttpRequest;t.timeout=1e4,t.onload=function(){let e=t.responseText;if("json"==l)try{e=JSON.parse(e)}catch(e){return console.log(e),void n(e)}(4==t.readyState&&"200"==t.status?i:n)(e)},t.onerror=function(){n({error:{code:-500,message:"网络访问错误！"}})},t.ontimeout=function(){n({error:{code:-501,message:"网络请求超时！"}})},t.open(s,a,!0),t.setRequestHeader("Content-Type","application/json"),t.setRequestHeader("usecase",r),"undefined"!=typeof APPTOKEN&&t.setRequestHeader("apptoken",APPTOKEN),o?t.send(JSON.stringify(o)):t.send(null)}})},asyncPost:function(e){let t=e.url;return"undefined"!=typeof HOST&&-1==t.indexOf("http")&&(t=HOST+t,e.url=t),xhr.asyncRequest(e,"POST")}},"undefined"!=typeof module&&(module.exports={xhr:xhr});var ajax={save:function(e){for(var t=e.url||"",i=e.form,n=e.button,s=e.success,a=i.validate(),o="",l=0;l<a.length;l++)o+=a[l].message+"<br>";""==o?(n&&n.prop("disabled",!0),i=i.formdata(),$.ajax({url:t,data:i,method:"POST",dataType:"json",success:function(e){if(void 0!==e.error)return dialog.error("保存信息出错！"),void(n&&n.prop("disabled",!1));dialog.success("保存信息成功！"),void 0!==s&&s(e),n&&n.prop("disabled",!1)},error:function(){dialog.error("系统异常！"),n&&n.prop("disabled",!1)}})):dialog.error(o)},post:function(t){var e={...utils.getParameters(t.url),...t.data};$.ajax({url:t.url,data:e,method:"POST",dataType:"json",success:function(e){void 0!==t.success&&t.success(e)}})},get:function(t){$.ajax({url:t.url,data:t.data,dataType:"json",success:function(e){void 0!==t.success&&t.success(e)}})},text:function(e,t,i){$.ajax({url:e,data:t,success:function(e){void 0!==i&&i(e)}})},view:function(e){"undefined"!=typeof schedule&&e.clear&&schedule.stop();let t=e.url,n=!1;n=void 0===e.empty||e.empty;let i=e.page;t&&0==t.indexOf(":")&&(i=t.substring(1),t=null);let s=utils.getParameters(e.url),a={...s,...e.params},o=e.title||"",l=e.containerId,r=e.success,d=null;if("string"==typeof l?(d=document.getElementById(l.trim()),null==d&&(d=document.querySelector(l.trim()))):d=l,void 0===a&&(a={}),window.parameters)for(var c in a)window.parameters[c]=a[c];t?xhr.get({url:t,success:function(e){let t=null;d&&(t=utils.append(d,e,n)),t.id&&window[t.id].show(s),r&&r(o,t,s)}}):i&&xhr.post({url:"/api/v3/common/script/stdbiz/uxd/custom_window/read",data:{customWindowId:i},success:function(e){let t=e.data.script;t=t||'<div class="full-width full-height d-flex"><img src="img/under-construction.jpeg" class="m-auto full-width"></div>';let i=null;d&&(i=utils.append(d,t,n)),r&&r(o,i,s)}})}};ajax.append=function(r){"undefined"!=typeof schedule&&r.clear&&schedule.stop();let d=dom.find("#tabsMain"),c=dom.find("#tabsOthers");if(null!=d){let o=d.children.length,i=r.url,s=r.title||"",e=r.containerId,t=r.params,a=r.success,l=null;if("string"==typeof e?(l=document.getElementById(e.trim()),null==l&&(l=document.querySelector(e.trim()))):l=e,void 0===t&&(t={}),window.parameters)for(var u in t)window.parameters[u]=t[u];p();let n=l.querySelector('div[data-url="'+i+'"]');if(null!=n){n.classList.remove("hide"),setTimeout(function(){n.classList.add("show")},150);let e=dom.find('a[data-url="'+i+'"]',d);return null!=e?void e.classList.add("active"):void dom.find('a[data-url="'+i+'"]',c).classList.add("active")}if(0==i.indexOf(":")){let t=i.substring(1);xhr.post({url:"/api/v3/common/script/stdbiz/uxd/custom_window/read",data:{customWindowId:t},success:function(e){e=e.data.script;utils.append(l,e,!1);for(let t=l.children.length-1;0<=t;t--){let e=l.children[t];if("DIV"==e.tagName){e.setAttribute("data-url",i),setTimeout(function(){e.classList.add("show")},150);break}}m(s,i),stdbiz.render(t,l.querySelector('[data-url="'+i+'"]'),{})}})}else h(i);function p(){l.querySelectorAll("div[data-url]").forEach(e=>{e.classList.remove("show"),e.classList.add("hide","fade","fadeIn")}),d.querySelectorAll("a.active").forEach(e=>{e.classList.remove("active")}),c.querySelectorAll("a.active").forEach(e=>{e.classList.remove("active")})}function m(t,i){if(""==t||null==d)return;var e=dom.element(`
      <li class="nav-item">
        <a class="nav-link head-link">
          <span></span>
          <i class="fas fa-times-circle ml-1"></i>
        </a>
      </li>
    `);dom.find("a",e).setAttribute("data-url",i),dom.bind(dom.find("i",e),"click",t=>{t.preventDefault(),t.stopPropagation();let e=t.target.parentElement,i=l.querySelector('div[data-url="'+e.getAttribute("data-url")+'"]');if(i&&i.remove(),t.target.parentElement.parentElement.remove(),0<l.querySelectorAll("div[data-url]").length&&d.children[0].click(),0<c.children.length){let e=c.children[0];e.remove(),t=e,dom.find("a",t).classList.add("nav-link"),dom.find("a",t).classList.remove("dropdown-item"),dom.find("i",t).classList.add("ml-1"),dom.find("i",t).classList.remove("float-right"),d.appendChild(t)}}),dom.bind(dom.find("a",e),"click",e=>{let t=dom.ancestor(e.target,"a");t.classList.contains("active")||(p(),t.classList.add("active"),h(a.getAttribute("data-url")))});let n=!1;if(d.querySelectorAll("li").forEach(e=>{dom.find("span",e).innerText==t&&(n=!0,dom.find("a",e).classList.add("active"))}),n)return;if(0==o)d.appendChild(e);else if(o+1>MAX_HEAD_LINK_COUNT){let e=dom.find("li:last-child",d);e.remove(),i=e,dom.find("a",i).classList.add("pointer"),dom.find("a",i).classList.remove("nav-link"),dom.find("a",i).classList.add("dropdown-item"),dom.find("i",i).classList.remove("ml-1"),dom.find("i",i).classList.add("float-right"),0==c.children.length?c.appendChild(i):c.insertBefore(i,c.children[0])}d.insertBefore(e,d.children[0]);let s=dom.find("span",e),a=dom.find("a",e);a.classList.add("active"),s.innerText=t}function h(n){l.querySelectorAll("div[data-url]").forEach(e=>{e.classList.remove("show"),e.classList.add("hide")});let t=l.querySelector('div[data-url="'+n+'"]');if(null!=t){t.classList.remove("hide"),setTimeout(function(){t.classList.add("show")},150);let e=dom.find('a[data-url="'+n+'"]',d);return null!=e?void e.classList.add("active"):void dom.find('a[data-url="'+n+'"]',c).classList.add("active")}xhr.get({url:n,success:function(e){var t=utils.getParameters(n),i=utils.append(l,e,!1);i.id&&window[i.id].show(t);for(let t=l.children.length-1;0<=t;t--){let e=l.children[t];if("DIV"==e.tagName){e.setAttribute("data-url",n),setTimeout(function(){e.classList.add("show")},150);break}}m(s,n),a&&a(s,e)}})}}else ajax.view(r)},ajax.shade=function(t){"undefined"!=typeof schedule&&schedule.stop();let e=t.url,i=t.success,n=document.querySelector(".page.full");null!=n&&n.parentElement.remove(),-1===e.indexOf(":")?xhr.get({url:e,success:function(e){e=utils.append(document.body,e);i&&i(t.title||"",e)}}):xhr.post({url:"/api/v3/common/script/stdbiz/uxd/custom_window/read",data:{customWindowId:e.substring(1)},success:function(e){e=e.data.script,e=utils.append(document.body,e);i&&i(t.title||"",e)}})},ajax.stack=function(e){"undefined"!=typeof schedule&&e.clear&&schedule.stop();var i=e.pageId,t=e.params;let n=dom.find(e.containerId);let s=!1;for(let t=0;t<n.children.length;t++){let e=n.children[t];"DIV"==e.tagName&&"true"!=e.getAttribute("data-stack-back")&&(e.classList.remove("show"),e.classList.add("hide"),e.id==i&&(e.classList.remove("hide"),e.classList.add("show"),s=!0))}s||(e.empty=!1,ajax.view(e));let a=dom.find("div[data-stack-back]",n);null==a&&(a=dom.element(`
    <div data-stack-back="true" class="pointer">
      <i class="fas fa-angle-left font-32" style="margin-top: 12px;"></i>
    </div>
  `),a.style.position="fixed",a.style.width="60px",a.style.height="60px",a.style.bottom="40px",a.style.right="40px",a.style.backgroundColor="#0C9",a.style.color="#fff",a.style.borderRadius="50px",a.style.textAlign="center",a.style.boxShadow="2px 2px 3px #999",a.style.zIndex="99",dom.bind(a,"click",e=>{a.remove(),ajax.unstack({containerId:n})}),n.appendChild(a))},ajax.unstack=function(e){e=dom.find(e.containerId);let t=e.children[e.children.length-1];t.remove();let i=e.children[e.children.length-1];i.classList.remove("hide"),i.classList.add("show")},ajax.template=function(e){var t=e.url,i=e.usecase;let n=e.containerId,s=e.templateId;var a=e.data;let o=e.success;xhr.post({url:t,usecase:i,data:a,success:function(e){var t;n&&(t=document.getElementById(s).innerHTML,t=Handlebars.compile(t)(e),document.getElementById(n).innerHTML=t),o&&o(e)}})},ajax.dialog=function(e){let t=e.title||"";var i=e.url||"",n=e.params||{};let s=e.success,a=e.end,o=!1!==e.shadeClose,l=!0===e.allowClose,r=e.width||"80%",d=e.height||"",c=e.offset||"auto";if(window.parameters)for(var u in n)window.parameters[u]=n[u];$.ajax({url:i,data:n,async:!0,success:function(e){layer.open({type:1,offset:c,title:t,closeBtn:!0==l?1:0,shade:.3,shadeClose:o,area:[r,d],content:e,success:function(e,t){let i=document.querySelector(".layui-layer-content");i.style+="; overflow: hidden;",s&&s()},end:a||function(){}})}})},ajax.video=function(e,t,i,n){layer.open({type:2,title:!1,closeBtn:1,shade:[0],area:[i+"px",n+"px"],offset:"rb",anim:2,content:[e,"no"]})},ajax.svg=function(e,i,t,n){void 0===t&&(t={}),$.ajax({url:e,data:t,success:function(e){i.empty();var t=(new XMLSerializer).serializeToString(e.documentElement);i.html(t),n&&n(e)}})},ajax.upload=function(t){let e=t.data;void 0===e&&(e={});let i=new FormData;for(var n in e)i.append(n,e[n]);$.ajax({url:t.url,data:i,method:"POST",cache:!1,contentType:!1,processData:!1,xhr:function(){var e=$.ajaxSettings.xhr();return e.upload&&t.progress&&e.upload.addEventListener("progress",function(e){e.lengthComputable&&t.progress&&t.progress(e.total,e.loaded)},!1),e},success:function(e){t.success&&t.success(e)},error:function(e){t.error&&t.error(e)}})},ajax.sidebar=function(t){let e=dom.find(t.containerId),i=t.success||function(e,t){},n=dom.find("[widget-id=right-bar]"),s=t.allowClose||!1;null!=n&&n.remove(),n=dom.element(`
    <div widget-id="right-bar" style="position: absolute; top: 0; left: 0; height: 100%; width: 100%; background: transparent; z-index: 999999;">
      <div class="right-bar fade show">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="card-header pl-3">
              <h5 class="modal-title"></h5>
              <button type="button" class="close text-danger">
                <i class="fas fa-times"></i>
              </button>
            </div>
            <div class="modal-body" style="overflow-y: auto;"></div>
            <div style="position: absolute; bottom: 24px; left: 0; width: 100%; height: 48px; border-top: 1px solid lightgrey; background: white; display:none;">
              <div widget-id="right-bar-bottom" class="mh-10 mt-2" style="float: right;"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  `),!0===t.showBottom&&(dom.find(".modal-body",n).style.marginBottom="36px",dom.find("[widget-id=right-bar-bottom]",n).parentElement.style.display=""),n.addEventListener("click",e=>{"right-bar"===e.target.getAttribute("widget-id")&&(n.children[0].classList.remove("in"),n.children[0].classList.add("out"),setTimeout(function(){n.remove()},300))}),e.appendChild(n),0==t.url.indexOf(":")&&(t.page=t.url.substring(1),t.url=null),t.url?xhr.get({url:t.url,success:function(e){dom.find(".modal-title",n).innerHTML=t.title||"",dom.find(".modal-body",n).innerHTML="",s||t.close||dom.find("button.close",n).classList.add("hidden"),dom.find("button.close",n).addEventListener("click",function(){n.children[0].classList.add("out"),n.remove(),t.close&&t.close()});e=utils.append(dom.find(".modal-body",n),e);i&&i(t.title||"",e),setTimeout(function(){n.children[0].classList.remove("out"),n.children[0].classList.add("in")},300)}}):xhr.post({url:"/api/v3/common/script/stdbiz/uxd/custom_window/read",params:{customWindowId:t.page},success:function(e){e=e.data.script;dom.find(".modal-body",n).innerHTML="";e=utils.append(dom.find(".modal-body",n),e);dom.find(".modal-title",n).innerHTML=t.title||"&nbsp;",s||t.close||dom.find("button.close",n).classList.add("hidden"),dom.find("button.close",n).addEventListener("click",function(){dom.find(".right-bar").classList.add("out"),setTimeout(function(){n.remove()},300),t.close&&t.close()}),i&&i(t.title||"",e),setTimeout(function(){n.children[0].classList.remove("out"),n.children[0].classList.add("in")},300)}})},ajax.bottombar=function(i){let e=dom.find(i.containerId),n=i.success||function(){},s=dom.find(".bottom-bar",e),a=i.allowClose||!1;null!=s&&s.remove(),s=dom.element(`
    <div class="bottom-bar fade show">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="card-header pt-2 pb-2">
            <button type="button" class="close text-danger">
              <i class="fas fa-times"></i>
            </button>
            <h5 class="modal-title"></h5>
          </div>
          <div class="modal-body" style="overflow-y: auto"></div>
        </div>
      </div>
    </div>
  `),e.appendChild(s);var t=s.parentElement.clientWidth,o=parseInt(window.getComputedStyle(s.parentElement,null).getPropertyValue("padding-left")),l=parseInt(window.getComputedStyle(s.parentElement,null).getPropertyValue("padding-right"));s.style.width=t-l-o+"px",i.url?xhr.get({url:i.url,success:function(e){dom.find(".modal-title",s).innerHTML=i.title||"",a||i.close||dom.find("button.close",s).classList.add("hidden"),dom.find("button.close",s).addEventListener("click",function(){dom.find(".bottom-bar").classList.add("out"),i.close&&i.close()}),utils.append(dom.find(".modal-body",s),e),n&&n(e),setTimeout(function(){s.classList.remove("out"),s.classList.add("in")},200)}}):xhr.post({url:"/api/v3/common/script/stdbiz/uxd/custom_window/read",data:{customWindowId:i.page},success:function(e){var t=e.data.script;utils.append(dom.find(".modal-body",s),t),dom.find(".modal-title",s).innerHTML=i.title,a||i.close||dom.find("button.close",s).classList.add("hidden"),dom.find("button.close",s).addEventListener("click",function(){dom.find(".bottom-bar").classList.add("out"),i.close&&i.close()}),n&&n(e),setTimeout(function(){s.classList.remove("out"),s.classList.add("in")},200)}})},ajax.tabs=function(e){let t=document.querySelector(e.containerId);var n=e.tabs;e.closeable;let a=dom.create("ul","nav","nav-tabs"),o=dom.create("div","tab-content"),i=dom.create("div","float-right");e=dom.create("button","btn","btn-link");function l(e,t,i,n){ajax.view({url:t,containerId:e,success:function(){window[i]&&window[i].show(n)}})}i.appendChild(e),dom.bind(e,"click",function(){let e=dom.find("li.active link",this.parentElement.parentElement);var t=e.getAttribute("data-model-url"),i=e.getAttribute("data-model-page"),n=JSON.parse("data-model-data");l(dom.find("div.tab-content div[data-model-url='"+t+"']",this.parentElement.parentElement),t,i,n)});for(let i=0;i<n.length;i++){var r=n[i];let e=dom.create("li","nav-item"),s=dom.create("a","nav-link");0==i&&s.classList.add("active"),s.setAttribute("data-model-url",r.url),s.setAttribute("data-model-data",JSON.stringify(r.data||{})),s.setAttribute("data-model-page",r.page),s.innerHTML=r.title,dom.bind(s,"click",function(){if(!this.classList.contains("active")){dom.find("a.active",this.parentElement.parentElement.parentElement).classList.remove("active"),dom.find("div.active",this.parentElement.parentElement.parentElement).classList.remove("active");var t=s.getAttribute("data-model-url"),i=JSON.parse(s.getAttribute("data-model-data")),n=s.getAttribute("data-model-page");let e=dom.find("div.tab-content div[data-model-url='"+t+"']",this.parentElement.parentElement.parentElement);this.classList.add("active"),e.classList.add("active"),""===e.innerHTML.trim()&&l(e,t,n,i)}}),e.appendChild(s),a.appendChild(e);let t=dom.create("div","tab-pane");0==i&&(t.classList.add("active"),l(t,r.url,r.page,r.data)),t.setAttribute("data-model-url",r.url),o.append(t)}t.appendChild(i),t.appendChild(a),t.appendChild(o)};var dom={value:function(e,t){const i=document.querySelector(e);if(!t)return i.value.trim();i.value=t},empty:function(e){const t=document.querySelector(e);t.value?t.value="":t.innerHTML=""},valid:function(e){const t=document.querySelector(e);return void 0!==t.value&&null!=t.value&&""!=t.value.trim()},create:function(e){var t=Array.prototype.slice.call(arguments,1);let i=document.createElement(e);for(let e=0;e<t.length;e++)i.classList.add(t[e]);return i},fix:function(e){let t=null;t="string"==typeof e?document.querySelector(e):e;var i=t.getBoundingClientRect(),n=i.left,s=i.top,a=(i.width,i.height),o=(parseInt(window.getComputedStyle(t,null).getPropertyValue("padding-left")),parseInt(window.getComputedStyle(t,null).getPropertyValue("padding-right")),parseInt(window.getComputedStyle(t,null).getPropertyValue("padding-top"))),l=parseInt(window.getComputedStyle(t,null).getPropertyValue("padding-bottom"));parseInt(window.getComputedStyle(t,null).getPropertyValue("margin-left")),parseInt(window.getComputedStyle(t,null).getPropertyValue("margin-right")),parseInt(window.getComputedStyle(t,null).getPropertyValue("margin-top")),parseInt(window.getComputedStyle(t,null).getPropertyValue("margin-bottom"));let r=t.parentElement.parentElement;e=r.getBoundingClientRect(),i=parseInt(window.getComputedStyle(r,null).getPropertyValue("padding-left"));parseInt(window.getComputedStyle(r,null).getPropertyValue("padding-right")),parseInt(window.getComputedStyle(r,null).getPropertyValue("padding-top")),parseInt(window.getComputedStyle(r,null).getPropertyValue("padding-bottom"));return t.style.position="absolute",t.style.top=s-e.top+"px",t.style.left=n-e.left+"px",t.style.width="calc(100% - "+2*i+"px )",{top:s-e.top,left:n-e.left,width:e.width-2*i,height:a+o+l}},find:function(e,t){if(t=t||document,"string"!=typeof e)return e;e=t.querySelectorAll(e);return 0==e.length?null:1==e.length?e[0]:e},ancestor:function(e,t,i){let n=null;if(i=i||"",n="string"==typeof e?document.querySelector(e):e,null==n)return null;t=t.toUpperCase();let s=n;if(""==i)for(;null!=s&&s.tagName!=t;)s=s.parentElement;else for(;null!=s&&(s.tagName!=t||!s.classList.contains(i));)s=s.parentElement;return s},element:function(e){let t=document.createElement("div");return t.innerHTML=e,t.firstElementChild},bind:function(e,t,i){let n=null;n="string"==typeof e?document.querySelector(e):e,null!=n&&n&&n.addEventListener(t,i)},model:function(e,i){let n=null;if(n="string"==typeof e?document.querySelector(e):e,void 0===i){let i={};return Array.prototype.slice.call(n.attributes).forEach(function(t){if(0==t.name.indexOf("data-model-"))if(0==t.value.indexOf("{"))try{i[utils.nameVar(t.name.slice("data-model-".length))]=JSON.parse(t.value)}catch(e){i[utils.nameVar(t.name.slice("data-model-".length))]=t.value}else i[utils.nameVar(t.name.slice("data-model-".length))]=t.value}),i}var s=Array.prototype.slice.call(arguments,2);if(0==s.length)for(const t in i)0!=t.indexOf("||")&&0!=t.indexOf("//")&&0!=t.indexOf(">>")&&("object"==typeof i[t]?n.setAttribute(utils.nameAttr(t),JSON.stringify(i[t])):n.setAttribute(utils.nameAttr(t),i[t]));else for(let t=0;t<s.length;t++){let e=s[t];0!=e.indexOf("||")&&0!=e.indexOf("//")&&0!=e.indexOf(">>")&&("object"==typeof i[e]?n.setAttribute(utils.nameAttr(e),JSON.stringify(i[e])):n.setAttribute(utils.nameAttr(e),i[e]))}},collect:function(e,n){let s=[],a=document.querySelectorAll(e);for(let i=0;i<a.length;i++){let t={};if(Array.isArray(n))for(let e=0;e<n.length;e++)t[n[e]]=a[i].getAttribute(utils.nameAttr(n[e]));else t[n]=a.getAttribute(utils.nameAttr(n[j]));s.push(t)}return s},propagate:function(e,t,i,n){let s=n(t);if(Array.isArray(i))for(let e=0;e<i.length;e++)s.setAttribute(utils.nameAttr(i[e]),t[i[e]]);else s.setAttribute(utils.nameAttr(i),t[i]);e.appendChild(s)},toggle:function(e,a){var i=document.querySelectorAll(e);for(let t=0;t<i.length;t++){let e=i[t];e.addEventListener("click",function(){let e=this.getAttribute("data-toggle"),t=e.split(">>"),i=t[0].split("+"),n=t[1].split("+"),s=!1;for(let t=0;t<i.length;t++){let e=i[t].trim();s=0==e.indexOf(".")?this.classList.contains(e.substring(1)):null!=this.querySelector(e)}if(s){for(let e=0;e<n.length;e++){let t=n[e].trim();if(0===t.indexOf("."))this.classList.add(t.substring(1));else{let e=this.querySelector(t.substring(0,t.indexOf(".")));e.classList.add(t.substring(t.indexOf(".")+1))}}for(let e=0;e<i.length;e++){let t=i[e].trim();if(0==t.indexOf("."))this.classList.remove(t.substring(1));else{let e=this.querySelector(t);e.classList.remove(t.substring(t.indexOf(".")+1))}}}else{for(let e=0;e<i.length;e++){let t=i[e].trim();if(0==t.indexOf("."))this.classList.add(t.substring(1));else{let e=this.querySelector(t.substring(0,t.indexOf(".")));e.classList.add(t.substring(t.indexOf(".")+1))}}for(let e=0;e<n.length;e++){let t=n[e].trim();if(0==t.indexOf("."))this.classList.remove(t.substring(1));else{let e=this.querySelector(t);e.classList.remove(t.substring(t.indexOf(".")+1))}}a&&resovle(this)}})}},switch:function(e,i){let n=dom.find(e),t=n.getAttribute("data-switch"),s=t.split("+");var a=n.querySelectorAll(s[0]);for(let t=0;t<a.length;t++){let e=a[t];e.addEventListener("click",function(){let t=n.querySelectorAll(s[0]);for(let e=0;e<t.length;e++)t[e].classList.remove(s[1].substring(1));e.classList.add(s[1].substring(1)),i&&i(e)})}},tabs:function(e){let n=dom.find(e);if(null!=n){let i=n.getAttribute("data-tab-active-class");for(let e=0;e<n.children.length;e++){let t=n.children[e];t.addEventListener("click",e=>{for(let t=0;t<n.children.length;t++){let e=n.children[t];e.classList.remove(i)}t.classList.add(i)})}}},top:function(e){let t=null;if(t="string"==typeof e?document.querySelector(e):e,null==t)return 0;let i=t.offsetTop;return void 0!==t.offsetParent&&(i+=dom.top(t.offsetParent)),i},formdata:function(e,t){let s=null;if(s="string"==typeof e?document.querySelector(e):e,void 0===t){let i={},n={};var a=s.querySelectorAll("input");for(let t=0;t<a.length;t++){var o=a[t];let e=o.name;var l=o.type,r=o.value;"text"==l||"number"==l||"password"==l||"hidden"==l?(i[e]=null,""!=r?-1!=e.indexOf("[]")?i[e]=[r]:i[e]=r:i[e]=""):"radio"==l?o.checked&&(i[e]=r):"checkbox"==l&&(void 0===n[e]&&(n[e]=0),o.checked&&(void 0===i[e]&&(n[e]=0,i[e]=[]),i[e].push(r)),n[e]+=1)}var d=s.querySelectorAll("select");for(let t=0;t<d.length;t++){var c=d[t];let e=c.name;i[e]=null,-1!=c.selectedIndex?-1!=e.indexOf("[]")?i[e]=[c.value]:i[e]=c.value:i[e]=""}var u,p,m=s.querySelectorAll("textarea");for(let e=0;e<m.length;e++){var h=m[e],f=h.name;i[f]=null,i[f]=h.value}for(u in n)-1==u.indexOf("[]")&&1==n[u]&&i[u]&&(i[u]=i[u][0]);for(p in i)"string"==typeof i[p]&&0==i[p].indexOf("${")&&(i[p]=i[i[p].substring(2,i[p].length-1)]);return i}function i(e,t,i){let n=dom.find("[name='"+t+"']",e);null!=n&&("INPUT"==n.tagName?"check"==n.type||(n.value=i||""):"SELECT"==n.tagName&&$("select[name='"+t+"']").val(i).trigger("change"))}for(var n in t)if("object"==typeof t[n])for(var g in t[n])i(s,n+"."+g,t[n][g]);else i(s,n,t[n])},setAttribute:function(e,t,i){let n=document.querySelectorAll(e);for(let e=0;e<n.length;e++)n[e][t]=i},removeAttribute:function(e,t){let i=document.querySelectorAll(e);for(let e=0;e<i.length;e++)i[e].removeAttribute(t)},enable:function(e){let t=document.querySelectorAll(e);for(let e=0;e<t.length;e++)t[e].disabled=!1},disable:function(e){let t;t="string"==typeof e?document.querySelectorAll(e):e;for(let e=0;e<t.length;e++)t[e].disabled=!0},index:function(e,i,t){let n;if(n="string"==typeof e?dom.find(e):e,!t){var s=n.getAttribute(i),a=n.parentElement.querySelectorAll(n.tagName);for(let t=0;t<a.length;t++){let e=a[t];if(s==e.getAttribute(i))return t}}return-1},elementAt:function(e,i,n){var s=document.querySelectorAll(e);for(let t=0;t<s.length;t++){let e=s[t];if(n==e.getAttribute(i))return{index:t,element:e}}return null},elementAtTree:function(e,i,n,s,a){var o=document.querySelectorAll(e);let l=0;for(let t=0;t<o.length;t++){let e=o[t];var r=e.getAttribute(i),d=e.getAttribute(n);if(a==d&&(l++,s==r))return{index:l,element:e}}},stack:function(t,i,n,s){let a=dom.create("a","btn","btn-link");var e=dom.create("i","fas","fa-caret-right","mr-1");a.appendChild(e),dom.bind(a,"click",function(){let e=dom.find("i",a);e.classList.contains("fa-caret-right")?(t.container.querySelectorAll("i.fa-caret-down").forEach(e=>{e.classList.remove("fa-caret-down"),e.classList.add("fa-caret-right")}),e.classList.remove("fa-caret-right"),e.classList.add("fa-caret-down"),t.stack(n,function(e){e.parentElement.classList.add("fade","fadeIn"),e.style.paddingLeft="50px",e.style.paddingRight="50px",setTimeout(function(){e.parentElement.classList.add("show")},200),s(e)})):(e.classList.remove("fa-caret-down"),e.classList.add("fa-caret-right"),i.parentElement.nextSibling.remove())})},inner:function(e){var t=e.clientHeight,i=e.clientWidth,e=getComputedStyle(e);return{height:t-parseInt(e.paddingTop)-parseInt(e.paddingBottom),width:i-parseInt(e.paddingLeft)-parseInt(e.paddingLeft)}},outer:function(e){var t=e.clientHeight,i=e.clientWidth,e=getComputedStyle(e);return{height:t+parseInt(e.marginTop)+parseInt(e.borderTop)+parseInt(e.marginBottom)+parseInt(e.borderBottom),width:i+parseInt(e.marginLeft)+parseInt(e.borderLeft)+parseInt(e.marginRight)+parseInt(e.borderRight)}},height:function(e,t,i){t=t||0,i=(i=void 0===i?dom.find("#container"):i)||document.body;let n=null;n="string"==typeof e?document.querySelector(e):e;var s=dom.top(n);let a=getComputedStyle(i,null);parseInt(a.getPropertyValue("padding-top"));e=parseInt(a.getPropertyValue("padding-bottom"));a=getComputedStyle(n,null);parseInt(a.getPropertyValue("border-top-width")),parseInt(a.getPropertyValue("border-bottom-width"));n.style.marginBottom="0px",n.style.height=i.clientHeight-s-t-e+"px",n.style.overflowY="auto"},height2:function(e,t,i){t=t||0,i=(i=void 0===i?dom.find("#container"):i)||document.body;let n=null;n="string"==typeof e?document.querySelector(e):e;dom.top(n);let s=getComputedStyle(i,null);var a=parseInt(s.getPropertyValue("padding-top")),o=parseInt(s.getPropertyValue("padding-bottom"));s=getComputedStyle(n,null);var l=parseInt(s.getPropertyValue("border-top-width")),r=parseInt(s.getPropertyValue("border-bottom-width")),d=parseInt(s.getPropertyValue("border-top-width")),e=parseInt(s.getPropertyValue("border-bottom-width"));n.style.marginBottom="0px";i=i.getBoundingClientRect();n.style.height=i.height-a-o-l-r-d-e-t+"px",n.style.overflowY="auto"},templatize:function(e,t){let i=Handlebars.compile(e);t=i(t);return dom.element(t)}};dom.render=function(e,t,s){let i=null;function n(e,t,i){let n=dom.find("[name='"+t+"']",e);null!=n&&("DIV"===n.nodeName&&s?i&&function(e,t){let i=dom.find("[value='"+t+"']",e);null!=i&&(i.checked=!0)}(n,i):"INPUT"==n.tagName?"radio"==n.type||(n.value=i):"SPAN"==n.tagName?i&&(n.innerHTML=i):"SELECT"==n.tagName&&$("select[name='"+t+"']").val(i).trigger("change"))}for(var a in i="string"==typeof e?document.querySelector(e):e,t)if("object"==typeof t[a])for(var o in t[a])n(i,a+"."+o,t[a][o]);else n(i,a,t[a])},dom.popup=function(e,t){let i=dom.create("div","full-width","full-height","position-absolute");return i.style.background="transparent",dom.bind(i,"click",e=>{i.remove(),t.remove()}),document.body.appendChild(i),e.appendChild(t),i},dom.html=function(e){let t=dom.element("<div></div>");return t.appendChild(e),t.innerHTML},dom.init=function(e,t){if(t){if(0==t.children.length){let e=t.getAttribute("name");if(e&&""!=e||(e=t.getAttribute("widget-id")),!e||""==e)return}for(let e=0;e<t.children.length;e++){var i=t.children[e];dom.init(i)}}};let utils={};function ListView(e){this.url=e.url,this.usecase=e.usecase,this.params=e.params||{},this.lazy=!0===e.lazy,this.hoverable=!1!==e.hoverable,this.activateable=!0===e.activateable,this.itemClass=e.itemClass||[],this.emptyHtml=e.emptyHtml,this.idField=e.idField,this.compare=e.compare||function(e,t){return!1},this.selections=e.selections||[],this.local=e.local||[],this.create=e.create||function(e,t){},this.complete=e.complete,this.draggable=!0===e.draggable,this.start=e.start||0,this.limit=e.limit||-1,this.borderless=e.borderless||!1,this.height=e.height,this.tooltip=e.tooltip,this.required=e.required||!1,this.onRemove=e.onRemove,this.onReorder=e.onReorder,this.onCheck=e.onCheck,this.onSelect=e.onSelect,this.onFilter=e.onFilter,this.onAdd=e.onAdd,this.onSearch=e.onSearch,this.onClick=e.onClick,this.observableItems=new rxjs.Observable}function Timeline(e){this.url=e.url,this.params=e.params||{},this.data=e.data||[],this.fnTitle=e.title||function(e,t){return""},this.fnSubtitle=e.subtitle||function(e,t){return""},this.fnContent=e.content||function(e,t){return""},this.onComplete=e.onComplete}function Tabs(e){this.navigator=dom.find(e.navigatorId),this.content=dom.find(e.contentId),this.tabActiveClass=e.tabActiveClass,this.tabs=e.tabs,this.lazy=!1!==e.lazy,this.autoClear=!0===e.autoClear}function Chat(e){this.host=e.host||"",this.userId=e.userId,this.userType=e.userType,this.getConversations=e.getConversations,this.onInit=e.onInit||async function(){},this.onSendTextMessage=e.onSendTextMessage,this.onSendImageMessage=e.onSendImageMessage,this.onSendAudioMessage=e.onSendAudioMessage,this.onSendVideoMessage=e.onSendVideoMessage,this.onSendCustomMessage=e.onSendCustomMessage,this.onRevokeMessage=e.onRevokeMessage||function(e){},this.onMessageReceived=e.onMessageReceived,this.onUnreadMessages=e.onUnreadMessages||function(e){},this.onReadMessages=e.onReadMessages||function(e){}}function MobileWizard(e){this.topic=e.topic,this.steps=e.steps||[],this.root=dom.element(`
    <div style="width: 100%">
      <div class="wizard-progress">
      </div>
      <div class="wizard-content">
      </div>
    </div>
  `)}function MobileForm(e){this.fields=e.fields,this.readonly=e.readonly||!1,this.saveOpt=e.save,this.readOpt=e.read}utils.append=function(e,t,i){let n=dom.create("div");n.style.height="100%",n.style.width="100%",i=i||!1;let s=document.createRange();t=s.createContextualFragment(t);!1!==i&&(e.innerHTML=""),e.appendChild(n),n.appendChild(t);t=dom.find("[id^=page]",n);return t?n.setAttribute("page-id",t.id):n.setAttribute("page-id","page.not.in.database"),{id:t?t.id:"",container:n}},utils.message=function(i){if(i||0!=i.length){let t="";for(let e=0;e<i.length;e++)t+=i[e].message+"<br>";return t}},utils.prompt=function(t){if(t||0!=t.length)for(let e=0;e<t.length;e++)$(t[e].element).addClass("is-invalid")},utils.render=function(e,t,i){t=document.getElementById(t).innerHTML;let n=Handlebars.compile(t);i=n(i);let s=document.getElementById(e);s.innerHTML=i},utils.assemble=function(e,t){if("object"==typeof e)for(var i in e){var n=e[i];"object"==typeof n&&(e[i+"Id"]=n.id),"id"==i?e[t+"Id"]=n:"name"==i&&(e[t+"Name"]=n)}},utils.in=function(e){var t=e.split(" ");let i=null,n=[];1==t.length?(i=document.getElementById(e),n.push(i)):(i=document.getElementById(t[0]),n=i.querySelectorAll(t[1]));for(let e=0;e<n.length;e++)i=n[e],i.addEventListener("animationend",function(){this.classList.remove("animated","fadeIn"),this.style.display="",this.removeEventListener("animationend",function(){}),this.removeEventListener("animationstart",function(){})}),i.classList.remove("fadeOut","hide"),i.classList.add("animated","fadeIn","show")},utils.out=function(e){var t=e.split(" ");let i=null,n=[];1==t.length?(i=document.getElementById(e),n.push(i)):(i=document.getElementById(t[0]),n=i.querySelectorAll(t[1]));for(let e=0;e<n.length;e++)i=n[e],i.addEventListener("animationend",function(){this.classList.remove("animated","fadeOut"),this.removeEventListener("animationend",function(){})}),i.classList.remove("fadeIn","show"),i.classList.add("animated","fadeOut","hide")},utils.nameAttr=function(i){const n=[];let s="";for(let t=0;t<i.length;t++){let e=i.charAt(t);e==e.toUpperCase()?(n.push(s),s="",s+=e.toLowerCase()):s+=e}return""!=s&&n.push(s),"data-model-"+n.join("-")},utils.nameVar=function(t){if(-1==t.indexOf("-"))return t;var i=t.split("-");let n="";for(let e=0;e<i.length;e++){const t=i[e];0==e?n+=t:n+=t.charAt(0).toUpperCase()+t.slice(1)}return n},utils.camelcase=function(t,e){if(-1==t.indexOf(e))return t;var i=t.split(e);let n="";for(let e=0;e<i.length;e++){const t=i[e];0==e?n+=t:n+=t.charAt(0).toUpperCase()+t.slice(1)}return n},utils.pascalcase=function(t,e){if(-1==t.indexOf(e))return t.charAt(0).toUpperCase()+t.slice(1);var i=t.split(e);let n="";for(let e=0;e<i.length;e++){const t=i[e];n+=t.charAt(0).toUpperCase()+t.slice(1)}return n},utils.clone=function(e,t){for(var i in e=e||{})t[i]=e[i]},utils.get=function(t){var i=Array.prototype.slice.call(arguments,1);let n={};for(let e=0;e<i.length;e++)n[i[e]]=t[i[e]];return n},utils.isEmpty=function(e){let t=0;for(var i in e)t++;return 0==t},utils.isBlank=function(e){let t=0;for(var i in e)null!=e[i]&&""!==e[i]&&t++;return 0==t},utils.getParameter=function(e,t){t=t.replace(/[\[\]]/g,"\\$&");let i=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)"),n=i.exec(e);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},utils.getParameters=function(e){if(-1==e.indexOf("?"))return{};let i={},n=(e=e.substring(e.indexOf("?")+1)).split("&");for(let t=0;t<n.length;t++){let e=n[t].split("=");if(1==e.length)return{};i[e[0].trim()]=decodeURIComponent(e[1].trim())}return i},utils.isExisting=(t,i,n)=>{for(let e=0;e<t.length;e++)if(t[e][n]===i[n])return!0;return!1},"undefined"==typeof dialog&&(dialog={}),dialog.alert=function(e){layer.open({type:0,icon:0,offset:"150px",shade:0,shadeClose:!0,title:"警告",content:e})},dialog.info=function(e){layer.open({type:0,offset:"150px",shade:0,shadeClose:!0,title:"信息",content:e})},dialog.info2=function(e){layer.open({type:0,offset:"100px",shade:.3,shadeClose:!0,title:"信息",content:e})},dialog.error=function(e){e=e.replaceAll("\n","<br>"),layer.open({type:0,icon:2,offset:"150px",shade:0,shadeClose:!0,title:"错误",content:e})},dialog.success=function(e,i){i?layer.open({type:0,icon:1,offset:"150px",shade:0,shadeClose:!0,title:"成功",content:e,btn:["确定","确定并返回"],yes:function(e,t){layer.close(e)},btn2:function(e,t){layer.close(e),i()}}):layer.open({type:0,icon:1,offset:"150px",shade:0,shadeClose:!0,title:"成功",content:e})},dialog.confirm=function(e,t){layer.confirm(e,{title:"确认",btn:["确定","取消"]},function(e){layer.close(e),t()},function(){})},dialog.view=function(e){let i=e.title;var t=e.url;$(document.body);$("#dialogApplication").length&&$("#dialogApplication").remove();let n=[];e.save&&n.push({text:"保存",class:"btn-save",success:e.save}),$.ajax({url:t,success:function(e){let t=Handlebars.compile('<div class="modal fade" id="dialogApplication">  <div class="modal-dialog modal-dialog-centered">    <div class="modal-content">      <div class="modal-header">        <h4 class="modal-title">{{title}}</h4>        <button type="button" class="close" data-dismiss="modal">&times;</button>      </div>      <div id="dialogApplicationBody" class="modal-body">{{body}}</div>      <div class="modal-footer">        {{#each buttons}}        <button type="button" class="btn {{class}}" data-dismiss="modal">{{text}}</button>        {{/each}}        <button type="button" class="btn btn-close" data-dismiss="modal">关闭</button>      </div>    </div>  </div></div>');e=t({title:i,body:e,buttons:n});$(document.body).append(e),$("#dialogApplication").modal("show")}})},dialog.select=function(t){ajax.view({url:t.url,success:function(e){layer.open({type:0,icon:1,offset:"150px",shade:.5,shadeClose:!0,title:t.title,content:e})}})},dialog.simplelist=async function(i){var n=await xhr.promise({url:i.url,params:i.params||{}}),e=dom.element(`
    <div>
      <ul class="list-group"></ul>
    </div>
  `);let s=dom.find("ul",e);for(let t=0;t<n.length;t++){var a=n[t];let e=dom.create("li","list-group-item","list-group-item-action");dom.model(e,a),e.innerText=a[i.fields.text],s.appendChild(e)}layer.open({type:0,closeBtn:1,btn:[],shade:.5,shadeClose:!0,title:"",content:e.innerHTML,success:function(e,t){e.get(0).querySelectorAll("li").forEach((e,t)=>{dom.bind(e,"click",e=>{layer.close(layer.index);e=dom.model(e.target);i.onAccept(e)})})}})},dialog.html=function(i){layer.open({type:0,closeBtn:1,offset:"150px",shade:.5,area:["50%",""],shadeClose:!0,title:i.title||"&nbsp;",content:i.html,btn:["确定","关闭"],success:function(e,t){i.load&&i.load(e,t)},yes:function(e){layer.close(e),i.success()},btn1:function(){}})},dialog.iframe=function(e){layer.open({title:e.title,type:2,area:[e.width,e.height],content:e.url,resize:!1,maxmin:!0,shade:!1,success:e.success||function(e,t){}})},ListView.prototype.fetch=async function(e){var t={};e=e||{},utils.clone(this.params,t),utils.clone(e,t);this.url&&(this.data=this.data||{},this.data.start=this.start,this.data.limit=this.limit,t=await xhr.promise({url:this.url,params:t}),Array.prototype.push.apply(this.local,t)),0==this.local.length?this.emptyHtml&&(this.container.innerHTML=this.emptyHtml):this.append(this.local)},ListView.prototype.render=function(t,e){this.container="string"==typeof t?document.querySelector(t):t,this.container.innerHTML="";t=this.height-37;if(this.onFilter){let e=dom.element(`
      <div class="input-group position-sticky" style="top: 0; left: 0; z-index: 10;">
        <div class="input-group-prepend">
          <span class="input-group-text" style="border-bottom-left-radius: unset;">
            <i class="fas fa-search"></i>
          </span>
        </div>
        <input class="form-control" placeholder="搜索..."  style="border-bottom-right-radius: unset;">
        <div class="input-group-append">
          <span class="input-group-text pointer text-primary" style="border-bottom-right-radius: unset;">
            <i class="fas fa-plus"></i>
          </span>
          <span class="input-group-text" style="border-bottom-right-radius: unset;">
            <i class="fas fa-question icon-general"></i>
          </span>
          <span class="input-group-text" style="border-bottom-right-radius: unset;">
            <i class="fas fa-asterisk icon-required"></i>
          </span>
        </div>
      </div>
    `),t=dom.find("input",e);dom.bind(t,"input",e=>{clearTimeout(this.delayToSearch),this.delayToSearch=setTimeout(()=>{this.onFilter(this,t.value)},500)}),this.required||e.children[2].children[2].remove(),this.tooltip||e.children[2].children[1].remove(),this.onAdd||e.children[2].children[0].remove(),0==e.children[2].children.length&&e.children[2].remove(),this.container.appendChild(e)}let i=dom.create("ul","list-group","full-width");if(this.borderless&&i.classList.add("b-a-0"),this.onFilter){let e=dom.create("div");e.style.height=t+"px",e.style.overflowY="auto",e.style.border="1px solid rgba(0, 0, 0, 0.125)",e.style.borderTop="",e.appendChild(i),this.container.appendChild(e)}else this.container.appendChild(i);!1!==e&&!0!==this.lazy&&this.reload()},ListView.prototype.reload=function(e){e=e||{};let t=dom.find("ul",this.container);t.innerHTML="",this.start=0,this.url&&(this.local=[]),this.fetch(e)},ListView.prototype.load=function(){this.start=this.local.length,this.fetch()},ListView.prototype.remove=function(i){if(this.idField){var n=dom.find("ul",this.container);for(let t=0;t<n.children.length;t++){let e=n.children[t];dom.model(e)[this.idField]===i[this.idField]&&e.remove()}}},ListView.prototype.append=function(e,t){let n=this,s=this.container.querySelector("ul");var a=s.querySelectorAll("li").length;if(Array.isArray(e)){var i=e;for(let e=0;e<i.length;e++)this.append(i[e]);n.complete&&n.complete(e)}else{var o=e;if(this.idField)for(let e=0;e<s.children.length;e++){var l=s.children[e];if(dom.model(l)[this.idField]===o[this.idField])return}let i=dom.create("li","list-group-item");!1!==this.hoverable&&i.classList.add("list-group-item-action"),!0===this.activateable&&dom.bind(i,"click",e=>{for(let t=0;t<i.parentElement.children.length;t++){let e=i.parentElement.children[t];e.classList.remove("active")}i.classList.add("active")});for(let e=0;e<this.itemClass.length;e++)i.classList.add(this.itemClass[e]);this.borderless&&i.classList.add("b-a-0"),this.onClick&&dom.bind(i,"click",this.onClick),i.style.paddingLeft="16px",i.style.paddingRight="16px",i.style.paddingTop="8px",i.style.paddingBottom="8px",i.style.display="flex",i.style.alignItems="center",this.onFilter&&(i.style.borderLeftWidth="0",i.style.borderRightWidth="0",i.style.borderBottomWidth="0");a=this.create(a,o,i);if(this.onCheck){let t=dom.element(`
        <input class="pointer checkbox color-info is-outline mr-2" type="checkbox">
      `);for(let e=0;e<this.selections.length;e++)if(this.compare(this.selections[e],o)){t.setAttribute("checked",!0);break}dom.bind(t,"change",function(){n.onCheck(this.checked,dom.model(this),this)}),dom.model(t,o),i.appendChild(t)}i.appendChild(a),this.idField&&i.setAttribute("data-list-item-id",o[this.idField]),dom.model(i,o),"number"==typeof t?t<0?s.insertBefore(i,s.children[s.children.length+t]):s.insertBefore(i,s.children[t]):s.appendChild(i),this.onRemove&&(t=dom.element(`
        <a class="btn text-danger float-right font-18" style="padding: 0; margin-left: auto;">
          <i class="fas fa-times" style=""></i>
        </a>
      `),dom.bind(t,"click",function(e){e.stopPropagation(),n.onRemove(this.parentElement,dom.model(this.parentElement))}),dom.model(t,o),i.appendChild(t)),this.onReorder?this.setReorderable(i):this.draggable&&(i.setAttribute("draggable","true"),i.addEventListener("dragover",function(e){e.preventDefault()}),i.addEventListener("dragstart",function(e){}))}},ListView.prototype.replace=function(i){var n=this.container.querySelector("ul");for(let t=0;t<n.children.length;t++){let e=n.children[t];if(dom.model(e)[this.idField]===i[this.idField]){dom.model(e,i),e.innerHTML="",e.appendChild(this.create(t,i));break}}},ListView.prototype.search=function(i){var n=this.container.querySelector("ul");for(let t=0;t<n.children.length;t++){let e=n.children[t];-1!=e.innerText.indexOf(i)?e.style.display="":e.style.display="none"}},ListView.prototype.setReorderable=function(e){let t=dom.find("ul",this.container);t.addEventListener("dragover",function(e){e.preventDefault()}),t.ondrop=e=>{this.onReorder&&this.onReorder(dom.model(this.draggingElement),this.getItemIndex(this.draggingElement),this.draggingElementOriginalIndex),this.draggingElement.style.opacity="",this.draggingElement=null,this.clonedDraggingElement=null},e.setAttribute("draggable","true"),e.ondragover=e=>{var t,i=dom.ancestor(e.target,"li");let n=i.parentElement;i!=this.draggingElement&&((t=this.getItemIndex(i))<this.draggingElementIndex?n.insertBefore(this.draggingElement,i):t>this.draggingElementIndex&&(null==i.nextElementSibling?n.appendChild(this.draggingElement):n.insertBefore(this.draggingElement,i.nextElementSibling)),this.draggingElementIndex=t,e.preventDefault())},e.ondragstart=e=>{let t=dom.ancestor(e.target,"li");t.parentElement,e.layerX;var i=e.layerY,i=e.target.offsetTop+i;this.clonedDraggingElement=t.cloneNode(!0),console.log(this.clonedDraggingElement),this.draggingElement=t,this.draggingElement.style.opacity="0.3",this.draggingElementIndex=this.getItemIndex(t),this.draggingElementOriginalIndex=this.draggingElementIndex,e.dataTransfer.setData("id",t.getAttribute("data-list-item-id")),e.dataTransfer.setData("y",i)}},ListView.prototype.getItemIndex=function(t){var i=t.parentElement;for(let e=0;e<i.children.length;e++)if(t==i.children[e])return e},ListView.prototype.setHeight=function(e){let t=this.container.querySelector("ul");t.style.height=e+"px"},ListView.prototype.activate=function(e){let t=this.container.querySelector("ul");for(let e=0;e<t.children.length;e++)t.children[e].classList.remove("active");e.classList.add("active")},ListView.prototype.subscribe=function(e,t){},Timeline.prototype.createTile=function(e,t){var i,n=dom.element(`
    <li class="timeline-item">
      <div class="time"></div>
      <div class="small text-muted"></div>
      <p></p>
    </li>
  `);let s=n.children[0],a=n.children[1],o=n.children[2];return this.fnTitle&&(void 0===(i=this.fnTitle(e,t))?s.innerHTML="":"string"==typeof i||"number"==typeof i?s.innerHTML=i:s.appendChild(i)),this.fnSubtitle&&(void 0===(i=this.fnSubtitle(e,t))?a.innerHTML="":"string"==typeof i||"number"==typeof i?a.innerHTML=i:a.appendChild(i)),this.fnContent&&(void 0===(t=this.fnContent(e,t))?o.innerHTML="":"string"==typeof t||"number"==typeof t?o.innerHTML=t:o.appendChild(t)),n},Timeline.prototype.render=function(e,t){let i=this;this.container="string"==typeof e?document.querySelector(e):e,this.container.innerHTML="",t=t||{};let n=dom.create("ul","timeline-simple");this.container.appendChild(n);e={};if(utils.clone(this.params,e),utils.clone(t,e),this.url)xhr.post({url:this.url,params:e,success:function(e){if(e.data){var t=e.data;console.log(t);for(let e=0;e<t.length;e++)n.appendChild(i.createTile(t[e],e))}}});else for(let e=0;e<i.data.length;e++)n.appendChild(i.createTile(i.data[e],e));i.onComplete&&i.onComplete()},Tabs.prototype.loadPage=function(e,t,i,n){let s=dom.templatize('<div data-tab-content-id="{{id}}"></div>',{id:e});ajax.view({url:t,containerId:s,success:n||function(){}}),!0===i&&(s.style.display="none"),this.content.appendChild(s)},Tabs.prototype.render=function(){let o=this;this.content.innerHTML="",this.navigator.innerHTML="",this.slider=dom.element('<div class="slider"></div>'),this.navigator.appendChild(this.slider),this.tabs.forEach((s,e)=>{s.style=s.style||"padding: 0 16px;";let a=dom.templatize(`
      <div class="nav-item font-weight-bold mr-0 pointer" style="{{style}}"
           data-tab-url="{{{url}}}"
           data-tab-id="{{{id}}}" >{{{text}}}</div>
    `,s);o.navigator.appendChild(a),dom.bind(a,"click",t=>{if(!a.classList.contains(o.tabActiveClass)){for(let t=0;t<o.navigator.children.length;t++){let e=o.navigator.children[t];e.classList.remove(o.tabActiveClass)}for(let e=0;e<o.content.children.length;e++)o.content.children[e].style.display="none";o.activate(a),!0===this.autoClear&&(this.content.innerHTML="");let e=dom.find("div[data-tab-content-id="+a.getAttribute("data-tab-id")+"]",o.content);var i,n;null!=e?e.style.display="":(i=a.getAttribute("data-tab-id"),n=a.getAttribute("data-tab-url"),s.onClicked?s.onClicked(t):o.loadPage(i,n,!1,s.success))}}),!0===o.lazy?0==e&&(o.activate(a),s.onClicked?s.onClicked(ev):o.loadPage(s.id,s.url,!1,s.success)):0==e?(o.activate(a),s.onClicked?s.onClicked(ev):o.loadPage(s.id,s.url,!1,s.success)):s.onClicked?s.onClicked(ev):o.loadPage(s.id,s.url,!0,s.success)})},Tabs.prototype.activate=function(e){e.classList.add(this.tabActiveClass),this.slider.style.width=e.clientWidth+"px",this.slider.style.left=e.offsetLeft+"px"},Chat.MESSAGE_TYPE_TEXT="TEXT",Chat.MESSAGE_TYPE_IMAGE="IMAGE",Chat.MESSAGE_TYPE_AUDIO="AUDIO",Chat.MESSAGE_TYPE_VIDEO="VIDEO",Chat.MESSAGE_TYPE_PATIENT="PATIENT",Chat.MESSAGE_TYPE_CUSTOM="CUSTOM",Chat.MESSAGE_STATUS_UNREAD="01",Chat.MESSAGE_STATUS_READ="02",Chat.MESSAGE_STATUS_REVOKE="90",Chat.prototype.init=async function(e){await this.onInit();this.scheduleName=e;var t=this.userId+"@"+this.userType,i=await xhr.promise({url:this.host+"/api/v3/common/script/tim/user_signature",params:{userId:t}}),e={SDKAppID:i.appId};this.tim=TIM.create(e),this.tim.setLogLevel(1),this.tim.registerPlugin({"tim-upload-plugin":TIMUploadPlugin}),this.tim.login({userID:t,userSig:i.signature}),this.tim.on(TIM.EVENT.SDK_READY,function(e){}),this.tim.on(TIM.EVENT.MESSAGE_RECEIVED,s=>{for(let n=0;n<s.data.length;n++){let e=s.data[n],t=Chat.MESSAGE_TYPE_TEXT,i=null;"TIMCustomElem"===e.type?(i=JSON.parse(e.payload.data).messageContent,i.imagepath?t=Chat.MESSAGE_TYPE_IMAGE:i.audiopath?t=Chat.MESSAGE_TYPE_AUDIO:i.archiveId&&(t=Chat.MESSAGE_TYPE_PATIENT)):i=e.payload.text,this.onMessageReceived({senderId:e.conversationID.substring(3),messageTime:moment(1e3*s.data[n].time).format("YYYY-MM-DD HH:mm"),messageType:t,messageContent:i})}})},Chat.prototype.getConversations=async function(){var e,t=await xhr.promise({url:this.host+"/api/v3/common/script/stdbiz/pim/conversation_message/find",params:{status:Chat.MESSAGE_STATUS_UNREAD,receiverId:this.userId}});let i={};for(let e=0;e<t.length;e++){var n=t[e],s=n.senderId+"#"+n.senderType;if(i[s]){let e=i[s];e.createTime=n.createTime,e.messages.push(n)}else{let e={messages:[]};i[s]=e,e.id=s,e.createTime=n.createTime,e.name=n.senderType,e.senderId=n.senderId,e.senderType=n.senderType,e.messages.push(n)}}let a=[];for(e in i)a.push(i[e]);return a},Chat.prototype.fetchMessages=async function(e,t,i){let n="";n=e>this.userId?e+"&"+this.userId:this.userId+"&"+e;var s=await xhr.promise({url:this.host+"/api/v3/common/script/stdbiz/pim/conversation_message/find",params:{conversationId:n,_order_by:"messageTime asc"}});let a=[],o=null;for(let n=0;n<s.length;n++){var l=s[n],r=moment(l.createTime).format("YYYY-MM-DD HH:mm");r!=o&&(o=r,a.push({createTime:r,groupingMessages:[{direction:l.senderId==this.userId?"outgoing":"incoming",messages:[]}]}));let e=a[a.length-1],t=e.groupingMessages[e.groupingMessages.length-1],i="";i=l.senderId==this.userId?"outgoing":"incoming",t.direction===i?t.messages.push(l):e.groupingMessages.push({direction:i,messages:[l]})}return a},Chat.prototype.fetchUnreadMessages=function(){let t=this;xhr.promise({url:this.host+"/api/v3/common/script/stdbiz/pim/conversation_message/find",params:{status:Chat.MESSAGE_STATUS_UNREAD,receiverId:this.userId,receiverType:this.userType}}).then(e=>{t.onUnreadMessages(e)})},Chat.prototype.sendMessage=async function(e,t,i,n,s){return s=s||this.userId+"&"+e,"string"==typeof n&&(n=n.replace("\\","\\\\")),xhr.promise({url:this.host+"/api/v3/common/script/stdbiz/pim/conversation_message/save",params:{conversationId:s,senderId:this.userId,senderType:this.userType,receiverId:e,receiverType:t,messageType:i,messageTime:"now",messageContent:n,createTime:"now",status:Chat.MESSAGE_STATUS_UNREAD,"||stdbiz/pim/conversation/merge":{conversationId:s,conversationName:s,unreadCount:1,lastConversationTime:"now"}}})},Chat.prototype.sendTextMessage=async function(e,t,i,n){var s=e+"@"+t,n=await this.sendMessage(e,t,Chat.MESSAGE_TYPE_TEXT,i,n),i=this.tim.createTextMessage({to:s,conversationType:TIM.TYPES.CONV_C2C,payload:{id:n.conversationMessageId,text:i}});return this.tim.sendMessage(i)},Chat.prototype.sendImageMessage=async function(e,t,i,n){var s=e+"@"+t,i=await xhr.promise({url:this.host+"/api/v3/common/image",params:{directoryKey:"chat",filedata:i.data.substring(i.data.indexOf(",")+1),fileext:i.ext}}),n=await this.sendMessage(e,t,Chat.MESSAGE_TYPE_IMAGE,JSON.stringify({imagepath:i.filepath,thumbnail:i.thumbnail}),n),i=this.tim.createCustomMessage({to:s,conversationType:TIM.TYPES.CONV_C2C,payload:{data:JSON.stringify({messageType:Chat.MESSAGE_TYPE_IMAGE,messageContent:{id:n.conversationMessageId,imagepath:i.filepath,thumbnail:i.thumbnail}})}});return this.tim.sendMessage(i)},Chat.prototype.sendAudioMessage=async function(e,t,i,n){var s=e+"@"+t,i=await xhr.promise({url:this.host+"/api/v3/common/audio",params:{directoryKey:"chat",filedata:i.data.substring(i.data.indexOf(",")+1),fileext:"ogg"}}),n=await this.sendMessage(e,t,Chat.MESSAGE_TYPE_AUDIO,JSON.stringify({audiopath:i.filepath,duration:i.duration}),n),i=this.tim.createCustomMessage({to:s,conversationType:TIM.TYPES.CONV_C2C,payload:{data:JSON.stringify({messageType:Chat.MESSAGE_TYPE_AUDIO,messageContent:{id:n.conversationMessageId,audiopath:i.filepath,duration:i.duration}})}});return this.tim.sendMessage(i)},Chat.prototype.sendPatientMessage=async function(e,t,i,n){var s=e+"@"+t,n=await this.sendMessage(e,t,Chat.MESSAGE_TYPE_PATIENT,JSON.stringify(i),n);i.id=n.conversationMessageId;i=this.tim.createCustomMessage({to:s,conversationType:TIM.TYPES.CONV_C2C,payload:{data:JSON.stringify({messageType:Chat.MESSAGE_TYPE_PATIENT,messageContent:i})}});return this.tim.sendMessage(i)},Chat.prototype.readMessages=function(e){let t=this;xhr.promise({url:this.host+"/api/v3/common/script/stdbiz/pim/conversation_message/update",params:{senderId:e,readTime:"now",status:Chat.MESSAGE_STATUS_READ}}).then(e=>{t.onReadMessages(e)})},Chat.prototype.revokeMessage=function(t){return xhr.promise({url:this.host+"/api/v3/common/script/stdbiz/pim/conversation_message/update",params:{messageId:t,status:Chat.MESSAGE_STATUS_REVOKE}}).then(e=>{this.onRevokeMessage(t)})},Chat.prototype.stop=function(){schedule.stop(this.scheduleName)},"undefined"!=typeof module&&(module.exports={Chat:Chat}),MobileWizard.prototype.render=function(e,t){this.container=dom.find(e),this.content=dom.find("div.wizard-content",this.root);let n=dom.find("div.wizard-progress",this.root);for(let i=0;i<this.steps.length;i++){let e=this.steps[i];var s=i+1;let t=dom.element(`
      <div class="step-${s}" widget-on-render="" data-step="${i}" style="cursor: pointer;">
        <strong class="title"></strong>
      </div>
    `);e.index=i,t.style.width=100/this.steps.length+"%",!0===e.active&&(this.current=e),dom.find("strong.title",t).innerHTML=e.title,n.appendChild(t)}this.container.appendChild(this.root),this.display(this.current)},MobileWizard.prototype.display=function(e){let t=dom.find('div[data-step="'+e.index+'"]',this.root);t.classList.remove("completed"),t.classList.add("active"),kuim.navigateWidget(e.url,this.content,{wizard:this})},MobileWizard.prototype.commit=function(e){let t=dom.find("div.active",this.root);var i=parseInt(t.getAttribute("data-step"));t.classList.remove("active"),t.classList.add("completed"),this.display(this.steps[i+1])},MobileWizard.prototype.rollback=function(){let e=dom.find("div.step.active",this.container);var t=parseInt(e.getAttribute("data-step"));e.classList.remove("active"),this.display(this.steps[t-1])},MobileForm.prototype.render=async function(e){var t=await this.root();e.appendChild(t)},MobileForm.prototype.root=async function(){let i=dom.element(`
    <div class="form form-horizontal"></div>
  `);for(let t=0;t<this.fields.length;t++){var n=this.fields[t];let e=null;e="date"===n.input?this.buildDate(n):"select"===n.input?await this.buildSelect(n):"hidden"===n.input?dom.templatize(`
        <input type="hidden" name="{{name}}">
      `,n):dom.templatize(`
        <div class="form-group row">
          <label class="col-form-label col-24-06">{{title}}</label>
          <div class="col-24-18">
            <input type="text" name="{{name}}" class="form-control">
          </div>
        </div>
      `,n),i.appendChild(e)}return i},MobileForm.prototype.buildDate=function(e){e=dom.templatize(`
    <div class="form-group row">
      <label class="col-form-label col-24-06">{{title}}</label>
      <div class="col-24-18 d-flex">
        <label class="col-form-label"></label>
        <input type="hidden" name="{{name}}">
        <span class="ml-auto material-icons font-16 position-relative" style="top: 5px; left: -2px;">calendar_today</span>
      </div>
    </div>
  `,e);return dom.bind(e,"click",t=>{let e=new Rolldate({confirm:e=>{dom.find("label",t.target).innerHTML=moment(e).format("YYYY年MM月DD日"),dom.find("input",t.target).value=moment(e).format("YYYY-MM-DD HH:mm:ss")}});e.show()}),e},MobileForm.prototype.buildSelect=async function(t){var e=dom.templatize(`
    <div class="form-group row">
      <label class="col-form-label col-24-06">{{title}}</label>
      <div class="col-24-18 d-flex">
        <label class="col-form-label"></label>
        <input type="hidden" name="{{name}}">
        <span class="ml-auto material-icons font-20 position-relative" style="top: 3px;">expand_more</span>
      </div>
    </div>
  `,t);let i=t.values;if(!i&&t.url){var n=await xhr.promise({url:t.url,params:{}});i=[];for(let e=0;e<n.length;e++)i.push({text:n[e][t.textField],value:n[e][t.valueField]})}return dom.bind(e,"click",t=>{let e=new Rolldate({format:"oo",values:i,confirm:e=>{dom.find("label",t.target).innerHTML=e.text,dom.find("input",t.target).value=e.value}});e.show()}),e},Handlebars.registerHelper("ifeq",function(e,t,i){return e==t?i.fn(this):i.inverse(this)}),"undefined"==typeof kuim&&(kuim={}),kuim={routedPages:[],presentPageObj:null,navigateTo:async function(i,n,s){clearTimeout(kuim.delayToLoad),kuim.delayToLoad=setTimeout(()=>{void 0===s&&(s=!1);let t=document.querySelector("main");kuim.presentPageObj&&(kuim.presentPageObj.page.classList.remove("in"),kuim.presentPageObj.page.classList.add("out")),setTimeout(async()=>{kuim.presentPageObj&&(kuim.presentPageObj.page.parentElement.style.display="none"),kuim.presentPageObj&&!1!==s&&(kuim.presentPageObj.page.parentElement.remove(),kuim.presentPageObj.destroy&&kuim.presentPageObj.destroy(),delete kuim.presentPageObj);var e=await xhr.asyncGet({url:i},"GET");kuim.reload(t,i,e,n)},400)},200)},navigateWidget:function(t,i,n){clearTimeout(kuim.delayToLoad),kuim.delayToLoad=setTimeout(()=>{i.children[0]&&(i.children[0].classList.remove("in"),i.children[0].classList.add("out")),setTimeout(async()=>{i.innerHTML="";var e=await xhr.asyncGet({url:t},"GET");kuim.replace(i,t,e,n)},400)},200)},navigateBack:function(e){clearTimeout(kuim.delayToLoad),kuim.delayToLoad=setTimeout(()=>{var e=document.querySelector("main");let t=e.children[e.children.length-2];kuim.presentPageObj.page.classList.remove("in"),kuim.presentPageObj.page.classList.add("out"),setTimeout(()=>{kuim.presentPageObj.page.parentElement.remove(),kuim.presentPageObj.destroy&&kuim.presentPageObj.destroy(),delete kuim.presentPageObj,t.style.display="",kuim.presentPageObj=window[t.getAttribute("kuim-page-id")],kuim.presentPageObj.page.classList.remove("out"),kuim.presentPageObj.page.classList.add("in"),kuim.setTitleAndIcon(t.getAttribute("kuim-page-title"),t.getAttribute("kuim-page-icon"))},400)},200)},reload:function(e,t,i,n){n=n||{};let s=dom.element('<div style="height: 100%; width: 100%;"></div>'),a=document.createRange();i=a.createContextualFragment(i);s.appendChild(i);let o=dom.find("[id^=page]",s);i=o.getAttribute("id");e.appendChild(s),s.setAttribute("kuim-page-id",i),s.setAttribute("kuim-page-url",t),n.title&&(s.setAttribute("kuim-page-title",n.title),s.setAttribute("kuim-page-icon",n.icon||"")),kuim.presentPageObj=window[i],kuim.presentPageObj.page.classList.add("in");t=utils.getParameters(t);kuim.presentPageObj.show(t),kuim.setTitleAndIcon(n.title,n.icon),n.success&&n.success()},replace:function(e,t,i,n){n=n||{};let s=dom.element('<div style="height: 100%; width: 100%;"></div>'),a=document.createRange();i=a.createContextualFragment(i);e.appendChild(i);let o=dom.find("[id^=page]",e);var l=o.getAttribute("id");n.title&&(s.setAttribute("kuim-page-title",n.title),s.setAttribute("kuim-page-icon",n.icon||"")),o.classList.add("in");var r,t=utils.getParameters(t);for(r in window[l].show(t),n)window[l][r]=n[r];n.success&&n.success()},setTitleAndIcon:function(e,t){let i=dom.find(".bottom-bar"),n=dom.find("header h1.title");n.innerText=e;let s=dom.find("header div.left");t?(s.innerHTML=t,i.style.display="",s.onclick=e=>{}):(s.innerHTML='<i class="fas fa-arrow-left text-white button icon"></i>',i.style.display="none",s.onclick=e=>{kuim.navigateBack()})},select:async function(i){var t=await xhr.promise({url:i.url,params:i.params||{}});let n=[];for(let e=0;e<t.length;e++){var s=t[e];n.push({id:s[i.fieldId||"id"],value:s[i.fieldName||"value"]})}new MobileSelect({trigger:i.trigger,title:i.title,wheels:[{data:n}],callback:(e,t)=>{i.onSelected&&i.onSelected(t[0])}})},tabs:function(e){let t=dom.find(e.container),s=dom.element(`
    <div class="nav nav-tabs mt-0"></div>
  `),a=dom.element(`
    <div class="swiper">
      <div class="swiper-wrapper">
      </div>
    </div>
  `);var o=e.tabs;for(let n=0;n<o.length;n++){let e=o[n],t=dom.templatize(`
      <div class="nav-item font-weight-bold mr-0" 
           style="padding: 0 16px; line-height: 36px; text-align: center; flex: 1;">{{title}}</div>
    `,e);s.appendChild(t),0==n&&t.classList.add("active-bg-info"),dom.bind(t,"click",e=>{l.slideTo(n,400,!0)});let i=dom.templatize(`
      <div class="swiper-slide full-width"></div>
    `,e);e.render?e.render(i,e.params||{}):i.innerHTML='<img src="https://via.placeholder.com/240x150">',a.children[0].appendChild(i)}t.appendChild(s),t.appendChild(a);let l=new Swiper(a,{direction:"horizontal",loop:!1});l.on("slideChange",function(e){e=e.activeIndex;for(let e=0;e<s.children.length;e++)s.children[e].classList.remove("active-bg-info");s.children[e].classList.add("active-bg-info")})},wizard:function(e){let t=dom.find(e.container),s=dom.element(`
    <div class="wizard"></div>
  `),a=dom.element(`
    <div class="swiper">
      <div class="swiper-wrapper">
      </div>
    </div>
  `);var o=e.steps;for(let n=0;n<o.length;n++){let e=o[n];e.index=n+1;let t=dom.templatize(`
      <div class="wizard-step">
        <div class="wizard-dot">
          <div class="wizard-connector-left"></div>
          <div class="wizard-number">{{index}}</div>
          <div class="wizard-connector-right"></div>
        </div>
      </div>
    `,e);s.appendChild(t),dom.bind(t,"click",e=>{t.classList.contains("wizard-step-completed")&&l.slideTo(n,400,!0)});let i=dom.templatize(`
      <div class="swiper-slide full-width"></div>
    `,e);e.render?e.render(i,e.params||{}):i.innerHTML='<img src="https://via.placeholder.com/240x150">',a.children[0].appendChild(i)}t.appendChild(s),t.appendChild(a);let l=new Swiper(a,{direction:"horizontal",loop:!1});return l.on("slideChange",e=>{var t=e.activeIndex;for(let e=0;e<s.children.length;e++)s.children[e].classList.remove("wizard-step-completed");for(let e=0;e<t;e++)s.children[e].classList.add("wizard-step-completed")}),l.on("sliderMove",(e,t)=>{}),l},overlay:function(){}};