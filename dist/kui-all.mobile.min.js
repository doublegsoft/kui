xhr={request:function(t,e){var i=t.url,n=t.data||t.params||{};let s=t.type||"json",o=t.success,a=t.error;n={...utils.getParameters(t.url),...n},t=t.usecase||"";let l=new XMLHttpRequest;l.timeout=1e4,l.onload=function(){let e=l.responseText;if("json"==s)try{e=JSON.parse(e)}catch(t){return void(a&&a(e))}4==l.readyState&&"200"==l.status?o&&o(e):a&&a(e)},l.onerror=function(){a&&a({error:{code:-500,message:"网络访问错误！"}})},l.ontimeout=function(){a&&a({error:{code:-501,message:"网络请求超时！"}})},l.open(e,i,!0),l.setRequestHeader("Content-Type","application/json"),l.setRequestHeader("usecase",t),"undefined"!=typeof APPTOKEN&&l.setRequestHeader("apptoken",APPTOKEN),window.user?l.setRequestHeader("_current_user",window.user.userId):l.setRequestHeader("_current_user","unauthorized user"),l.send(JSON.stringify(n))},get:function(t){var e=t.url;t.data;let i=t.success,n=t.error,s=new XMLHttpRequest;s.open("GET",e,!0),s.onload=function(){var t=s.responseText;4==s.readyState&&"200"==s.status?i&&i(t):n&&n(t)},s.send(null)},post:function(t){let e=t.url;"undefined"!=typeof HOST&&-1==e.indexOf("http")&&(e=HOST+e,t.url=e),xhr.request(t,"POST")},put:function(t){xhr.request(t,"PUT")},delete:function(t){xhr.request(t,"DELETE")},connect:function(t){xhr.request(t,"CONNECT")},upload:function(e){var t,i=e.url,n=e.data||e.params;let s=e.type||"json",o=e.success,a=e.error,l=new FormData;for(t in n)l.append(t,n[t]);l.append("file",e.file);let r=new XMLHttpRequest;r.timeout=1e4,r.onload=function(){let e=r.responseText;if("json"==s)try{e=JSON.parse(e)}catch(t){return void(a&&a(e))}4==r.readyState&&"200"==r.status?o&&o(e):a&&a(e)},e.progress&&(r.onprogress=function(t){e.progress(t.loaded,t.total)}),r.onerror=function(){a&&a({error:{code:-500,message:"网络访问错误！"}})},r.ontimeout=function(){a&&a({error:{code:-501,message:"网络请求超时！"}})},r.open("POST",i,!0),"undefined"!=typeof APPTOKEN&&r.setRequestHeader("apptoken",APPTOKEN),r.send(l)},chain:function(i){if(0!=i.length){var t=i[0];let e=t.success;xhr.promise(t,function(t){e(t),xhr.chain(i.slice(1))})}},asyncGet:function(i,n){return new Promise(function(e,t){i.success=function(t){e(t)},i.error=n,xhr.get(i)})},promise:function(i,n){return new Promise(function(e,t){i.success=function(t){t.error?n?n(t.error):dialog.error(t.error.message):e(t.data)},i.error=n||(()=>{e({error:{code:"500",message:"网络异常"}})}),xhr.post(i)})},longpromise:function(i,n){let t=i.container||dom.find("#container");var e=i.tooltip||"操作处理中...";let s=dom.element(`
    <div class="page-loading hide">
      <div class="ring">${e}
        <span></span>
      </div>
    </div>
  `);return t.appendChild(s),s.classList.remove("hide"),new Promise(function(e,t){i.success=function(t){if(t.error)return setTimeout(()=>{s.classList.add("hide"),s.remove()},600),dialog.error(t.error.message),void(n&&n(t.error));setTimeout(()=>{s.classList.add("hide"),s.remove()},1200),e(t.data)},i.error=n,xhr.post(i)})},download:function(o){let a=new XMLHttpRequest;a.open("POST",o.url,!0),a.responseType="arraybuffer",a.onload=function(){if(200===this.status){let i="",n=a.getResponseHeader("Content-Disposition");if(n&&-1!==n.indexOf("attachment")){let t=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/,e=t.exec(n);null!=e&&e[1]&&(i=e[1].replace(/['"]/g,""))}var t,e,s=a.getResponseHeader("Content-Type"),s=new Blob([this.response],{type:s});void 0!==window.navigator.msSaveBlob?window.navigator.msSaveBlob(s,i):(t=window.URL||window.webkitURL,e=t.createObjectURL(s),void 0===(s=document.createElement("a")).download?window.location=e:(s.href=e,s.download=o.filename||"下载的文件",document.body.appendChild(s),s.click()),setTimeout(function(){t.revokeObjectURL(e)},100))}},a.setRequestHeader("Content-type","application/json"),"undefined"!=typeof APPTOKEN&&a.setRequestHeader("apptoken",APPTOKEN),a.send(JSON.stringify(o.params||{}))},asyncRequest:function(t,s){let o=t.url,a=t.data||t.params,l=t.type||"json",r=t.usecase||"";return new Promise((i,n)=>{if(o){let e=new XMLHttpRequest;e.timeout=1e4,e.onload=function(){let t=e.responseText;if("json"==l)try{t=JSON.parse(t)}catch(t){return console.log(t),void n(t)}(4==e.readyState&&"200"==e.status?i:n)(t)},e.onerror=function(){n({error:{code:-500,message:"网络访问错误！"}})},e.ontimeout=function(){n({error:{code:-501,message:"网络请求超时！"}})},e.open(s,o,!0),e.setRequestHeader("Content-Type","application/json"),e.setRequestHeader("usecase",r),"undefined"!=typeof APPTOKEN&&e.setRequestHeader("apptoken",APPTOKEN),a?e.send(JSON.stringify(a)):e.send(null)}})},asyncPost:function(t){let e=t.url;return"undefined"!=typeof HOST&&-1==e.indexOf("http")&&(e=HOST+e,t.url=e),xhr.asyncRequest(t,"POST")}},"undefined"!=typeof module&&(module.exports={xhr:xhr});var ajax={save:function(t){for(var e=t.url||"",i=t.form,n=t.button,s=t.success,o=i.validate(),a="",l=0;l<o.length;l++)a+=o[l].message+"<br>";""==a?(n&&n.prop("disabled",!0),i=i.formdata(),$.ajax({url:e,data:i,method:"POST",dataType:"json",success:function(t){if(void 0!==t.error)return dialog.error("保存信息出错！"),void(n&&n.prop("disabled",!1));dialog.success("保存信息成功！"),void 0!==s&&s(t),n&&n.prop("disabled",!1)},error:function(){dialog.error("系统异常！"),n&&n.prop("disabled",!1)}})):dialog.error(a)},post:function(e){var t={...utils.getParameters(e.url),...e.data};$.ajax({url:e.url,data:t,method:"POST",dataType:"json",success:function(t){void 0!==e.success&&e.success(t)}})},get:function(e){$.ajax({url:e.url,data:e.data,dataType:"json",success:function(t){void 0!==e.success&&e.success(t)}})},text:function(t,e,i){$.ajax({url:t,data:e,success:function(t){void 0!==i&&i(t)}})},view:function(t){"undefined"!=typeof schedule&&t.clear&&schedule.stop();let e=t.url,n=!1;n=void 0===t.empty||t.empty;let i=t.page;e&&0==e.indexOf(":")&&(i=e.substring(1),e=null);let s=utils.getParameters(t.url),o={...s,...t.params},a=t.title||"",l=t.containerId,r=t.success,d=null;if("string"==typeof l?(d=document.getElementById(l.trim()),null==d&&(d=document.querySelector(l.trim()))):d=l,void 0===o&&(o={}),window.parameters)for(var c in o)window.parameters[c]=o[c];e?xhr.get({url:e,success:function(t){let e=null;d&&(e=utils.append(d,t,n)),e.id&&window[e.id]&&window[e.id].show&&!r&&window[e.id].show(s),r&&r(a,e,s)}}):i&&xhr.post({url:"/api/v3/common/script/stdbiz/uxd/custom_window/read",data:{customWindowId:i},success:function(t){let e=t.data.script;e=e||'<div class="full-width full-height d-flex"><img src="img/under-construction.jpeg" class="m-auto full-width"></div>';let i=null;d&&(i=utils.append(d,e,n)),r&&r(a,i,s)}})}};ajax.append=function(r){"undefined"!=typeof schedule&&r.clear&&schedule.stop();let d=dom.find("#tabsMain"),c=dom.find("#tabsOthers");if(null!=d){let a=d.children.length,i=r.url,s=r.title||"",t=r.containerId,e=r.params,o=r.success,l=null;if("string"==typeof t?(l=document.getElementById(t.trim()),null==l&&(l=document.querySelector(t.trim()))):l=t,void 0===e&&(e={}),window.parameters)for(var u in e)window.parameters[u]=e[u];h();let n=l.querySelector('div[data-url="'+i+'"]');if(null!=n){n.classList.remove("hide"),setTimeout(function(){n.classList.add("show")},150);let t=dom.find('a[data-url="'+i+'"]',d);return null!=t?void t.classList.add("active"):void dom.find('a[data-url="'+i+'"]',c).classList.add("active")}if(0==i.indexOf(":")){let e=i.substring(1);xhr.post({url:"/api/v3/common/script/stdbiz/uxd/custom_window/read",data:{customWindowId:e},success:function(t){t=t.data.script;utils.append(l,t,!1);for(let e=l.children.length-1;0<=e;e--){let t=l.children[e];if("DIV"==t.tagName){t.setAttribute("data-url",i),setTimeout(function(){t.classList.add("show")},150);break}}p(s,i),stdbiz.render(e,l.querySelector('[data-url="'+i+'"]'),{})}})}else m(i);function h(){l.querySelectorAll("div[data-url]").forEach(t=>{t.classList.remove("show"),t.classList.add("hide","fade","fadeIn")}),d.querySelectorAll("a.active").forEach(t=>{t.classList.remove("active")}),c.querySelectorAll("a.active").forEach(t=>{t.classList.remove("active")})}function p(e,i){if(""==e||null==d)return;var t=dom.element(`
      <li class="nav-item">
        <a class="nav-link head-link">
          <span></span>
          <i class="fas fa-times-circle ml-1"></i>
        </a>
      </li>
    `);dom.find("a",t).setAttribute("data-url",i),dom.bind(dom.find("i",t),"click",e=>{e.preventDefault(),e.stopPropagation();let t=e.target.parentElement,i=l.querySelector('div[data-url="'+t.getAttribute("data-url")+'"]');if(i&&i.remove(),e.target.parentElement.parentElement.remove(),0<l.querySelectorAll("div[data-url]").length&&d.children[0].click(),0<c.children.length){let t=c.children[0];t.remove(),e=t,dom.find("a",e).classList.add("nav-link"),dom.find("a",e).classList.remove("dropdown-item"),dom.find("i",e).classList.add("ml-1"),dom.find("i",e).classList.remove("float-right"),d.appendChild(e)}}),dom.bind(dom.find("a",t),"click",t=>{let e=dom.ancestor(t.target,"a");e.classList.contains("active")||(h(),e.classList.add("active"),m(o.getAttribute("data-url")))});let n=!1;if(d.querySelectorAll("li").forEach(t=>{dom.find("span",t).innerText==e&&(n=!0,dom.find("a",t).classList.add("active"))}),n)return;if(0==a)d.appendChild(t);else if(a+1>MAX_HEAD_LINK_COUNT){let t=dom.find("li:last-child",d);t.remove(),i=t,dom.find("a",i).classList.add("pointer"),dom.find("a",i).classList.remove("nav-link"),dom.find("a",i).classList.add("dropdown-item"),dom.find("i",i).classList.remove("ml-1"),dom.find("i",i).classList.add("float-right"),0==c.children.length?c.appendChild(i):c.insertBefore(i,c.children[0])}d.insertBefore(t,d.children[0]);let s=dom.find("span",t),o=dom.find("a",t);o.classList.add("active"),s.innerText=e}function m(n){l.querySelectorAll("div[data-url]").forEach(t=>{t.classList.remove("show"),t.classList.add("hide")});let e=l.querySelector('div[data-url="'+n+'"]');if(null!=e){e.classList.remove("hide"),setTimeout(function(){e.classList.add("show")},150);let t=dom.find('a[data-url="'+n+'"]',d);return null!=t?void t.classList.add("active"):void dom.find('a[data-url="'+n+'"]',c).classList.add("active")}xhr.get({url:n,success:function(t){var e=utils.getParameters(n),i=utils.append(l,t,!1);i.id&&window[i.id]&&window[i.id].show&&window[i.id].show(e);for(let e=l.children.length-1;0<=e;e--){let t=l.children[e];if("DIV"==t.tagName){t.setAttribute("data-url",n),setTimeout(function(){t.classList.add("show")},150);break}}p(s,n),o&&o(s,t)}})}}else ajax.view(r)},ajax.shade=function(e){"undefined"!=typeof schedule&&schedule.stop();let t=e.url,i=e.success,n=document.querySelector(".page.full");null!=n&&n.parentElement.remove(),-1===t.indexOf(":")?xhr.get({url:t,success:function(t){t=utils.append(document.body,t);i&&i(e.title||"",t)}}):xhr.post({url:"/api/v3/common/script/stdbiz/uxd/custom_window/read",data:{customWindowId:t.substring(1)},success:function(t){t=t.data.script,t=utils.append(document.body,t);i&&i(e.title||"",t)}})},ajax.stack=function(t){"undefined"!=typeof schedule&&t.clear&&schedule.stop();var i=t.pageId,e=t.params;let n=dom.find(t.containerId);let s=!1;for(let e=0;e<n.children.length;e++){let t=n.children[e];"DIV"==t.tagName&&"true"!=t.getAttribute("data-stack-back")&&(t.classList.remove("show"),t.classList.add("hide"),t.id==i&&(t.classList.remove("hide"),t.classList.add("show"),s=!0))}s||(t.empty=!1,ajax.view(t));let o=dom.find("div[data-stack-back]",n);null==o&&(o=dom.element(`
    <div data-stack-back="true" class="pointer">
      <i class="fas fa-angle-left font-32" style="margin-top: 12px;"></i>
    </div>
  `),o.style.position="fixed",o.style.width="60px",o.style.height="60px",o.style.bottom="40px",o.style.right="40px",o.style.backgroundColor="#0C9",o.style.color="#fff",o.style.borderRadius="50px",o.style.textAlign="center",o.style.boxShadow="2px 2px 3px #999",o.style.zIndex="99",dom.bind(o,"click",t=>{o.remove(),ajax.unstack({containerId:n})}),n.appendChild(o))},ajax.unstack=function(t){t=dom.find(t.containerId);let e=t.children[t.children.length-1];e.remove();let i=t.children[t.children.length-1];i.classList.remove("hide"),i.classList.add("show")},ajax.template=function(t){var e=t.url,i=t.usecase;let n=t.containerId,s=t.templateId;var o=t.data;let a=t.success;xhr.post({url:e,usecase:i,data:o,success:function(t){var e;n&&(e=document.getElementById(s).innerHTML,e=Handlebars.compile(e)(t),document.getElementById(n).innerHTML=e),a&&a(t)}})},ajax.dialog=function(t){let e=t.title||"";var i=t.url||"",n=t.params||{};let s=t.success,o=t.end,a=!1!==t.shadeClose,l=!0===t.allowClose,r=t.width||"80%",d=t.height||"",c=t.offset||"auto";if(window.parameters)for(var u in n)window.parameters[u]=n[u];$.ajax({url:i,data:n,async:!0,success:function(t){layer.open({type:1,offset:c,title:e,closeBtn:!0==l?1:0,shade:.3,shadeClose:a,area:[r,d],content:t,success:function(t,e){let i=document.querySelector(".layui-layer-content");i.style+="; overflow: hidden;",s&&s()},end:o||function(){}})}})},ajax.video=function(t,e,i,n){layer.open({type:2,title:!1,closeBtn:1,shade:[0],area:[i+"px",n+"px"],offset:"rb",anim:2,content:[t,"no"]})},ajax.svg=function(t,i,e,n){void 0===e&&(e={}),$.ajax({url:t,data:e,success:function(t){i.empty();var e=(new XMLSerializer).serializeToString(t.documentElement);i.html(e),n&&n(t)}})},ajax.upload=function(e){let t=e.data;void 0===t&&(t={});let i=new FormData;for(var n in t)i.append(n,t[n]);$.ajax({url:e.url,data:i,method:"POST",cache:!1,contentType:!1,processData:!1,xhr:function(){var t=$.ajaxSettings.xhr();return t.upload&&e.progress&&t.upload.addEventListener("progress",function(t){t.lengthComputable&&e.progress&&e.progress(t.total,t.loaded)},!1),t},success:function(t){e.success&&e.success(t)},error:function(t){e.error&&e.error(t)}})},ajax.sidebar=function(e){let t=dom.find(e.containerId),i=e.success||function(t,e){},n=dom.find("[widget-id=right-bar]"),s=e.allowClose||!1;null!=n&&n.remove(),n=dom.element(`
    <div widget-id="right-bar" style="position: absolute; top: 0; left: 0; height: 100%; width: 100%; background: transparent; z-index: 999999;">
      <div class="right-bar fade show">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="card-header pl-3">
              <h5 class="modal-title"></h5>
              <button type="button" class="close text-danger">
                <i class="fas fa-times"></i>
              </button>
            </div>
            <div class="modal-body" style="overflow-y: auto;"></div>
            <div style="position: absolute; bottom: 24px; left: 0; width: 100%; height: 48px; border-top: 1px solid lightgrey; background: white; display:none;">
              <div widget-id="right-bar-bottom" class="mh-10 mt-2" style="float: right;"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  `),!0===e.showBottom&&(dom.find(".modal-body",n).style.marginBottom="36px",dom.find("[widget-id=right-bar-bottom]",n).parentElement.style.display=""),n.addEventListener("click",t=>{"right-bar"===t.target.getAttribute("widget-id")&&(n.children[0].classList.remove("in"),n.children[0].classList.add("out"),setTimeout(function(){n.remove()},300))}),t.appendChild(n),0==e.url.indexOf(":")&&(e.page=e.url.substring(1),e.url=null),e.url?xhr.get({url:e.url,success:function(t){dom.find(".modal-title",n).innerHTML=e.title||"",dom.find(".modal-body",n).innerHTML="",s||e.close||dom.find("button.close",n).classList.add("hidden"),dom.find("button.close",n).addEventListener("click",function(){n.children[0].classList.add("out"),n.remove(),e.close&&e.close()});t=utils.append(dom.find(".modal-body",n),t);i&&i(e.title||"",t),setTimeout(function(){n.children[0].classList.remove("out"),n.children[0].classList.add("in")},300)}}):xhr.post({url:"/api/v3/common/script/stdbiz/uxd/custom_window/read",params:{customWindowId:e.page},success:function(t){t=t.data.script;dom.find(".modal-body",n).innerHTML="";t=utils.append(dom.find(".modal-body",n),t);dom.find(".modal-title",n).innerHTML=e.title||"&nbsp;",s||e.close||dom.find("button.close",n).classList.add("hidden"),dom.find("button.close",n).addEventListener("click",function(){dom.find(".right-bar").classList.add("out"),setTimeout(function(){n.remove()},300),e.close&&e.close()}),i&&i(e.title||"",t),setTimeout(function(){n.children[0].classList.remove("out"),n.children[0].classList.add("in")},300)}})},ajax.bottombar=function(i){let t=dom.find(i.containerId),n=i.success||function(){},s=dom.find(".bottom-bar",t),o=i.allowClose||!1;null!=s&&s.remove(),s=dom.element(`
    <div class="bottom-bar fade show">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="card-header pt-2 pb-2">
            <button type="button" class="close text-danger">
              <i class="fas fa-times"></i>
            </button>
            <h5 class="modal-title"></h5>
          </div>
          <div class="modal-body" style="overflow-y: auto"></div>
        </div>
      </div>
    </div>
  `),t.appendChild(s);var e=s.parentElement.clientWidth,a=parseInt(window.getComputedStyle(s.parentElement,null).getPropertyValue("padding-left")),l=parseInt(window.getComputedStyle(s.parentElement,null).getPropertyValue("padding-right"));s.style.width=e-l-a+"px",i.url?xhr.get({url:i.url,success:function(t){dom.find(".modal-title",s).innerHTML=i.title||"",o||i.close||dom.find("button.close",s).classList.add("hidden"),dom.find("button.close",s).addEventListener("click",function(){dom.find(".bottom-bar").classList.add("out"),i.close&&i.close()}),utils.append(dom.find(".modal-body",s),t),n&&n(t),setTimeout(function(){s.classList.remove("out"),s.classList.add("in")},200)}}):xhr.post({url:"/api/v3/common/script/stdbiz/uxd/custom_window/read",data:{customWindowId:i.page},success:function(t){var e=t.data.script;utils.append(dom.find(".modal-body",s),e),dom.find(".modal-title",s).innerHTML=i.title,o||i.close||dom.find("button.close",s).classList.add("hidden"),dom.find("button.close",s).addEventListener("click",function(){dom.find(".bottom-bar").classList.add("out"),i.close&&i.close()}),n&&n(t),setTimeout(function(){s.classList.remove("out"),s.classList.add("in")},200)}})},ajax.tabs=function(t){let e=document.querySelector(t.containerId);var n=t.tabs;t.closeable;let o=dom.create("ul","nav","nav-tabs"),a=dom.create("div","tab-content"),i=dom.create("div","float-right");t=dom.create("button","btn","btn-link");function l(t,e,i,n){ajax.view({url:e,containerId:t,success:function(){window[i]&&window[i].show(n)}})}i.appendChild(t),dom.bind(t,"click",function(){let t=dom.find("li.active link",this.parentElement.parentElement);var e=t.getAttribute("data-model-url"),i=t.getAttribute("data-model-page"),n=JSON.parse("data-model-data");l(dom.find("div.tab-content div[data-model-url='"+e+"']",this.parentElement.parentElement),e,i,n)});for(let i=0;i<n.length;i++){var r=n[i];let t=dom.create("li","nav-item"),s=dom.create("a","nav-link");0==i&&s.classList.add("active"),s.setAttribute("data-model-url",r.url),s.setAttribute("data-model-data",JSON.stringify(r.data||{})),s.setAttribute("data-model-page",r.page),s.innerHTML=r.title,dom.bind(s,"click",function(){if(!this.classList.contains("active")){dom.find("a.active",this.parentElement.parentElement.parentElement).classList.remove("active"),dom.find("div.active",this.parentElement.parentElement.parentElement).classList.remove("active");var e=s.getAttribute("data-model-url"),i=JSON.parse(s.getAttribute("data-model-data")),n=s.getAttribute("data-model-page");let t=dom.find("div.tab-content div[data-model-url='"+e+"']",this.parentElement.parentElement.parentElement);this.classList.add("active"),t.classList.add("active"),""===t.innerHTML.trim()&&l(t,e,n,i)}}),t.appendChild(s),o.appendChild(t);let e=dom.create("div","tab-pane");0==i&&(e.classList.add("active"),l(e,r.url,r.page,r.data)),e.setAttribute("data-model-url",r.url),a.append(e)}e.appendChild(i),e.appendChild(o),e.appendChild(a)};var dom={};function ListView(t){this.url=t.url,this.usecase=t.usecase,this.params=t.params||{},this.lazy=!0===t.lazy,this.hoverable=!1!==t.hoverable,this.activateable=!0===t.activateable,this.itemClass=t.itemClass||[],this.slidingActions=t.slidingActions||[],this.emptyHtml=t.emptyHtml,this.idField=t.idField,this.compare=t.compare||function(t,e){return!1},this.selections=t.selections||[],this.local=t.local||[],this.create=t.create||function(t,e){},this.complete=t.complete,this.draggable=!0===t.draggable,this.start=t.start||0,this.limit=t.limit||-1,this.borderless=t.borderless||!1,this.height=t.height,this.tooltip=t.tooltip,this.required=t.required||!1,this.onRemove=t.onRemove,this.onReorder=t.onReorder,this.onCheck=t.onCheck,this.onSelect=t.onSelect,this.onFilter=t.onFilter,this.onAdd=t.onAdd,this.onSearch=t.onSearch,this.onClick=t.onClick,this.observableItems=new rxjs.Observable}function GridView(t){this.columnCount=t.columnCount||2,this.local=t.local||[],this.url=t.url,this.params=t.params||{},this.create=t.create,this.error=t.error||function(t){}}function Timeline(t){this.url=t.url,this.params=t.params||{},this.data=t.data||[],this.fnTitle=t.title||function(t,e){return""},this.fnSubtitle=t.subtitle||function(t,e){return""},this.fnContent=t.content||function(t,e){return""},this.onComplete=t.onComplete}function Tabs(t){this.navigator=dom.find(t.navigatorId),this.content=dom.find(t.contentId),this.tabActiveClass=t.tabActiveClass,this.tabs=t.tabs,this.lazy=!1!==t.lazy,this.autoClear=!0===t.autoClear}function DataSheet(t){this.columns=t.columns,this.columnCount=this.getColumnCount(this.columns),this.rowHeaderWidth=t.rowHeaderWidth||150,this.rowHeaders=t.rowHeaders,this.rowCount=this.getRowCount(this.rowHeaders),this.readonly=!0===t.readonly,this.totalColumns=[];for(let t=0;t<this.columns.length;t++){var e=this.columns[t];e.totalable&&this.totalColumns.push(e)}this.onCellClicked=t.onCellClicked,this.onRowHeaderClicked=t.onRowHeaderClicked,this.rowHeaderColumnCount=this.getRowHeaderColumnCount(this.rowHeaders),this.colHeaderColumnCount=this.getColumnHeaderColumnCount(this.columns),this.rowHeaderRowCount=this.getRowHeaderRowCount(this.rowHeaders),this.colHeaderRowCount=this.getColumnHeaderRowCount(this.columns),this.matrixColumn=[],this.matrixRowHeader=[],this.buildColumnMatrix(this.columns,this.matrixColumn,0),this.buildRowHeaderMatrix(this.rowHeaders,this.matrixRowHeader,0)}function Chat(t){this.host=t.host||"",this.userId=t.userId,this.userType=t.userType,this.getConversations=t.getConversations,this.onInit=t.onInit||async function(){},this.onSendTextMessage=t.onSendTextMessage,this.onSendImageMessage=t.onSendImageMessage,this.onSendAudioMessage=t.onSendAudioMessage,this.onSendVideoMessage=t.onSendVideoMessage,this.onSendCustomMessage=t.onSendCustomMessage,this.onRevokeMessage=t.onRevokeMessage||function(t){},this.onMessageReceived=t.onMessageReceived,this.onUnreadMessages=t.onUnreadMessages||function(t){},this.onReadMessages=t.onReadMessages||function(t){}}function Sparkline(t){this.color=t.color||"black",this.type=t.type||"line",this.data=t.data||[]}function MobileWizard(t){this.topic=t.topic,this.steps=t.steps||[],this.root=dom.element(`
    <div style="width: 100%">
      <div class="wizard-progress">
      </div>
      <div class="wizard-content">
      </div>
    </div>
  `)}function MobileForm(t){this.fields=t.fields,this.readonly=t.readonly||!1,this.saveOpt=t.save,this.readOpt=t.read}function Numpad(t){this.unit=t.unit||"",this.regex=t.regex||/.*/,this.success=t.success||function(t){},this.type=t.type||"decimal"}function DistrictPicker(t){this.unit=t.unit||"",this.regex=t.regex||/.*/,this.success=t.success||function(t){},this.selections=t.selections||{}}function Calendar(t){this.today=moment(new Date),this.currentMonth=moment(this.today).startOf("month"),this.currentIndex=1}function CascadePicker(t){this.success=t.success||function(t){},this.selections=t.selections||{},this.levels=t.levels}function ActionSheet(t){this.title=t.title||"",this.actions=t.actions||[]}function Weekdays(t){t=t||{},this.today=moment(new Date),this.days=t.days||14}function PopupRuler(t){this.unit=t.unit||"",this.regex=t.regex||/.*/,this.success=t.success||function(t){},this.type=t.type||"decimal",this.value=t.value,this.range=t.range}dom.value=function(t,e){const i=document.querySelector(t);if(!e)return i.value.trim();i.value=e},dom.empty=function(t){const e=document.querySelector(t);e.value?e.value="":e.innerHTML=""},dom.valid=function(t){const e=document.querySelector(t);return void 0!==e.value&&null!=e.value&&""!=e.value.trim()},dom.create=function(t){var e=Array.prototype.slice.call(arguments,1);let i=document.createElement(t);for(let t=0;t<e.length;t++)i.classList.add(e[t]);return i},dom.fix=function(t){let e=null;e="string"==typeof t?document.querySelector(t):t;var i=e.getBoundingClientRect(),n=i.left,s=i.top,o=(i.width,i.height),a=(parseInt(window.getComputedStyle(e,null).getPropertyValue("padding-left")),parseInt(window.getComputedStyle(e,null).getPropertyValue("padding-right")),parseInt(window.getComputedStyle(e,null).getPropertyValue("padding-top"))),l=parseInt(window.getComputedStyle(e,null).getPropertyValue("padding-bottom"));parseInt(window.getComputedStyle(e,null).getPropertyValue("margin-left")),parseInt(window.getComputedStyle(e,null).getPropertyValue("margin-right")),parseInt(window.getComputedStyle(e,null).getPropertyValue("margin-top")),parseInt(window.getComputedStyle(e,null).getPropertyValue("margin-bottom"));let r=e.parentElement.parentElement;t=r.getBoundingClientRect(),i=parseInt(window.getComputedStyle(r,null).getPropertyValue("padding-left"));parseInt(window.getComputedStyle(r,null).getPropertyValue("padding-right")),parseInt(window.getComputedStyle(r,null).getPropertyValue("padding-top")),parseInt(window.getComputedStyle(r,null).getPropertyValue("padding-bottom"));return e.style.position="absolute",e.style.top=s-t.top+"px",e.style.left=n-t.left+"px",e.style.width="calc(100% - "+2*i+"px )",{top:s-t.top,left:n-t.left,width:t.width-2*i,height:o+a+l}},dom.find=function(t,e){if(e=e||document,"string"!=typeof t)return t;t=e.querySelectorAll(t);return 0==t.length?null:1==t.length?t[0]:t},dom.ancestor=function(t,e,i){let n=null;if(i=i||"",n="string"==typeof t?document.querySelector(t):t,null==n)return null;e=e.toUpperCase();let s=n;if(""==i)for(;null!=s&&s.tagName!=e;)s=s.parentElement;else for(;null!=s&&(s.tagName!=e||!s.classList.contains(i));)s=s.parentElement;return s},dom.element=function(t){let e=document.createElement("div");return e.innerHTML=t,e.firstElementChild},dom.bind=function(t,e,i){let n=null;n="string"==typeof t?document.querySelector(t):t,null!=n&&n&&n.addEventListener(e,i)},dom.model=function(t,i){let n=null;if(n="string"==typeof t?document.querySelector(t):t,void 0===i){let i={};return Array.prototype.slice.call(n.attributes).forEach(function(e){if(0==e.name.indexOf("data-model-"))if(0==e.value.indexOf("{"))try{i[utils.nameVar(e.name.slice("data-model-".length))]=JSON.parse(e.value)}catch(t){i[utils.nameVar(e.name.slice("data-model-".length))]=e.value}else i[utils.nameVar(e.name.slice("data-model-".length))]=e.value}),i}var s=Array.prototype.slice.call(arguments,2);if(0==s.length)for(const e in i)0!=e.indexOf("||")&&0!=e.indexOf("//")&&0!=e.indexOf(">>")&&("object"==typeof i[e]?n.setAttribute(utils.nameAttr(e),JSON.stringify(i[e])):n.setAttribute(utils.nameAttr(e),i[e]));else for(let e=0;e<s.length;e++){let t=s[e];0!=t.indexOf("||")&&0!=t.indexOf("//")&&0!=t.indexOf(">>")&&("object"==typeof i[t]?n.setAttribute(utils.nameAttr(t),JSON.stringify(i[t])):n.setAttribute(utils.nameAttr(t),i[t]))}},dom.collect=function(t,n){let s=[],o=document.querySelectorAll(t);for(let i=0;i<o.length;i++){let e={};if(Array.isArray(n))for(let t=0;t<n.length;t++)e[n[t]]=o[i].getAttribute(utils.nameAttr(n[t]));else e[n]=o.getAttribute(utils.nameAttr(n[j]));s.push(e)}return s},dom.propagate=function(t,e,i,n){let s=n(e);if(Array.isArray(i))for(let t=0;t<i.length;t++)s.setAttribute(utils.nameAttr(i[t]),e[i[t]]);else s.setAttribute(utils.nameAttr(i),e[i]);t.appendChild(s)},dom.toggle=function(t,o){var i=document.querySelectorAll(t);for(let e=0;e<i.length;e++){let t=i[e];t.addEventListener("click",function(){let t=this.getAttribute("data-toggle"),e=t.split(">>"),i=e[0].split("+"),n=e[1].split("+"),s=!1;for(let e=0;e<i.length;e++){let t=i[e].trim();s=0==t.indexOf(".")?this.classList.contains(t.substring(1)):null!=this.querySelector(t)}if(s){for(let t=0;t<n.length;t++){let e=n[t].trim();if(0===e.indexOf("."))this.classList.add(e.substring(1));else{let t=this.querySelector(e.substring(0,e.indexOf(".")));t.classList.add(e.substring(e.indexOf(".")+1))}}for(let t=0;t<i.length;t++){let e=i[t].trim();if(0==e.indexOf("."))this.classList.remove(e.substring(1));else{let t=this.querySelector(e);t.classList.remove(e.substring(e.indexOf(".")+1))}}}else{for(let t=0;t<i.length;t++){let e=i[t].trim();if(0==e.indexOf("."))this.classList.add(e.substring(1));else{let t=this.querySelector(e.substring(0,e.indexOf(".")));t.classList.add(e.substring(e.indexOf(".")+1))}}for(let t=0;t<n.length;t++){let e=n[t].trim();if(0==e.indexOf("."))this.classList.remove(e.substring(1));else{let t=this.querySelector(e);t.classList.remove(e.substring(e.indexOf(".")+1))}}o&&resovle(this)}})}},dom.switch=function(t,i){let n=dom.find(t),e=n.getAttribute("data-switch"),s=e.split("+");var o=n.querySelectorAll(s[0]);for(let e=0;e<o.length;e++){let t=o[e];t.addEventListener("click",function(){let e=n.querySelectorAll(s[0]);for(let t=0;t<e.length;t++)e[t].classList.remove(s[1].substring(1));t.classList.add(s[1].substring(1)),i&&i(t)})}},dom.tabs=function(t){let n=dom.find(t);if(null!=n){let i=n.getAttribute("data-tab-active-class");for(let t=0;t<n.children.length;t++){let e=n.children[t];e.addEventListener("click",t=>{for(let e=0;e<n.children.length;e++){let t=n.children[e];t.classList.remove(i)}e.classList.add(i)})}}},dom.top=function(t){let e=null;if(e="string"==typeof t?document.querySelector(t):t,null==e)return 0;let i=e.offsetTop;return void 0!==e.offsetParent&&(i+=dom.top(e.offsetParent)),i},dom.formdata=function(t,e){let s=null;if(s="string"==typeof t?document.querySelector(t):t,void 0===e){let i={},n={};var o=s.querySelectorAll("input");for(let e=0;e<o.length;e++){var a=o[e];let t=a.name;var l=a.type,r=a.value;"text"==l||"number"==l||"password"==l||"hidden"==l?(i[t]=null,""!=r?-1!=t.indexOf("[]")?i[t]=[r]:i[t]=r:i[t]=""):"radio"==l?a.checked&&(i[t]=r):"checkbox"==l&&(void 0===n[t]&&(n[t]=0),a.checked&&(void 0===i[t]&&(n[t]=0,i[t]=[]),i[t].push(r)),n[t]+=1)}var d=s.querySelectorAll("select");for(let e=0;e<d.length;e++){var c=d[e];let t=c.name;i[t]=null,-1!=c.selectedIndex?-1!=t.indexOf("[]")?i[t]=[c.value]:i[t]=c.value:i[t]=""}var u,h,p=s.querySelectorAll("textarea");for(let t=0;t<p.length;t++){var m=p[t],f=m.name;i[f]=null,i[f]=m.value}for(u in n)-1==u.indexOf("[]")&&1==n[u]&&i[u]&&(i[u]=i[u][0]);for(h in i)"string"==typeof i[h]&&0==i[h].indexOf("${")&&(i[h]=i[i[h].substring(2,i[h].length-1)]);return i}function i(t,e,i){let n=dom.find("[name='"+e+"']",t);null!=n&&("INPUT"==n.tagName?"check"==n.type||(n.value=i||""):"SELECT"==n.tagName&&$("select[name='"+e+"']").val(i).trigger("change"))}for(var n in e)if("object"==typeof e[n])for(var g in e[n])i(s,n+"."+g,e[n][g]);else i(s,n,e[n])},dom.setAttribute=function(t,e,i){let n=document.querySelectorAll(t);for(let t=0;t<n.length;t++)n[t][e]=i},dom.removeAttribute=function(t,e){let i=document.querySelectorAll(t);for(let t=0;t<i.length;t++)i[t].removeAttribute(e)},dom.enable=function(t){let e=document.querySelectorAll(t);for(let t=0;t<e.length;t++)e[t].disabled=!1},dom.disable=function(t){let e;e="string"==typeof t?document.querySelectorAll(t):t;for(let t=0;t<e.length;t++)e[t].disabled=!0},dom.index=function(t,i,e){let n;if(n="string"==typeof t?dom.find(t):t,!e){var s=n.getAttribute(i),o=n.parentElement.querySelectorAll(n.tagName);for(let e=0;e<o.length;e++){let t=o[e];if(s==t.getAttribute(i))return e}}return-1},dom.elementAt=function(t,i,n){var s=document.querySelectorAll(t);for(let e=0;e<s.length;e++){let t=s[e];if(n==t.getAttribute(i))return{index:e,element:t}}return null},dom.elementAtTree=function(t,i,n,s,o){var a=document.querySelectorAll(t);let l=0;for(let e=0;e<a.length;e++){let t=a[e];var r=t.getAttribute(i),d=t.getAttribute(n);if(o==d&&(l++,s==r))return{index:l,element:t}}},dom.stack=function(e,i,n,s){let o=dom.create("a","btn","btn-link");var t=dom.create("i","fas","fa-caret-right","mr-1");o.appendChild(t),dom.bind(o,"click",function(){let t=dom.find("i",o);t.classList.contains("fa-caret-right")?(e.container.querySelectorAll("i.fa-caret-down").forEach(t=>{t.classList.remove("fa-caret-down"),t.classList.add("fa-caret-right")}),t.classList.remove("fa-caret-right"),t.classList.add("fa-caret-down"),e.stack(n,function(t){t.parentElement.classList.add("fade","fadeIn"),t.style.paddingLeft="50px",t.style.paddingRight="50px",setTimeout(function(){t.parentElement.classList.add("show")},200),s(t)})):(t.classList.remove("fa-caret-down"),t.classList.add("fa-caret-right"),i.parentElement.nextSibling.remove())})},dom.inner=function(t){var e=t.clientHeight,i=t.clientWidth,t=getComputedStyle(t);return{height:e-parseInt(t.paddingTop)-parseInt(t.paddingBottom),width:i-parseInt(t.paddingLeft)-parseInt(t.paddingLeft)}},dom.outer=function(t){var e=t.clientHeight,i=t.clientWidth,t=getComputedStyle(t);return{height:e+parseInt(t.marginTop)+parseInt(t.borderTop)+parseInt(t.marginBottom)+parseInt(t.borderBottom),width:i+parseInt(t.marginLeft)+parseInt(t.borderLeft)+parseInt(t.marginRight)+parseInt(t.borderRight)}},dom.height=function(t,e,i){e=e||0,i=(i=void 0===i?dom.find("#container"):i)||document.body;let n=null;n="string"==typeof t?document.querySelector(t):t;var s=dom.top(n);let o=getComputedStyle(i,null);parseInt(o.getPropertyValue("padding-top"));t=parseInt(o.getPropertyValue("padding-bottom"));o=getComputedStyle(n,null);parseInt(o.getPropertyValue("border-top-width")),parseInt(o.getPropertyValue("border-bottom-width"));n.style.marginBottom="0px",n.style.height=i.clientHeight-s-e-t+"px",n.style.overflowY="auto"},dom.height2=function(t,e,i){e=e||0,i=(i=void 0===i?dom.find("#container"):i)||document.body;let n=null;n="string"==typeof t?document.querySelector(t):t;dom.top(n);let s=getComputedStyle(i,null);var o=parseInt(s.getPropertyValue("padding-top")),a=parseInt(s.getPropertyValue("padding-bottom"));s=getComputedStyle(n,null);var l=parseInt(s.getPropertyValue("border-top-width")),r=parseInt(s.getPropertyValue("border-bottom-width")),d=parseInt(s.getPropertyValue("border-top-width")),t=parseInt(s.getPropertyValue("border-bottom-width"));n.style.marginBottom="0px";i=i.getBoundingClientRect();n.style.height=i.height-o-a-l-r-d-t-e+"px",n.style.overflowY="auto"},dom.templatize=function(t,e){let i=Handlebars.compile(t);e=i(e);return dom.element(e)},dom.render=function(t,e,s){let i=null;function n(t,e,i){let n=dom.find("[name='"+e+"']",t);null!=n&&("DIV"===n.nodeName&&s?i&&function(t,e){let i=dom.find("[value='"+e+"']",t);null!=i&&(i.checked=!0)}(n,i):"INPUT"==n.tagName?"radio"==n.type||(n.value=i):"SPAN"==n.tagName?i&&(n.innerHTML=i):"SELECT"==n.tagName&&$("select[name='"+e+"']").val(i).trigger("change"))}for(var o in i="string"==typeof t?document.querySelector(t):t,e)if("object"==typeof e[o])for(var a in e[o])n(i,o+"."+a,e[o][a]);else n(i,o,e[o])},dom.popup=function(t,e){let i=dom.create("div","full-width","full-height","position-absolute");return i.style.background="transparent",dom.bind(i,"click",t=>{i.remove(),e.remove()}),document.body.appendChild(i),t.appendChild(e),i},dom.html=function(t){let e=dom.element("<div></div>");return e.appendChild(t),e.innerHTML},dom.init=function(e,i){if(i){let t=i.getAttribute("name");t&&""!=t||(t=i.getAttribute("widget-id")),t&&""!=t&&(e[t]=i);for(let t=0;t<i.children.length;t++){var n=i.children[t];dom.init(e,n)}}},utils={append:function(t,e,i){let n=dom.create("div");n.style.height="100%",n.style.width="100%",i=i||!1;let s=document.createRange();e=s.createContextualFragment(e);!1!==i&&(t.innerHTML=""),t.appendChild(n),n.appendChild(e);e=dom.find("[id^=page]",n);return e?n.setAttribute("page-id",e.id):n.setAttribute("page-id","page.not.in.database"),{id:e?e.id:"",container:n}},message:function(i){if(i||0!=i.length){let e="";for(let t=0;t<i.length;t++)e+=i[t].message+"<br>";return e}},prompt:function(e){if(e||0!=e.length)for(let t=0;t<e.length;t++)$(e[t].element).addClass("is-invalid")},render:function(t,e,i){e=document.getElementById(e).innerHTML;let n=Handlebars.compile(e);i=n(i);let s=document.getElementById(t);s.innerHTML=i},assemble:function(t,e){if("object"==typeof t)for(var i in t){var n=t[i];"object"==typeof n&&(t[i+"Id"]=n.id),"id"==i?t[e+"Id"]=n:"name"==i&&(t[e+"Name"]=n)}},in:function(t){var e=t.split(" ");let i=null,n=[];1==e.length?(i=document.getElementById(t),n.push(i)):(i=document.getElementById(e[0]),n=i.querySelectorAll(e[1]));for(let t=0;t<n.length;t++)i=n[t],i.addEventListener("animationend",function(){this.classList.remove("animated","fadeIn"),this.style.display="",this.removeEventListener("animationend",function(){}),this.removeEventListener("animationstart",function(){})}),i.classList.remove("fadeOut","hide"),i.classList.add("animated","fadeIn","show")},out:function(t){var e=t.split(" ");let i=null,n=[];1==e.length?(i=document.getElementById(t),n.push(i)):(i=document.getElementById(e[0]),n=i.querySelectorAll(e[1]));for(let t=0;t<n.length;t++)i=n[t],i.addEventListener("animationend",function(){this.classList.remove("animated","fadeOut"),this.removeEventListener("animationend",function(){})}),i.classList.remove("fadeIn","show"),i.classList.add("animated","fadeOut","hide")},nameAttr:function(i){const n=[];let s="";for(let e=0;e<i.length;e++){let t=i.charAt(e);t==t.toUpperCase()?(n.push(s),s="",s+=t.toLowerCase()):s+=t}return""!=s&&n.push(s),"data-model-"+n.join("-")},nameVar:function(e,t){if(-1==e.indexOf(t=t||"-"))return e;var i=e.split(t);let n="";for(let t=0;t<i.length;t++){const e=i[t];0==t?n+=e:n+=e.charAt(0).toUpperCase()+e.slice(1)}return n},camelcase:function(e,t){if(-1==e.indexOf(t))return e;var i=e.split(t);let n="";for(let t=0;t<i.length;t++){const e=i[t];0==t?n+=e:n+=e.charAt(0).toUpperCase()+e.slice(1)}return n},pascalcase:function(e,t){if(-1==e.indexOf(t))return e.charAt(0).toUpperCase()+e.slice(1);var i=e.split(t);let n="";for(let t=0;t<i.length;t++){const e=i[t];n+=e.charAt(0).toUpperCase()+e.slice(1)}return n},clone:function(t,e){for(var i in t=t||{})e[i]=t[i]},get:function(e){var i=Array.prototype.slice.call(arguments,1);let n={};for(let t=0;t<i.length;t++)n[i[t]]=e[i[t]];return n},isEmpty:function(t){let e=0;for(var i in t)e++;return 0==e},isBlank:function(t){let e=0;for(var i in t)null!=t[i]&&""!==t[i]&&e++;return 0==e},getParameter:function(t,e){e=e.replace(/[\[\]]/g,"\\$&");let i=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),n=i.exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},getParameters:function(t){if(-1==t.indexOf("?"))return{};let i={},n=(t=t.substring(t.indexOf("?")+1)).split("&");for(let e=0;e<n.length;e++){let t=n[e].split("=");if(1==t.length)return{};i[t[0].trim()]=decodeURIComponent(t[1].trim())}return i},isExisting:(e,i,n)=>{for(let t=0;t<e.length;t++)if(e[t][n]===i[n])return!0;return!1},textSize:(t,e)=>{const i=document.createElement("canvas"),n=i.getContext("2d");n.font=e;t=n.measureText(t);return console.log(t),i.remove(),{width:t.width,height:t.height}}},"undefined"==typeof dialog&&(dialog={}),dialog.alert=function(t){layer.open({type:0,icon:0,offset:"150px",shade:0,shadeClose:!0,title:"警告",content:t})},dialog.info=function(t){layer.open({type:0,offset:"150px",shade:0,shadeClose:!0,title:"信息",content:t})},dialog.info2=function(t){layer.open({type:0,offset:"100px",shade:.3,shadeClose:!0,title:"信息",content:t})},dialog.error=function(t){t=t.replaceAll("\n","<br>"),layer.open({type:0,icon:2,offset:"150px",shade:0,shadeClose:!0,title:"错误",content:t})},dialog.success=function(t,i){i?layer.open({type:0,icon:1,offset:"150px",shade:0,shadeClose:!0,title:"成功",content:t,btn:["确定","确定并返回"],yes:function(t,e){layer.close(t)},btn2:function(t,e){layer.close(t),i()}}):layer.open({type:0,icon:1,offset:"150px",shade:0,shadeClose:!0,title:"成功",content:t})},dialog.confirm=function(t,e){layer.confirm(t,{title:"确认",btn:["确定","取消"]},function(t){layer.close(t),e()},function(){})},dialog.view=function(i){let n=i.title;var t=i.url;$(document.body);$("#dialogApplication").length&&$("#dialogApplication").remove();let s=[];i.save&&s.push({text:"保存",class:"btn-save",onClicked:i.save}),$.ajax({url:t,success:function(t){let e=Handlebars.compile('<div class="modal fade fadeIn show" id="dialogApplication">  <div class="modal-dialog modal-dialog-centered">    <div class="modal-content">      <div class="modal-header">        <h4 class="modal-title">{{title}}</h4>        <button type="button" class="close" data-dismiss="modal">&times;</button>      </div>      <div id="dialogApplicationBody" class="modal-body">{{{body}}}</div>      <div class="modal-footer">        {{#each buttons}}        <button type="button" class="btn {{class}}" data-dismiss="modal">{{text}}</button>        {{/each}}        <button type="button" class="btn btn-close" data-dismiss="modal">关闭</button>      </div>    </div>  </div></div>');t=e({title:n,body:t,buttons:s});$(document.body).append(t),i.success&&i.success({onClosed:i.onClosed}),$("#dialogApplication").modal("show")}})},dialog.select=function(e){ajax.view({url:e.url,success:function(t){layer.open({type:0,icon:1,offset:"150px",shade:.5,shadeClose:!0,title:e.title,content:t})}})},dialog.simplelist=async function(i){var n=await xhr.promise({url:i.url,params:i.params||{}}),t=dom.element(`
    <div>
      <ul class="list-group"></ul>
    </div>
  `);let s=dom.find("ul",t);for(let e=0;e<n.length;e++){var o=n[e];let t=dom.create("li","list-group-item","list-group-item-action");dom.model(t,o),t.innerText=o[i.fields.text],s.appendChild(t)}layer.open({type:0,closeBtn:1,btn:[],shade:.5,shadeClose:!0,title:"",content:t.innerHTML,success:function(t,e){t.get(0).querySelectorAll("li").forEach((t,e)=>{dom.bind(t,"click",t=>{layer.close(layer.index);t=dom.model(t.target);i.onAccept(t)})})}})},dialog.html=function(i){layer.open({type:0,closeBtn:1,offset:"150px",shade:.5,area:["50%",""],shadeClose:!0,title:i.title||"&nbsp;",content:i.html,btn:["确定","关闭"],success:function(t,e){i.load&&i.load(t,e)},yes:function(t){layer.close(t),i.success()},btn1:function(){}})},dialog.iframe=function(t){layer.open({title:t.title,type:2,area:[t.width,t.height],content:t.url,resize:!1,maxmin:!0,shade:!1,success:t.success||function(t,e){}})},ListView.prototype.fetch=async function(t){var e={};t=t||{},utils.clone(this.params,e),utils.clone(t,e);this.url&&(this.data=this.data||{},this.data.start=this.start,this.data.limit=this.limit,e=await xhr.promise({url:this.url,params:e}),Array.prototype.push.apply(this.local,e)),0==this.local.length?this.emptyHtml&&(this.container.innerHTML=this.emptyHtml):this.append(this.local)},ListView.prototype.render=function(e,t){this.container="string"==typeof e?document.querySelector(e):e,this.container.innerHTML="";e=this.height-37;if(this.onFilter){let t=dom.element(`
      <div class="input-group position-sticky" style="top: 0; left: 0; z-index: 10;">
        <div class="input-group-prepend">
          <span class="input-group-text" style="border-bottom-left-radius: unset;">
            <i class="fas fa-search"></i>
          </span>
        </div>
        <input class="form-control" placeholder="搜索..."  style="border-bottom-right-radius: unset;">
        <div class="input-group-append">
          <span class="input-group-text pointer text-primary" style="border-bottom-right-radius: unset;">
            <i class="fas fa-plus"></i>
          </span>
          <span class="input-group-text" style="border-bottom-right-radius: unset;">
            <i class="fas fa-question icon-general"></i>
          </span>
          <span class="input-group-text" style="border-bottom-right-radius: unset;">
            <i class="fas fa-asterisk icon-required"></i>
          </span>
        </div>
      </div>
    `),e=dom.find("input",t);dom.bind(e,"input",t=>{clearTimeout(this.delayToSearch),this.delayToSearch=setTimeout(()=>{this.onFilter(this,e.value)},500)}),this.required||t.children[2].children[2].remove(),this.tooltip||t.children[2].children[1].remove(),this.onAdd||t.children[2].children[0].remove(),0==t.children[2].children.length&&t.children[2].remove(),this.container.appendChild(t)}let i=dom.create("ul","list-group","full-width");if(this.borderless&&i.classList.add("b-a-0"),this.onFilter){let t=dom.create("div");t.style.height=e+"px",t.style.overflowY="auto",t.style.border="1px solid rgba(0, 0, 0, 0.125)",t.style.borderTop="",t.appendChild(i),this.container.appendChild(t)}else this.container.appendChild(i);!1!==t&&!0!==this.lazy&&this.reload()},ListView.prototype.reload=function(t){t=t||{};let e=dom.find("ul",this.container);e.innerHTML="",this.start=0,this.url&&(this.local=[]),this.fetch(t)},ListView.prototype.load=function(){this.start=this.local.length,this.fetch()},ListView.prototype.remove=function(i){if(this.idField){var n=dom.find("ul",this.container);for(let e=0;e<n.children.length;e++){let t=n.children[e];dom.model(t)[this.idField]===i[this.idField]&&t.remove()}}},ListView.prototype.append=function(e,i){let n=this,o=this.container.querySelector("ul");var a=o.querySelectorAll("li").length;if(Array.isArray(e)){var s=e;for(let t=0;t<s.length;t++)this.append(s[t]);n.complete&&n.complete(e)}else{var l=e;if(this.idField)for(let t=0;t<o.children.length;t++){var r=o.children[t];if(dom.model(r)[this.idField]===l[this.idField])return}let s=dom.create("li","list-group-item");!1!==this.hoverable&&s.classList.add("list-group-item-action"),!0===this.activateable&&dom.bind(s,"click",t=>{for(let e=0;e<s.parentElement.children.length;e++){let t=s.parentElement.children[e];t.classList.remove("active")}s.classList.add("active")});for(let t=0;t<this.itemClass.length;t++)s.classList.add(this.itemClass[t]);this.borderless&&s.classList.add("b-a-0"),this.onClick&&dom.bind(s,"click",this.onClick),s.style.paddingLeft="16px",s.style.paddingRight="16px",s.style.paddingTop="8px",s.style.paddingBottom="8px",s.style.display="flex",s.style.alignItems="center",this.onFilter&&(s.style.borderLeftWidth="0",s.style.borderRightWidth="0",s.style.borderBottomWidth="0");let t=this.create(a,l,s);if(t.style.width="100%",this.onCheck){let e=dom.element(`
        <input class="pointer checkbox color-info is-outline mr-2" type="checkbox">
      `);for(let t=0;t<this.selections.length;t++)if(this.compare(this.selections[t],l)){e.setAttribute("checked",!0);break}dom.bind(e,"change",function(){n.onCheck(this.checked,dom.model(this),this)}),dom.model(e,l),s.appendChild(e)}if(s.appendChild(t),0<this.slidingActions.length){this.actionElements=[];for(let e=0;e<this.slidingActions.length;e++){let t=this.slidingActions[e];t.width=parseInt(t.width||64),s.appendChild(t.create())}dom.bind(s,"touchstart",t=>{this.touchStartX=t.touches[0].screenX,this.touchStartY=t.touches[0].screenY}),dom.bind(s,"touchmove",t=>{this.touchMoveX=t.touches[0].screenX,this.touchMoveY=t.touches[0].screenY;let i=this.touchStartX-this.touchMoveX;t=this.touchStartY-this.touchMoveY;if(!(Math.abs(i)<30||30<Math.abs(t)))if(0<i){let e=i/this.slidingActions.length;for(let t=1;t<s.children.length;t++)s.children[t].getBoundingClientRect().width>=this.slidingActions[t-1].width||(e>=this.slidingActions[t-1].width&&(e=this.slidingActions[t-1].width),s.children[t].style.minWidth=e+"px",s.children[t].style.display="")}else{i=-i/10;var n=i/this.slidingActions.length;for(let e=1;e<s.children.length;e++){let t=s.children[e].getBoundingClientRect().width-n;t=t<=5?0:t,0==t?(s.children[e].style.width="0",s.children[e].style.minWidth="unset"):s.children[e].style.minWidth=t+"px"}}}),dom.bind(s,"touchend",t=>{this.touchendX=t.changedTouches[0].screenX,this.touchendY=t.changedTouches[0].screenY;var e=this.touchStartX-this.touchendX,t=this.touchStartY-this.touchendY;Math.abs(e)<30||30<Math.abs(t)||(30<=e?this.expandSlidingActions(s):this.collapseSlidingActions(s))})}this.idField&&s.setAttribute("data-list-item-id",l[this.idField]),dom.model(s,l),"number"==typeof i?i<0?o.insertBefore(s,o.children[o.children.length+i]):o.insertBefore(s,o.children[i]):o.appendChild(s),this.onRemove&&(i=dom.element(`
        <a class="btn text-danger float-right font-18" style="padding: 0; margin-left: auto;">
          <i class="fas fa-times" style=""></i>
        </a>
      `),dom.bind(i,"click",function(t){t.stopPropagation(),n.onRemove(this.parentElement,dom.model(this.parentElement))}),dom.model(i,l),s.appendChild(i)),this.onReorder?this.setReorderable(s):this.draggable&&(s.setAttribute("draggable","true"),s.addEventListener("dragover",function(t){t.preventDefault()}),s.addEventListener("dragstart",function(t){}))}},ListView.prototype.replace=function(i){var n=this.container.querySelector("ul");for(let e=0;e<n.children.length;e++){let t=n.children[e];if(dom.model(t)[this.idField]===i[this.idField]){dom.model(t,i),t.innerHTML="",t.appendChild(this.create(e,i));break}}},ListView.prototype.search=function(i){var n=this.container.querySelector("ul");for(let e=0;e<n.children.length;e++){let t=n.children[e];-1!=t.innerText.indexOf(i)?t.style.display="":t.style.display="none"}},ListView.prototype.setReorderable=function(t){let e=dom.find("ul",this.container);e.addEventListener("dragover",function(t){t.preventDefault()}),e.ondrop=t=>{this.onReorder&&this.onReorder(dom.model(this.draggingElement),this.getItemIndex(this.draggingElement),this.draggingElementOriginalIndex),this.draggingElement.style.opacity="",this.draggingElement=null,this.clonedDraggingElement=null},t.setAttribute("draggable","true"),t.ondragover=t=>{var e,i=dom.ancestor(t.target,"li");let n=i.parentElement;i!=this.draggingElement&&((e=this.getItemIndex(i))<this.draggingElementIndex?n.insertBefore(this.draggingElement,i):e>this.draggingElementIndex&&(null==i.nextElementSibling?n.appendChild(this.draggingElement):n.insertBefore(this.draggingElement,i.nextElementSibling)),this.draggingElementIndex=e,t.preventDefault())},t.ondragstart=t=>{let e=dom.ancestor(t.target,"li");e.parentElement,t.layerX;var i=t.layerY,i=t.target.offsetTop+i;this.clonedDraggingElement=e.cloneNode(!0),this.draggingElement=e,this.draggingElement.style.opacity="0.3",this.draggingElementIndex=this.getItemIndex(e),this.draggingElementOriginalIndex=this.draggingElementIndex,t.dataTransfer.setData("id",e.getAttribute("data-list-item-id")),t.dataTransfer.setData("y",i)}},ListView.prototype.getItemIndex=function(e){var i=e.parentElement;for(let t=0;t<i.children.length;t++)if(e==i.children[t])return t},ListView.prototype.setHeight=function(t){let e=this.container.querySelector("ul");e.style.height=t+"px"},ListView.prototype.activate=function(t){let e=this.container.querySelector("ul");for(let t=0;t<e.children.length;t++)e.children[t].classList.remove("active");t.classList.add("active")},ListView.prototype.expandSlidingActions=function(e){if(!(e.children[1].getBoundingClientRect().width>=this.slidingActions[0].width.width)){let t=i=>{for(let e=1;e<i.children.length;e++){let t=i.children[e];var n=t.getBoundingClientRect();n.width+5>=this.slidingActions[e-1].width?(t.style.minWidth=this.slidingActions[e-1].width+"px",clearInterval(this.interval4SlidingActions)):t.style.minWidth=n.width+5+"px"}};this.interval4SlidingActions=setInterval(()=>{t(e)},5)}},ListView.prototype.collapseSlidingActions=function(n){n.children[1].getBoundingClientRect().width<=0||(this.interval4SlidingActions=setInterval(()=>{for(let e=1;e<n.children.length;e++){let t=n.children[e];var i=t.getBoundingClientRect();i.width-5<=0?(t.style.width="0",t.style.minWidth="unset",t.style.display="none",clearInterval(this.interval4SlidingActions)):t.style.minWidth=i.width-5+"px"}},10))},ListView.prototype.subscribe=function(t,e){},GridView.prototype.fetch=async function(t){if(!this.url)return this.local;t=await xhr.promise({url:this.url,params:this.params},t);return t&&(this.local=t),this.local},GridView.prototype.root=async function(){var t=dom.element(`
    <div class="row mx-0">
      <div class="col-24-12 pr-1"></div>
      <div class="col-24-12 pl-1"></div>
    </div>
  `);let e=t.children[0],i=t.children[1];this.local=await this.fetch();for(let t=0;t<this.local.length;t++){var n=this.local[t],n=this.create(t,n);(t%2==0?e:i).appendChild(n)}return t},GridView.prototype.render=async function(t){this.container=dom.find(t),this.container.appendChild(await this.root())},Timeline.prototype.createTile=function(t,e){var i,n=dom.element(`
    <li class="timeline-item">
      <div class="time"></div>
      <div class="small text-muted"></div>
      <p></p>
    </li>
  `);let s=n.children[0],o=n.children[1],a=n.children[2];return this.fnTitle&&(void 0===(i=this.fnTitle(t,e))?s.innerHTML="":"string"==typeof i||"number"==typeof i?s.innerHTML=i:s.appendChild(i)),this.fnSubtitle&&(void 0===(i=this.fnSubtitle(t,e))?o.innerHTML="":"string"==typeof i||"number"==typeof i?o.innerHTML=i:o.appendChild(i)),this.fnContent&&(void 0===(e=this.fnContent(t,e))?a.innerHTML="":"string"==typeof e||"number"==typeof e?a.innerHTML=e:a.appendChild(e)),n},Timeline.prototype.render=function(t,e){let i=this;this.container="string"==typeof t?document.querySelector(t):t,this.container.innerHTML="",e=e||{};let n=dom.create("ul","timeline-simple");this.container.appendChild(n);t={};if(utils.clone(this.params,t),utils.clone(e,t),this.url)xhr.post({url:this.url,params:t,success:function(t){if(t.data){var e=t.data;for(let t=0;t<e.length;t++)n.appendChild(i.createTile(e[t],t))}}});else for(let t=0;t<i.data.length;t++)n.appendChild(i.createTile(i.data[t],t));i.onComplete&&i.onComplete()},Tabs.prototype.loadPage=function(t,e,i,n){let s=dom.templatize('<div data-tab-content-id="{{id}}"></div>',{id:t});void 0!==e&&ajax.view({url:e,containerId:s,success:n||function(){}}),!0===i&&(s.style.display="none"),this.content.appendChild(s)},Tabs.prototype.render=function(){let o=this;this.content&&(this.content.innerHTML=""),this.navigator.innerHTML="",this.slider=dom.element('<div class="slider position-absolute"></div>'),this.navigator.appendChild(this.slider),this.tabs.forEach((n,t)=>{n.style=n.style||"padding: 0 16px;",n.style+="min-width: "+(16*n.text.length+32)+"px;text-align: center;";let s=dom.templatize(`
      <div class="nav-item font-weight-bold mr-0 pointer" style="{{style}}"
           data-tab-url="{{{url}}}"
           data-tab-id="{{{id}}}" >{{{text}}}</div>
    `,n);o.navigator.appendChild(s),dom.bind(s,"click",e=>{if(!s.classList.contains(o.tabActiveClass)){for(let e=0;e<o.navigator.children.length;e++){let t=o.navigator.children[e];t.classList.remove(o.tabActiveClass)}for(let t=0;t<o.content.children.length;t++)o.content.children[t].style.display="none";o.activate(s),!0===this.autoClear&&(this.content.innerHTML="");let t=dom.find('div[data-tab-content-id="'+s.getAttribute("data-tab-id")+'"]',o.content);var i;null!=t?t.style.display="":n.onClicked?n.onClicked(e):(i=s.getAttribute("data-tab-id"),e=s.getAttribute("data-tab-url"),o.loadPage(i,e,!1,n.success))}}),!0===o.lazy?0==t&&(o.activate(s),n.onClicked?n.onClicked():o.loadPage(n.id,n.url,!1,n.success)):0==t?(o.activate(s),n.onClicked?n.onClicked(ev):o.loadPage(n.id,n.url,!1,n.success)):n.onClicked?n.onClicked(ev):o.loadPage(n.id,n.url,!0,n.success)})},Tabs.prototype.activate=function(t){t.classList.add(this.tabActiveClass),this.slider.style.width=t.clientWidth+"px",this.slider.style.left=t.offsetLeft+"px"},DataSheet.prototype.root=function(s){s=s||{};let o=this;this.table=dom.create("table","table","table-bordered");let t=dom.create("thead");this.tbody=dom.create("tbody");let e=dom.create("tr"),i=dom.create("th");i.style.borderBottomWidth="0",i.style.width=this.rowHeaderWidth+"px",t.appendChild(e),this.table.appendChild(t),this.table.appendChild(this.tbody);for(let t=0;t<this.columns.length;t++){var n=this.columns[t];i=dom.create("th","text-center"),i.style.borderBottomWidth="0",i.innerHTML=n.title,e.appendChild(i)}for(let n=0;n<this.rowCount;n++){var a=this.rowHeaders[n];let e=dom.create("tr"),i=dom.create("td");i.innerHTML=a.title,i.style.fontWeight="bold",e.appendChild(i);for(let t=0;t<this.columnCount;t++){var l=this.columns[t];i=dom.create("td"),i.style.textAlign="right",i.style.padding="6px 12px",i.setAttribute("data-ds-format",l.format||""),i.setAttribute("data-ds-row",n),i.setAttribute("data-ds-column",t),i.addEventListener("focus",function(){}),s[a.title]&&s[a.title][l.title]?i.innerHTML=s[a.title][l.title]:i.innerHTML="",i.addEventListener("keyup",function(t){var e=parseInt(this.getAttribute("data-ds-row")),i=parseInt(this.getAttribute("data-ds-column"));let n=null;if(13==t.keyCode)n=this;else if(37==t.keyCode){if(0==i)return;n=o.getCell(e,i-1)}else if(38==t.keyCode){if(0==e)return;n=o.getCell(e-1,i)}else if(39==t.keyCode){if(i==o.columnCount-1)return;n=o.getCell(e,i+1)}else if(40==t.keyCode){if(e==o.rowCount-1)return;n=o.getCell(e+1,i)}o.totalize(),null!=n&&(this.blur(),n.focus(),document.execCommand("selectAll",!1,null))}),e.appendChild(i)}this.tbody.appendChild(e)}if(0<this.totalColumns.length){let e=dom.create("tr"),i=dom.create("td");i.innerHTML="合计",i.style.fontWeight="bold",e.appendChild(i);for(let t=0;t<this.columnCount;t++)i=dom.create("td"),e.appendChild(i);this.tbody.appendChild(e)}return this.totalize(),this.table},DataSheet.prototype.getCell=function(e,i){var n=dom.find("tbody",this.table);let s=null;for(let t=0;t<n.children.length;t++){var o=n.children[t];if(t==e){for(let t=1;t<o.children.length;t++)if(t-1==i){s=o.children[t];break}break}}return s},DataSheet.prototype.render=function(t,e){this.container=dom.find(t),this.container.innerHTML="";t=dom.element(`
    <table class="table table-bordered">
      <thead></thead>
      <tbody></tbody>
    </table>
  `);let i=dom.find("thead",t),n=dom.find("tbody",t);this.rowHeaderRowCount,this.colHeaderRowCount;let s=[];for(let t=0;t<this.colHeaderRowCount;t++){var o=dom.create("tr");s.push(o),i.appendChild(o)}for(let i=0;i<this.colHeaderRowCount;i++){let e=s[i];for(let t=0;t<this.colHeaderColumnCount;t++){var a=this.matrixColumn[i][t];if(null!=a){let t=dom.create("th","text-center");t.style="border-bottom-width: 1px;",t.setAttribute("colspan",this.getSpanColumnCount(a)),t.innerHTML=a.title,e.appendChild(t)}}}for(let i=0;i<this.rowHeaderRowCount;i++){let e=dom.create("tr");for(let t=0;t<this.rowHeaderColumnCount;t++){var l=this.matrixRowHeader[t][i];if(null!=l){let i=dom.create("td");i.style="vertical-align: middle;",i.setAttribute("rowspan",this.getSpanRowCount(l)),i.innerHTML="<strong>"+l.title+"</strong>",this.onRowHeaderClicked&&(i.onclick=t=>{let e=Array.prototype.slice.call(i.parentElement.children);this.onRowHeaderClicked(i,e.indexOf(i))}),e.appendChild(i)}}for(let t=0;t<this.colHeaderColumnCount-this.rowHeaderColumnCount;t++){let i=dom.create("td");i.style.textAlign="right",i.style.padding="6px 12px",this.onCellClicked&&(i.onclick=t=>{let e=Array.prototype.slice.call(i.parentElement.children);this.onCellClicked(i,e.indexOf(i))}),e.appendChild(i)}n.appendChild(e)}this.container.appendChild(t)},DataSheet.prototype.getValues=function(){let i={};for(let e=0;e<this.rowHeaders.length;e++){var n=this.rowHeaders[e];i[n.title]={};for(let t=0;t<this.columns.length;t++){var s=this.columns[t];i[n.title][s.title]=this.tbody.rows[e].cells[t+1].innerText.trim()}}return i},DataSheet.prototype.totalize=function(){if(0!=this.totalColumns.length){let t=this.tbody.children[this.tbody.children.length-1];for(let n=0;n<this.columns.length;n++)if(!0===this.columns[n].totalable){let e=0,i=!1;for(let t=0;t<this.rowHeaders.length;t++){var s=parseFloat(this.tbody.rows[t].cells[n+1].innerText.trim());isNaN(s)||(e+=s,i=!0)}isNaN(e)||!0!==i||(t.cells[n+1].innerText=e.toFixed(2))}}},DataSheet.prototype.buildColumnMatrix=function(i,n,s){if(i){let e;n[s]?e=n[s]:(e=[],n.push(e));for(let t=0;t<i.length;t++){var o=i[t];e.push(o);var a=this.getSpanColumnCount(o);for(let t=1;t<a;t++)e.push(null);this.buildColumnMatrix(o.children,n,s+1)}}},DataSheet.prototype.buildRowHeaderMatrix=function(i,n,s){if(i){let e;n[s]?e=n[s]:(e=[],n.push(e));for(let t=0;t<i.length;t++){var o=i[t];e.push(o);var a=this.getSpanRowCount(o);for(let t=1;t<a;t++)e.push(null);this.buildRowHeaderMatrix(o.children,n,s+1)}}},DataSheet.prototype.getSpanColumnCount=function(e){let i=0;if(!e.children||0==e.children.length)return 1;for(let t=0;t<e.children.length;t++)i+=this.getSpanColumnCount(e.children[t]);return i},DataSheet.prototype.getSpanRowCount=function(t){return t.children&&0!=t.children.length?t.children.length:1},DataSheet.prototype.getRowCount=function(e){let i=0;for(let t=0;t<e.length;t++){var n=e[t];i+=1,n.children&&(i+=this.getRowCount(n.children))}return i},DataSheet.prototype.getColumnCount=function(e){let i=0;for(let t=0;t<e.length;t++){var n=e[t];i+=1,n.children&&(i+=this.getColumnCount(n.children))}return i},DataSheet.prototype.getColumnHeaderRowCount=function(i){let n=1;for(let e=0;e<i.length;e++){let t=1;var s=i[e];s.children&&(t+=this.getColumnHeaderRowCount(s.children)),t>n&&(n=t)}return n},DataSheet.prototype.getRowHeaderRowCount=function(e){let i=0;for(let t=0;t<e.length;t++){var n=e[t];n.children?i+=this.getRowHeaderRowCount(n.children):i+=1}return i},DataSheet.prototype.getColumnHeaderColumnCount=function(e){let i=0;for(let t=0;t<e.length;t++){var n=e[t];n.children?i+=this.getColumnHeaderColumnCount(n.children):i+=1}return i},DataSheet.prototype.getRowHeaderColumnCount=function(i){let n=1;for(let e=0;e<i.length;e++){let t=1;var s=i[e];s.children&&(t+=this.getRowHeaderColumnCount(s.children)),t>n&&(n=t)}return n},Chat.MESSAGE_TYPE_TEXT="TEXT",Chat.MESSAGE_TYPE_IMAGE="IMAGE",Chat.MESSAGE_TYPE_AUDIO="AUDIO",Chat.MESSAGE_TYPE_VIDEO="VIDEO",Chat.MESSAGE_TYPE_PATIENT="PATIENT",Chat.MESSAGE_TYPE_CUSTOM="CUSTOM",Chat.MESSAGE_STATUS_UNREAD="01",Chat.MESSAGE_STATUS_READ="02",Chat.MESSAGE_STATUS_REVOKE="90",Chat.prototype.init=async function(t){await this.onInit();this.scheduleName=t;var e=this.userId+"@"+this.userType,i=await xhr.promise({url:this.host+"/api/v3/common/script/tim/user_signature",params:{userId:e}}),t={SDKAppID:i.appId};this.tim=TIM.create(t),this.tim.setLogLevel(1),this.tim.registerPlugin({"tim-upload-plugin":TIMUploadPlugin}),this.tim.login({userID:e,userSig:i.signature}),this.tim.on(TIM.EVENT.SDK_READY,function(t){}),this.tim.on(TIM.EVENT.MESSAGE_RECEIVED,s=>{for(let n=0;n<s.data.length;n++){let t=s.data[n],e=Chat.MESSAGE_TYPE_TEXT,i=null;"TIMCustomElem"===t.type?(i=JSON.parse(t.payload.data).messageContent,i.imagepath?e=Chat.MESSAGE_TYPE_IMAGE:i.audiopath?e=Chat.MESSAGE_TYPE_AUDIO:i.archiveId&&(e=Chat.MESSAGE_TYPE_PATIENT)):i=t.payload.text,this.onMessageReceived({senderId:t.conversationID.substring(3),messageTime:moment(1e3*s.data[n].time).format("YYYY-MM-DD HH:mm"),messageType:e,messageContent:i})}})},Chat.prototype.getConversations=async function(){var t,e=await xhr.promise({url:this.host+"/api/v3/common/script/stdbiz/pim/conversation_message/find",params:{status:Chat.MESSAGE_STATUS_UNREAD,receiverId:this.userId}});let i={};for(let t=0;t<e.length;t++){var n=e[t],s=n.senderId+"#"+n.senderType;if(i[s]){let t=i[s];t.createTime=n.createTime,t.messages.push(n)}else{let t={messages:[]};i[s]=t,t.id=s,t.createTime=n.createTime,t.name=n.senderType,t.senderId=n.senderId,t.senderType=n.senderType,t.messages.push(n)}}let o=[];for(t in i)o.push(i[t]);return o},Chat.prototype.fetchMessages=async function(t,e,i){let n="";n=t>this.userId?t+"&"+this.userId:this.userId+"&"+t;var s=await xhr.promise({url:this.host+"/api/v3/common/script/stdbiz/pim/conversation_message/find",params:{conversationId:n,_order_by:"messageTime asc"}});let o=[],a=null;for(let n=0;n<s.length;n++){var l=s[n],r=moment(l.createTime).format("YYYY-MM-DD HH:mm");r!=a&&(a=r,o.push({createTime:r,groupingMessages:[{direction:l.senderId==this.userId?"outgoing":"incoming",messages:[]}]}));let t=o[o.length-1],e=t.groupingMessages[t.groupingMessages.length-1],i="";i=l.senderId==this.userId?"outgoing":"incoming",e.direction===i?e.messages.push(l):t.groupingMessages.push({direction:i,messages:[l]})}return o},Chat.prototype.fetchUnreadMessages=function(){let e=this;xhr.promise({url:this.host+"/api/v3/common/script/stdbiz/pim/conversation_message/find",params:{status:Chat.MESSAGE_STATUS_UNREAD,receiverId:this.userId,receiverType:this.userType}}).then(t=>{e.onUnreadMessages(t)})},Chat.prototype.sendMessage=async function(t,e,i,n,s){return s=s||this.userId+"&"+t,"string"==typeof n&&(n=n.replace("\\","\\\\")),xhr.promise({url:this.host+"/api/v3/common/script/stdbiz/pim/conversation_message/save",params:{conversationId:s,senderId:this.userId,senderType:this.userType,receiverId:t,receiverType:e,messageType:i,messageTime:"now",messageContent:n,createTime:"now",status:Chat.MESSAGE_STATUS_UNREAD,"||stdbiz/pim/conversation/merge":{conversationId:s,conversationName:s,unreadCount:1,lastConversationTime:"now"}}})},Chat.prototype.sendTextMessage=async function(t,e,i,n){var s=t+"@"+e,n=await this.sendMessage(t,e,Chat.MESSAGE_TYPE_TEXT,i,n),i=this.tim.createTextMessage({to:s,conversationType:TIM.TYPES.CONV_C2C,payload:{id:n.conversationMessageId,text:i}});return this.tim.sendMessage(i)},Chat.prototype.sendImageMessage=async function(t,e,i,n){var s=t+"@"+e,i=await xhr.promise({url:this.host+"/api/v3/common/image",params:{directoryKey:"chat",filedata:i.data.substring(i.data.indexOf(",")+1),fileext:i.ext}}),n=await this.sendMessage(t,e,Chat.MESSAGE_TYPE_IMAGE,JSON.stringify({imagepath:i.filepath,thumbnail:i.thumbnail}),n),i=this.tim.createCustomMessage({to:s,conversationType:TIM.TYPES.CONV_C2C,payload:{data:JSON.stringify({messageType:Chat.MESSAGE_TYPE_IMAGE,messageContent:{id:n.conversationMessageId,imagepath:i.filepath,thumbnail:i.thumbnail}})}});return this.tim.sendMessage(i)},Chat.prototype.sendAudioMessage=async function(t,e,i,n){var s=t+"@"+e,i=await xhr.promise({url:this.host+"/api/v3/common/audio",params:{directoryKey:"chat",filedata:i.data.substring(i.data.indexOf(",")+1),fileext:"ogg"}}),n=await this.sendMessage(t,e,Chat.MESSAGE_TYPE_AUDIO,JSON.stringify({audiopath:i.filepath,duration:i.duration}),n),i=this.tim.createCustomMessage({to:s,conversationType:TIM.TYPES.CONV_C2C,payload:{data:JSON.stringify({messageType:Chat.MESSAGE_TYPE_AUDIO,messageContent:{id:n.conversationMessageId,audiopath:i.filepath,duration:i.duration}})}});return this.tim.sendMessage(i)},Chat.prototype.sendPatientMessage=async function(t,e,i,n){var s=t+"@"+e,n=await this.sendMessage(t,e,Chat.MESSAGE_TYPE_PATIENT,JSON.stringify(i),n);i.id=n.conversationMessageId;i=this.tim.createCustomMessage({to:s,conversationType:TIM.TYPES.CONV_C2C,payload:{data:JSON.stringify({messageType:Chat.MESSAGE_TYPE_PATIENT,messageContent:i})}});return this.tim.sendMessage(i)},Chat.prototype.readMessages=function(t){let e=this;xhr.promise({url:this.host+"/api/v3/common/script/stdbiz/pim/conversation_message/update",params:{senderId:t,readTime:"now",status:Chat.MESSAGE_STATUS_READ}}).then(t=>{e.onReadMessages(t)})},Chat.prototype.revokeMessage=function(e){return xhr.promise({url:this.host+"/api/v3/common/script/stdbiz/pim/conversation_message/update",params:{messageId:e,status:Chat.MESSAGE_STATUS_REVOKE}}).then(t=>{this.onRevokeMessage(e)})},Chat.prototype.stop=function(){schedule.stop(this.scheduleName)},"undefined"!=typeof module&&(module.exports={Chat:Chat}),Sparkline.PADDING=3,Sparkline.prototype.render=function(t){this.container=dom.find(t);var e=this.container.getBoundingClientRect(),i=e.width,t=e.height;let n=0,s=0;for(let t=0;t<this.data.length;t++){var o=parseFloat(this.data[t]);0==n&&(n=o),n>o&&(n=o),s<o&&(s=o)}let a=document.createElement("canvas");a.width=i,a.height=t,this.container.appendChild(a);e=a.getContext("2d");"line"==this.type?this.line(e,s,n,i,t):"bar"==this.type&&this.bar(e,s,n,i,t),this.container.appendChild(a)},Sparkline.prototype.line=function(e,t,i,n,s){var t=Math.abs(t-i),o=(s-2*Sparkline.PADDING)/t,a=n/(this.data.length-1);e.strokeStyle=this.color,e.lineWidth=3,e.beginPath();for(let t=0;t<this.data.length;t++){var l=t*a,r=s-(this.data[t]-i)*o-Sparkline.PADDING;0==t?e.moveTo(l,r):e.lineTo(l,r)}e.stroke()},Sparkline.prototype.bar=function(n,t,e,i,s){Math.abs(t-e);var o=(s-2*Sparkline.PADDING)/t;let a=i/this.data.length-Sparkline.PADDING;n.fillStyle=this.color,n.lineWidth=0,n.beginPath();for(let i=0;i<this.data.length;i++){let t=(a+Sparkline.PADDING)*i,e=s-Sparkline.PADDING-this.data[i]*o;n.rect(t.toFixed(0),e.toFixed(0),a.toFixed(0),(this.data[i]*o).toFixed(0)),n.fill()}},ruler={initPlugin:function(t){let n={el:t.el,height:t.height||60,maxScale:t.maxScale||200,startValue:t.startValue||0,region:t.region||!1,background:t.background||!1,color:t.color||!1,markColor:t.markColor||"#FFCC33",isConstant:t.isConstant||!1,minicolor:t.minicolor||"#f6f6f6",scale:t.scale||1,point:t.point||0};if(!n.el)return console.warn("没有容器元素的参数"),!1;let e=t.el;e.style.height=n.height<50?"50px":n.height+"px",n.maxScale=n.maxScale<50?50:n.maxScale,n.startValue>n.maxScale&&(n.startValue=n.maxScale);let i=0,s=n.maxScale;n.region&&(i=Math.floor(n.region[0]),s=Math.floor(n.region[1]));let o=n.startValue,a=e.offsetWidth,l=a/50,r=[];for(let t=0;t<=n.maxScale;t+=10)r.push((t/n.scale).toFixed(n.point));let d=e.getElementsByTagName("canvas")[0];d||(d=document.createElement("canvas"),d.width=a,d.height=n.height,e.appendChild(d));let c=d.getContext("2d");function u(i){i-=25,c.clearRect(0,0,a,n.height),n.background&&(c.fillStyle=n.background,c.fillRect(0,0,d.width,n.height));for(let t=0;t<n.maxScale;t++)c.beginPath(),c.save(),c.strokeStyle=n.minicolor||"#F6F6F6",c.lineWidth=1,c.lineCap="round",c.moveTo(l*t-i*l,0),c.lineTo(l*t-i*l,Math.floor(.3*n.height)),t%5==0&&(c.strokeStyle=n.color||"#999",c.lineTo(l*t-i*l,Math.floor(.35*n.height))),t%10==0&&(c.strokeStyle=n.color||"#666",c.lineTo(l*t-i*l,Math.floor(.52*n.height))),c.stroke(),c.restore(),c.closePath();c.beginPath(),c.font="14px Arial",c.fillStyle=n.color||"#333",c.textAlign="center",c.textBaseline="middle",r.forEach(function(t,e){c.fillText(t.toString(),l*e*10-i*l,Math.floor(.78*n.height))}),c.closePath(),c.beginPath(),c.save(),c.strokeStyle=n.markColor,c.lineWidth=2,c.lineCap="round",c.moveTo(a/2,0),c.lineTo(a/2,Math.floor(.52*n.height)),c.stroke(),c.restore(),c.closePath()}window.devicePixelRatio&&(d.width=window.devicePixelRatio*a,d.height=window.devicePixelRatio*n.height,c.scale(window.devicePixelRatio,window.devicePixelRatio)),window.devicePixelRatio&&(d.style.transform="scale("+1/window.devicePixelRatio+")",d.style.transformOrigin="left top"),u(o);let h=0,p=0,m=0,f=0,g=o;if(!d)return!1;d.addEventListener("touchstart",function(t){h=t.targetTouches[0].pageX},!1),d.addEventListener("touchmove",function(t){p=t.targetTouches[0].pageX,y()},!1),d.addEventListener("touchend",function(t){g=o,b()},!1);let v=!1;function y(){m=Math.floor((p-h)/(a/50)),m!==f&&(f=m,o=g+m,(o>=n.maxScale||o<=0)&&(o=o>=n.maxScale?n.maxScale:0),u(o),n.isConstant&&t.success&&t.success(o))}function b(){o>s?g=o=o>s?s:o:o<i&&(g=o=o<i?i:o),u(o),t.success&&t.success(o)}d.addEventListener("mousedown",function(t){v=!0,h=t.layerX},!1),d.addEventListener("mousemove",function(t){return!!v&&(p=t.layerX,void y())},!1),d.addEventListener("mouseup",function(t){g=o,v=!1,b()},!1),d.addEventListener("mouseleave",function(t){v&&(g=o,v=!1,b())},!1)}},MobileWizard.prototype.render=function(t,e){this.container=dom.find(t),this.content=dom.find("div.wizard-content",this.root);let n=dom.find("div.wizard-progress",this.root);for(let i=0;i<this.steps.length;i++){let t=this.steps[i];var s=i+1;let e=dom.element(`
      <div class="step-${s}" widget-on-render="" data-step="${i}" style="cursor: pointer;">
        <strong class="title"></strong>
      </div>
    `);t.index=i,e.style.width=100/this.steps.length+"%",!0===t.active&&(this.current=t),dom.find("strong.title",e).innerHTML=t.title,n.appendChild(e)}this.container.appendChild(this.root),this.display(this.current)},MobileWizard.prototype.display=function(t){let e=dom.find('div[data-step="'+t.index+'"]',this.root);e.classList.remove("completed"),e.classList.add("active"),t.onClicked||kuim.navigateWidget(t.url,this.content,{wizard:this})},MobileWizard.prototype.commit=function(t){let e=dom.find("div.active",this.root);var i=parseInt(e.getAttribute("data-step"));e.classList.remove("active"),e.classList.add("completed"),this.display(this.steps[i+1])},MobileWizard.prototype.rollback=function(){let t=dom.find("div.step.active",this.container);var e=parseInt(t.getAttribute("data-step"));t.classList.remove("active"),this.display(this.steps[e-1])},MobileForm.prototype.render=async function(t){t.innerHTML="";var e=await this.root();t.appendChild(e)},MobileForm.prototype.root=async function(){let i=dom.element(`
    <div class="form form-horizontal"></div>
  `);for(let e=0;e<this.fields.length;e++){var n=this.fields[e];let t=null;"date"===n.input?t=this.buildDate(n):"select"===n.input?t=await this.buildSelect(n):"hidden"===n.input?t=dom.templatize(`
        <input type="hidden" name="{{name}}">
      `,n):"mobile"===n.input?t=this.buildMobile(n):"id"===n.input?t=this.buildId(n):"district"===n.input?t=this.buildDistrict(n):(t=dom.templatize(`
        <div class="form-group row">
          <label class="col-form-label col-24-06">{{title}}</label>
          <div class="col-24-18">
            <input type="text" name="{{name}}" class="form-control" placeholder="请填写">
          </div>
        </div>
      `,n),!0===this.readonly&&(dom.find("input",t).setAttribute("placeholder",""),dom.find("input",t).setAttribute("readonly",!0))),i.appendChild(t)}return i},MobileForm.prototype.buildDate=function(e){let t=dom.templatize(`
    <div class="form-group row">
      <label class="col-form-label col-24-06">{{title}}</label>
      <div class="col-24-18 d-flex">
        <input type="text" class="form-control" readonly placeholder="请选择...">
        <input type="hidden" name="{{name}}">
        <span class="ml-auto material-icons font-16 position-relative" style="top: 5px; left: -2px;">calendar_today</span>
      </div>
    </div>
  `,e);return!0===this.readonly?t.querySelectorAll("input")[0].setAttribute("placeholder",""):dom.bind(t,"click",i=>{let t=new Rolldate({title:e.title,confirm:t=>{var e=dom.ancestor(i.target,"div","col-24-18");dom.find("input[type=text]",e).value=moment(t).format("YYYY年MM月DD日"),dom.find("input[type=hidden]",e).value=moment(t).format("YYYY-MM-DD HH:mm:ss")}});t.show()}),t},MobileForm.prototype.buildSelect=async function(e){let t=dom.templatize(`
    <div class="form-group row">
      <label class="col-form-label col-24-06">{{title}}</label>
      <div class="col-24-18 d-flex">
        <input type="text" class="form-control" readonly placeholder="请选择...">
        <input type="hidden" name="{{name}}">
        <span class="ml-auto material-icons font-20 position-relative" style="top: 3px;">expand_more</span>
      </div>
    </div>
  `,e);if(!0===this.readonly)return t.querySelectorAll("input")[0].setAttribute("placeholder",""),t;let n=e.values;if(!n&&e.url){var i=await xhr.promise({url:e.url,params:{}});n=[];for(let t=0;t<i.length;t++)n.push({text:i[t][e.textField],value:i[t][e.valueField]})}return dom.bind(t,"click",i=>{let t=new Rolldate({title:e.title,format:"oo",values:n,confirm:t=>{var e=dom.ancestor(i.target,"div","col-24-18");console.log(e),dom.find("input[type=text]",e).value=t.text,dom.find("input[type=hidden]",e).value=t.value}});t.show()}),t},MobileForm.prototype.buildMobile=function(t){t=dom.templatize(`
    <div class="form-group row">
      <label class="col-form-label col-24-06">{{title}}</label>
      <div class="col-24-18 d-flex">
        <input type="text" name="{{name}}" class="form-control" readonly placeholder="请输入...">
      </div>
    </div>
  `,t);let e=dom.find("input",t);return!0===this.readonly?e.setAttribute("placeholder",""):dom.bind(t,"click",t=>{new Numpad({type:"mobile",success:t=>{e.value=t}}).show(document.body)}),t},MobileForm.prototype.buildId=function(t){t=dom.templatize(`
    <div class="form-group row">
      <label class="col-form-label col-24-06">{{title}}</label>
      <div class="col-24-18 d-flex">
        <input type="text" name="{{name}}" class="form-control" readonly placeholder="请输入...">
      </div>
    </div>
  `,t);let e=dom.find("input",t);return!0===this.readonly?e.setAttribute("placeholder",""):dom.bind(t,"click",t=>{new Numpad({type:"id",success:t=>{e.value=t}}).show(document.body)}),t},MobileForm.prototype.buildDistrict=function(t){t=dom.templatize(`
    <div class="form-group row">
      <label class="col-form-label col-24-06">{{title}}</label>
      <div class="col-24-18 d-flex">
        <input type="text" name="{{name}}" class="form-control" readonly placeholder="请选择...">
      </div>
    </div>
  `,t);let i=dom.find("input",t);return!0===this.readonly?i.setAttribute("placeholder",""):dom.bind(t,"click",t=>{new DistrictPicker({type:"id",success:t=>{let e="";t.province&&(e+=t.province.chineseDistrictName),t.city&&(e+=" "+t.city.chineseDistrictName),t.county&&(e+=" "+t.county.chineseDistrictName),t.town&&(e+=" "+t.town.chineseDistrictName),i.value=e,i.setAttribute("data-value",JSON.stringify(t))}}).show(document.body)}),t},Numpad.prototype.root=function(){let t=dom.templatize(`
    <div class="popup-container">
      <div class="popup-mask"></div>
      <div class="popup-bottom numpad in">
        <div class="popup-title">
          <button class="cancel">取消</button>
          <span class="value"></span>
          <span class="unit">{{unit}}</span>
          <button class="confirm">确认</button>
        </div>
        <div class="d-flex flex-wrap full-width">
          <div class="col-24-08" style="line-height: 48px;">
            <button class="number">1</button>
          </div>
          <div class="col-24-08" style="line-height: 48px;">
            <button class="number">2</button>
          </div>
          <div class="col-24-08" style="line-height: 48px;">
            <button class="number">3</button>
          </div>
          <div class="col-24-08" style="line-height: 48px;">
            <button class="number">4</button>
          </div>
          <div class="col-24-08" style="line-height: 48px;">
            <button class="number">5</button>
          </div>
          <div class="col-24-08" style="line-height: 48px;">
            <button class="number">6</button>
          </div>
          <div class="col-24-08" style="line-height: 48px;">
            <button class="number">7</button>
          </div>
          <div class="col-24-08" style="line-height: 48px;">
            <button class="number">8</button>
          </div>
          <div class="col-24-08" style="line-height: 48px;">
            <button class="number">9</button>
          </div>
          <div class="col-24-08" style="line-height: 48px;">
            <button widget-id="buttonSpecial" class="number">.</button>
          </div>
          <div class="col-24-08" style="line-height: 48px;">
            <button class="number">0</button>
          </div>
          <div class="col-24-08" style="line-height: 48px; font-size: 24px;">
            <button class="number">
              <i class="fas fa-backspace" style="font-size: 20px;"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  `,this);this.bottom=dom.find(".popup-bottom",t);var e=dom.find(".popup-mask",t),i=dom.find(".confirm",t),n=dom.find(".cancel",t);let s=dom.find(".value",t),o=dom.find("[widget-id=buttonSpecial]",t);"id"==this.type?(o.innerText="X",this.regex=/^.{0,18}$/):"mobile"==this.type&&(o.remove(),this.regex=/^.{0,11}$/);var a=t.querySelectorAll(".number");for(let t=0;t<a.length;t++){var l=a[t];dom.bind(l,"click",t=>{let e=s.innerText;t=t.currentTarget.innerText;if(""==t){if(""===e)return;e=e.substr(0,e.length-1)}else this.regex.test(e+t)&&(e+=t);s.innerText=e})}return dom.bind(e,"click",t=>{t.stopPropagation(),t.preventDefault(),this.close()}),dom.bind(n,"click",t=>{this.close()}),dom.bind(i,"click",t=>{this.success(s.innerText),this.close()}),t},Numpad.prototype.show=function(t){t.appendChild(this.root())},Numpad.prototype.close=function(){this.bottom.classList.remove("in"),this.bottom.classList.add("out"),setTimeout(()=>{this.bottom.parentElement.remove()},300)},DistrictPicker.prototype.root=function(){var t=dom.templatize(`
    <div class="popup-container">
      <div class="popup-mask"></div>
      <div class="popup-bottom district-picker">
        <div class="popup-title">
          <button class="cancel">取消</button>
          <span class="value"></span>
          <span class="unit">{{unit}}</span>
          <button class="confirm">确认</button>
        </div>
        <div class="bottom-dialog-body">
          <div style="padding: 4px 16px">
            <div class="d-flex" style="line-height: 40px;">
              <strong widget-id="widgetProvince" class="font-16">选择省份</strong>
              <span class="ml-auto material-icons font-18 position-relative" style="top: 12px;">navigate_next</span>
            </div>
            <div class="d-flex" style="line-height: 40px;">
              <strong widget-id="widgetCity" class="font-16">选择城市</strong>
              <span class="ml-auto material-icons font-18 position-relative" style="top: 12px;">navigate_next</span>
            </div>
            <div class="d-flex" style="line-height: 40px;">
              <strong widget-id="widgetCounty" class="font-16">选择区县</strong>
              <span class="ml-auto material-icons font-18 position-relative" style="top: 12px;">navigate_next</span>
            </div>
            <div class="d-flex" style="line-height: 40px;">
              <strong widget-id="widgetTown" class="font-16">选择街道/乡镇</strong>
              <span class="ml-auto material-icons font-18 position-relative" style="top: 12px;">navigate_next</span>
            </div>
          </div>
          <div style="border-top: 1px solid var(--color-divider);"></div>
          <ul widget-id="widgetDistrict" class="list-group" style="height: 240px; overflow-y: auto;">
          </ul>
        </div>
      </div>
    </div>
  `,this);this.bottom=dom.find(".popup-bottom",t),this.district=dom.find("[widget-id=widgetDistrict]",t),this.province=dom.find("[widget-id=widgetProvince]",t),this.city=dom.find("[widget-id=widgetCity]",t),this.county=dom.find("[widget-id=widgetCounty]",t),this.town=dom.find("[widget-id=widgetTown]",t);var e=dom.find(".popup-mask",t),i=dom.find(".confirm",t),n=dom.find(".cancel",t);dom.find(".value",t);dom.bind(e,"click",t=>{this.close()}),dom.bind(n,"click",t=>{this.close()}),this.selections.province&&(this.province.setAttribute("data-model-chinese-district-code",this.selections.province.chineseDistrictCode),this.province.innerText=this.selections.province.chineseDistrictName),this.selections.city&&(this.city.setAttribute("data-model-chinese-district-code",this.selections.city.chineseDistrictCode),this.city.innerText=this.selections.city.chineseDistrictName),this.selections.county&&(this.county.setAttribute("data-model-chinese-district-code",this.selections.county.chineseDistrictCode),this.county.innerText=this.selections.county.chineseDistrictName),this.selections.town&&(this.town.setAttribute("data-model-chinese-district-code",this.selections.town.chineseDistrictCode),this.town.innerText=this.selections.town.chineseDistrictName),dom.bind(i,"click",t=>{let e={};var i=this.province.getAttribute("data-model-chinese-district-code"),n=this.city.getAttribute("data-model-chinese-district-code"),s=this.county.getAttribute("data-model-chinese-district-code"),o=this.town.getAttribute("data-model-chinese-district-code");""!=i&&(e.province={chineseDistrictCode:i,chineseDistrictName:this.province.innerText}),""!=n&&(e.city={chineseDistrictCode:n,chineseDistrictName:this.city.innerText}),""!=s&&(e.county={chineseDistrictCode:s,chineseDistrictName:this.county.innerText}),""!=o&&(e.town={chineseDistrictCode:o,chineseDistrictName:this.town.innerText}),this.success(e),this.close()});let s=t=>{t=dom.ancestor(t.target,"div");let e=dom.find("strong",t),i=e.getAttribute("data-model-chinese-district-code");9==i.length?this.renderDistrict(i.substr(0,6)):this.renderDistrict(i.substr(0,i.length-2))};return dom.bind(this.province.parentElement,"click",t=>{s(t)}),dom.bind(this.city.parentElement,"click",t=>{s(t)}),dom.bind(this.county.parentElement,"click",t=>{s(t)}),dom.bind(this.town.parentElement,"click",t=>{s(t)}),setTimeout(()=>{this.bottom.classList.add("in")},50),t},DistrictPicker.prototype.renderDistrict=async function(t){let e=null,i=null;if(t)if(2==t.length)e=`
      and length(chndistcd) = 4 and substring(chndistcd, 1, 2) = '${t}'
    `,i=this.city,this.county.setAttribute("data-model-chinese-district-code",""),this.county.innerText="选择区县",this.town.setAttribute("data-model-chinese-district-code",""),this.town.innerText="选择街道/乡镇";else if(4==t.length)e=`
      and length(chndistcd) = 6 and substring(chndistcd, 1, 4) = '${t}'
    `,i=this.county,this.town.setAttribute("data-model-chinese-district-code",""),this.town.innerText="选择街道/乡镇";else{if(6!=t.length)return;e=`
      and length(chndistcd) = 9 and substring(chndistcd, 1, 6) = '${t}'
    `,i=this.town}else e=`
      and length(chndistcd) = 2
    `,i=this.province,this.city.setAttribute("data-model-chinese-district-code",""),this.city.innerText="选择城市",this.county.setAttribute("data-model-chinese-district-code",""),this.county.innerText="选择区县",this.town.setAttribute("data-model-chinese-district-code",""),this.town.innerText="选择街道/乡镇";var n=await xhr.promise({url:"/api/v3/common/script/stdbiz/gb/chinese_district/find",params:{_and_condition:e,_order_by:"convert(chndistnm using gbk) asc"}});this.district.innerHTML="";for(let t=0;t<n.length;t++){var s=n[t],o=dom.templatize(`
      <li class="list-group-item">{{chineseDistrictName}}</li>
    `,s);dom.model(o,s),dom.bind(o,"click",t=>{t=dom.ancestor(t.target,"li"),t=dom.model(t);i.innerText=t.chineseDistrictName,i.setAttribute("data-model-chinese-district-code",t.chineseDistrictCode),this.renderDistrict(t.chineseDistrictCode)}),this.district.appendChild(o)}},DistrictPicker.prototype.show=function(t){t.appendChild(this.root()),this.renderDistrict()},DistrictPicker.prototype.close=function(){this.bottom.classList.remove("in"),this.bottom.classList.add("out"),setTimeout(()=>{this.bottom.parentElement.remove()},300)},Calendar.prototype.root=function(){let o=dom.templatize(`
    <div class="calendar">
      <div class="title"></div>
      <div class="weekdays" style="position: sticky; top: 0;z-index: 10;">
        <div class="weekday">日</div>
        <div class="weekday">一</div>
        <div class="weekday">二</div>
        <div class="weekday">三</div>
        <div class="weekday">四</div>
        <div class="weekday">五</div>
        <div class="weekday">六</div>
      </div>
      <div class="swiper">
        <div class="swiper-wrapper">
          <div class="prev swiper-slide"></div>
          <div class="curr swiper-slide"></div>
          <div class="next swiper-slide"></div>
        </div>
      </div>
    </div>
  `,{});this.widgetSwiper=dom.find(".swiper",o),this.title=dom.find(".title",o);var t=dom.find(".prev",o),e=dom.find(".curr",o),i=dom.find(".next",o);this.renderMonth(t,moment(this.currentMonth).subtract(1,"months").startOf("month")),this.renderMonth(e,this.currentMonth),this.renderMonth(i,moment(this.currentMonth).add(1,"months").startOf("month"));let n=new Swiper(this.widgetSwiper,{speed:400,initialSlide:this.currentIndex,loop:!0});return n.on("slideChange",t=>{0==t.realIndex?1==this.currentIndex?this.currentMonth=moment(this.currentMonth).subtract(1,"months"):2==this.currentIndex&&(this.currentMonth=moment(this.currentMonth).add(1,"months")):1==t.realIndex?0==this.currentIndex?this.currentMonth=moment(this.currentMonth).add(1,"months"):2==this.currentIndex&&(this.currentMonth=moment(this.currentMonth).subtract(1,"months")):2==t.realIndex&&(0==this.currentIndex?this.currentMonth=moment(this.currentMonth).subtract(1,"months"):1==this.currentIndex&&(this.currentMonth=moment(this.currentMonth).add(1,"months"))),this.currentIndex=t.realIndex;var e=moment(this.currentMonth).subtract(1,"months"),i=moment(this.currentMonth).add(1,"months");let n=null,s=null;0==this.currentIndex?(n=o.querySelectorAll(".next"),s=o.querySelectorAll(".curr")):1==this.currentIndex?(n=o.querySelectorAll(".prev"),s=o.querySelectorAll(".next")):2==this.currentIndex&&(n=o.querySelectorAll(".curr"),s=o.querySelectorAll(".prev"));for(let t=0;t<n.length;t++)this.renderMonth(n[t],e);for(let t=0;t<s.length;t++)this.renderMonth(s[t],i)}),o},Calendar.prototype.renderMonth=function(i,n){var s=n.startOf("month").day(),t=n.daysInMonth();i.innerHTML="";let o=null;for(let e=0;e<t+s;e++){e%7==0&&(o=dom.create("div","dates"));let t=dom.element('<div class="date"></div>');var a=e-s+1;e>=s&&(t.innerHTML=a);a=n.format("YYYY-MM-")+(a<10?"0"+a:a);a==this.today.format("YYYY-MM-DD")&&t.classList.add("today"),t.setAttribute("data-calendar-date",a),o.appendChild(t),e%7==6&&(i.appendChild(o),o=null)}null!=o&&i.appendChild(o);var e=7-(t+s)%7;for(let t=0;t<e;t++){var l=dom.element('<div class="date"></div>');i.appendChild(l)}this.title.innerText=this.currentMonth.format("YYYY年MM月")},Calendar.prototype.stylizeDates=function(i,n,e){let s=dom.find(".dates.curr",this.root);if(Array.isArray(n)){for(let e=0;e<n.length;e++)for(let t=0;t<s.children.length;t++)if(moment(n[e]).format("YYYY-MM-DD")==s.children[t].getAttribute("data-calendar-date")){s.children[t].style=i;break}}else{n=moment(n).format("YYYY-MM-DD"),e=moment(e).format("YYYY-MM-DD");for(let t=0;t<s.children.length;t++){var o=s.children[t].getAttribute("data-calendar-date");n<=o&&o<=e&&(s.children[t].style=i)}}},Calendar.prototype.render=function(t,e){this.root=this.root();let i=dom.find(t);i.innerHTML="",i.appendChild(this.root)},CascadePicker.prototype.root=function(){var t=dom.templatize(`
    <div class="popup-container">
      <div class="popup-mask"></div>
      <div class="popup-bottom district-picker">
        <div class="popup-title">
          <button class="cancel">取消</button>
          <span class="value"></span>
          <span class="unit">{{unit}}</span>
          <button class="confirm">确认</button>
        </div>
        <div>
          <div widget-id="widgetLevel" style="padding: 4px 16px">
          </div>
          <div style="border-top: 1px solid var(--color-divider);"></div>
          <ul widget-id="widgetValue" class="list-group" style="height: 240px; overflow-y: auto;">
          </ul>
        </div>
      </div>
    </div>
  `,this);this.bottom=dom.find(".popup-bottom",t),this.widgetLevel=dom.find("[widget-id=widgetLevel]",t),this.widgetValue=dom.find("[widget-id=widgetValue]",t);var e=dom.find(".popup-mask",t),i=dom.find(".confirm",t),n=dom.find(".cancel",t);let s=t=>{var e=dom.ancestor(t.target,"div");let i=dom.find("strong",e);var n=parseInt(i.getAttribute("data-cascade-level"));i.getAttribute("data-cascade-value"),i.getAttribute("data-cascade-name");let s=null,o=dom.find('[data-cascade-level="'+(n-1)+'"]',this.widgetLevel);null!=o&&(t=o.getAttribute("data-cascade-value"),e=o.getAttribute("data-cascade-name"),s={},s[e]=t),this.renderValue(n,s);for(let e=n+1;e<this.levels.length;e++){let t=dom.find('[data-cascade-level="'+e+'"]',this.widgetLevel);t.setAttribute("data-cascade-value",""),t.innerText=this.levels[e].placeholder}};for(let t=0;t<this.levels.length;t++){var o=dom.templatize(`
      <div class="d-flex" style="line-height: 40px;">
        <strong data-cascade-level="${t}" data-cascade-name="{{name}}" class="font-16">{{placeholder}}</strong>
        <span class="ml-auto material-icons font-18 position-relative" style="top: 12px;">navigate_next</span>
      </div>
    `,this.levels[t]);this.widgetLevel.appendChild(o),dom.bind(o,"click",t=>{s(t)})}return dom.bind(e,"click",t=>{this.close()}),dom.bind(n,"click",t=>{this.close()}),dom.bind(i,"click",t=>{var i=dom.find("strong",this.widgetLevel);let n={};for(let e=0;e<i.length;e++){let t=i[e];var s=dom.model(t);n[t.getAttribute("data-cascade-name")]=s}this.success(n),this.close()}),setTimeout(()=>{this.bottom.classList.add("in")},50),t},CascadePicker.prototype.renderValue=async function(n,t,e){let s=dom.find('[data-cascade-level="'+n+'"]',this.widgetLevel);if(null!=s){let i=this.levels[n];if(this.widgetValue.innerHTML="",i.url){t="function"==typeof i.params?i.params(t):i.params;var o=await xhr.promise({url:i.url,params:t});for(let t=0;t<o.length;t++){var a={value:o[t][i.fields.value],text:o[t][i.fields.text]},a=dom.templatize(`
      <li class="list-group-item" data-cascade-value="{{value}}">{{text}}</li>
    `,a);dom.model(a,o[t]),dom.bind(a,"click",t=>{t=dom.ancestor(t.target,"li"),t=dom.model(t);s.innerText=t[i.fields.text],s.setAttribute("data-cascade-value",t[i.fields.value]),dom.model(s,t);let e={};e[i.fields.value]=t[i.fields.value],this.renderValue(n+1,e,t)}),this.widgetValue.appendChild(a)}}}},CascadePicker.prototype.show=function(t){t.appendChild(this.root()),this.renderValue(0)},CascadePicker.prototype.close=function(){this.bottom.classList.remove("in"),this.bottom.classList.add("out"),setTimeout(()=>{this.bottom.parentElement.remove()},300)},ActionSheet.prototype.root=function(){var t=dom.templatize(`
    <div class="popup-container">
      <div class="popup-mask"></div>
      <div class="popup-bottom" style="background: transparent;">
        <div class="action-sheet">
          <div class="title">{{title}}</div>
          <div class="actions"></div>
          <div class="cancel">取消</div>
        </div>
      </div>
    </div>
  `,this);this.bottom=dom.find(".popup-bottom",t);var e=dom.find(".cancel",t),i=dom.find(".popup-mask",t);let n=dom.find(".actions",t);dom.bind(i,"click",t=>{this.close()}),dom.bind(e,"click",t=>{this.close()});for(let e=0;e<this.actions.length;e++){let t=dom.templatize(`
      <div class="action">{{text}}</div>
    `,this.actions[e]);dom.bind(t,"click",t=>{this.close(),this.actions[e].onClick(t)}),e==this.actions.length-1&&t.classList.add("last"),n.appendChild(t)}return this.bottom.classList.add("in"),setTimeout(()=>{this.bottom.style.bottom="0"},300),t},ActionSheet.prototype.show=function(t){t.appendChild(this.root())},ActionSheet.prototype.close=function(){this.bottom.classList.remove("in"),this.bottom.classList.add("out"),setTimeout(()=>{this.bottom.parentElement.remove()},300)},Weekdays.prototype.root=function(){let o=dom.templatize(`
    <div class="swiper weekly">
      <div class="swiper-wrapper">
      </div>
    </div>
  `,{}),a=dom.find(".swiper-wrapper",o);for(let s=0;s<this.days;s++){let t=moment(this.today).add(s,"days"),e=t.day();e=1==e?"一":2==e?"二":3==e?"三":4==e?"四":5==e?"五":6==e?"六":"日";let i=dom.element('<div class="swiper-slide d-flex" style="width: calc(100% / 7)"></div>'),n=dom.templatize(`
      <div class="weekday pb-2" data-date="{{fulldate}}">
        <span class="day">{{day}}</span>
        <span class="date">{{date}}</span>
      </div>
    `,{day:e,date:t.format("DD"),fulldate:t.format("YYYY-MM-DD")});0==s&&n.classList.add("active"),i.appendChild(n),a.appendChild(i),dom.bind(n,"click",t=>{let e=o.querySelectorAll(".weekday");e.forEach(t=>{t.classList.remove("active")}),n.classList.add("active")})}new Swiper(o,{speed:400,slidesPerView:7,loop:!1});return o},Weekdays.prototype.render=function(t){let e=dom.find(t);e.appendChild(this.root())},PopupRuler.prototype.root=function(){var t=dom.templatize(`
    <div class="popup-container">
      <div class="popup-mask"></div>
      <div class="popup-bottom in">
        <div class="popup-title">
          <button class="cancel">取消</button>
          <span class="value"></span>
          <span class="unit">{{unit}}</span>
          <button class="confirm">确认</button>
        </div>
        <div class="popup-content" style="height: 200px; width: 100%;"></div>
      </div>
    </div>
  `,this);this.bottom=dom.find(".popup-bottom",t);var e=dom.find(".popup-mask",t),i=dom.find(".confirm",t),n=dom.find(".cancel",t);let s=dom.find(".value",t);return dom.bind(e,"click",t=>{t.stopPropagation(),t.preventDefault(),this.close()}),dom.bind(n,"click",t=>{this.close()}),dom.bind(i,"click",t=>{this.success(s.innerText),this.close()}),t},PopupRuler.prototype.show=function(t){var e=this.root();t.appendChild(e);t=dom.find(".popup-content",e);let i=dom.find(".value",e);i.innerText=this.value,ruler.initPlugin({el:t,startValue:this.value,maxScale:this.range[1],region:[this.range[0],this.range[1]],background:"#fff",color:"#E0E0E0",markColor:"#73B17B",isConstant:!0,success:t=>{i.innerText=t}})},PopupRuler.prototype.close=function(){this.bottom.classList.remove("in"),this.bottom.classList.add("out"),setTimeout(()=>{this.bottom.parentElement.remove()},300)},Handlebars.registerHelper("ifeq",function(t,e,i){return t==e?i.fn(this):i.inverse(this)}),"undefined"==typeof kuim&&(kuim={}),kuim={routedPages:[],presentPageObj:null,navigateTo:async function(e,i,n){clearTimeout(kuim.delayToLoad),void 0===n&&(n=!1);let s=document.querySelector("main");kuim.presentPageObj&&(kuim.presentPageObj.page.classList.remove("in"),kuim.presentPageObj.page.classList.add("out")),kuim.delayToLoad=setTimeout(async()=>{kuim.presentPageObj&&(kuim.presentPageObj.page.parentElement.style.display="none"),kuim.presentPageObj&&!1!==n&&(kuim.presentPageObj.page.parentElement.remove(),kuim.presentPageObj.destroy&&kuim.presentPageObj.destroy(),delete kuim.presentPageObj);var t=await xhr.asyncGet({url:e+(-1==e.indexOf("?")?"?":"&")+(new Date).getTime()},"GET");kuim.reload(s,e,t,i)},400)},navigateWidget:function(e,i,n){clearTimeout(kuim.delayToLoad),kuim.delayToLoad=setTimeout(()=>{i.children[0]&&(i.children[0].classList.remove("in"),i.children[0].classList.add("out")),setTimeout(async()=>{i.innerHTML="";var t=await xhr.asyncGet({url:e},"GET");kuim.replace(i,e,t,n)},400)},200)},navigateBack:function(t){clearTimeout(kuim.delayToLoad),kuim.delayToLoad=setTimeout(()=>{var t=document.querySelector("main");let e=t.children[t.children.length-2];kuim.presentPageObj.page.classList.remove("in"),kuim.presentPageObj.page.classList.add("out"),setTimeout(()=>{kuim.presentPageObj.page.parentElement.remove(),kuim.presentPageObj.destroy&&kuim.presentPageObj.destroy(),delete kuim.presentPageObj,e.style.display="",kuim.presentPageObj=window[e.getAttribute("kuim-page-id")],kuim.presentPageObj.page.classList.remove("out"),kuim.presentPageObj.page.classList.add("in"),kuim.setTitleAndIcon(e.getAttribute("kuim-page-title"),e.getAttribute("kuim-page-icon"))},400)},200)},reload:function(t,e,i,n){n=n||{};let s=dom.element('<div style="height: 100%; width: 100%;"></div>'),o=document.createRange();i=o.createContextualFragment(i);s.appendChild(i);let a=dom.find("[id^=page]",s);i=a.getAttribute("id");t.appendChild(s),s.setAttribute("kuim-page-id",i),s.setAttribute("kuim-page-url",e),n.title&&(s.setAttribute("kuim-page-title",n.title),s.setAttribute("kuim-page-icon",n.icon||"")),kuim.presentPageObj=window[i],kuim.presentPageObj.page.classList.add("in");e=utils.getParameters(e);kuim.presentPageObj.show(e),kuim.setTitleAndIcon(n.title,n.icon),n.success&&n.success()},replace:function(t,e,i,n){n=n||{};let s=dom.element('<div style="height: 100%; width: 100%;"></div>'),o=document.createRange();i=o.createContextualFragment(i);t.appendChild(i);let a=dom.find("[id^=page]",t);var l=a.getAttribute("id");n.title&&(s.setAttribute("kuim-page-title",n.title),s.setAttribute("kuim-page-icon",n.icon||"")),a.classList.add("in");var r,e=utils.getParameters(e);for(r in window[l].show(e),n)window[l][r]=n[r];n.success&&n.success()},setTitleAndIcon:function(t,e){let i=dom.find(".bottom-navigator"),n=dom.find("header h1.title");n.innerText=t;let s=dom.find("header div.left");e?(s.innerHTML=e,null!=i&&(i.style.display=""),s.onclick=t=>{}):(s.innerHTML='<i class="fas fa-arrow-left button icon"></i>',null!=i&&(i.style.display="none"),s.onclick=t=>{kuim.navigateBack()})},select:async function(i){var e=await xhr.promise({url:i.url,params:i.params||{}});let n=[];for(let t=0;t<e.length;t++){var s=e[t];n.push({id:s[i.fieldId||"id"],value:s[i.fieldName||"value"]})}new MobileSelect({trigger:i.trigger,title:i.title,wheels:[{data:n}],callback:(t,e)=>{i.onSelected&&i.onSelected(e[0])}})},tabs:function(t){let e=dom.find(t.container),s=dom.element(`
    <div class="nav nav-tabs mt-0"></div>
  `),o=dom.element(`
    <div class="swiper">
      <div class="swiper-wrapper">
      </div>
    </div>
  `);var a=t.tabs;for(let n=0;n<a.length;n++){let t=a[n],e=dom.templatize(`
      <div class="nav-item font-weight-bold mr-0" 
           style="padding: 0 16px; line-height: 36px; text-align: center; flex: 1;">{{title}}</div>
    `,t);s.appendChild(e),0==n&&e.classList.add("active-bg-info"),dom.bind(e,"click",t=>{l.slideTo(n,400,!0)});let i=dom.templatize(`
      <div class="swiper-slide full-width"></div>
    `,t);t.render?t.render(i,t.params||{}):i.innerHTML='<img src="https://via.placeholder.com/240x150">',o.children[0].appendChild(i)}e.appendChild(s),e.appendChild(o);let l=new Swiper(o,{direction:"horizontal",loop:!1});l.on("slideChange",function(t){t=t.activeIndex;for(let t=0;t<s.children.length;t++)s.children[t].classList.remove("active-bg-info");s.children[t].classList.add("active-bg-info")})},wizard:function(t){let e=dom.find(t.container),s=dom.element(`
    <div class="wizard"></div>
  `),o=dom.element(`
    <div class="swiper">
      <div class="swiper-wrapper">
      </div>
    </div>
  `);var a=t.steps;for(let n=0;n<a.length;n++){let t=a[n];t.index=n+1;let e=dom.templatize(`
      <div class="wizard-step">
        <div class="wizard-dot">
          <div class="wizard-connector-left"></div>
          <div class="wizard-number">{{index}}</div>
          <div class="wizard-connector-right"></div>
        </div>
      </div>
    `,t);s.appendChild(e),dom.bind(e,"click",t=>{e.classList.contains("wizard-step-completed")&&l.slideTo(n,400,!0)});let i=dom.templatize(`
      <div class="swiper-slide full-width"></div>
    `,t);t.render?t.render(i,t.params||{}):i.innerHTML='<img src="https://via.placeholder.com/240x150">',o.children[0].appendChild(i)}e.appendChild(s),e.appendChild(o);let l=new Swiper(o,{direction:"horizontal",loop:!1});return l.on("slideChange",t=>{var e=t.activeIndex;for(let t=0;t<s.children.length;t++)s.children[t].classList.remove("wizard-step-completed");for(let t=0;t<e;t++)s.children[t].classList.add("wizard-step-completed")}),l.on("sliderMove",(t,e)=>{}),l},overlay:function(){},success:function(t,e){let i=dom.templatize(`
    <div class="toast">
      <i class="far fa-check-circle font-36"></i>
      <div class="font-18 mt-2">${t}</div>
    </div>
  `);document.body.appendChild(i),setTimeout(()=>{i.classList.add("show")},50),setTimeout(()=>{i.classList.remove("show"),setTimeout(()=>{i.remove(),e&&e()},500)},1e3)},error:function(t,e){let i=dom.templatize(`
    <div class="toast">
      <i class="far fa-times-circle font-36"></i>
      <div class="font-18 mt-2">${t}</div>
    </div>
  `);document.body.appendChild(i),setTimeout(()=>{i.classList.add("show")},50),setTimeout(()=>{i.classList.remove("show"),setTimeout(()=>{i.remove(),e&&e()},500)},1e3)},loading:function(e){if(null==document.getElementById("__widgetLoading")){let t=dom.templatize(`
    <div id="__widgetLoading" style="background: rgba(0,0,0,0.3); position: absolute; top: 0; left: 0; 
                z-index: 9999; height: 100%; width: 100%; display: flex; color: white">
      <div class="m-auto" style="text-align: center;">
        <i class="fas fa-spinner fa-spin font-36"></i>
        <div class="font-18 mt-2">数据加载中</div>
      </div>          
    </div>
  `);document.body.appendChild(t),setTimeout(()=>{e&&e(t)},300)}},dialog:function(t){let e=t.confirm,i=t.cancel;t=t.content;let n=dom.element(`
    <div style="background: rgba(0,0,0,0.3); position: absolute; top: 0; left: 0; 
                z-index: 9999; height: 100%; width: 100%; display: flex;">
      <div class="dialog m-auto" 
           style="width: 88%; min-height: 400px; position: relative;
                  background: var(--color-white);">
        <div class="dialog-body">${t}</div>
        <div class="dialog-footer" 
             style="font-size: 24px; font-weight: bold; position: absolute;
                    width: 100%; height: 56px; bottom: 0; display: table;">
          <button style="background: var(--color-error); width: 50%; display: inline-table;
                         color: var(--color-text-primary-dark); border: none; 
                         line-height: 56px;">取  消</button>
          <button style="background: var(--color-primary); width: 50%; display: inline-table;
                         color: var(--color-text-primary-dark); border: none; 
                         line-height: 56px;">确  定</button>
        </div>
      </div>
    </div>
  `);t=n.querySelectorAll("button");dom.bind(t[0],"click",t=>{n.remove(),i&&i()}),dom.bind(t[1],"click",t=>{n.remove(),e&&e()}),document.body.appendChild(n)}},pStart={x:0,y:0},pStop={x:0,y:0},kuim.swipeStart=function(t){var e;void 0!==t.targetTouches?(e=t.targetTouches[0],pStart.x=e.screenX,pStart.y=e.screenY):(pStart.x=t.screenX,pStart.y=t.screenY)},kuim.swipeEnd=function(t){var e;void 0!==t.changedTouches?(e=t.changedTouches[0],pStop.x=e.screenX,pStop.y=e.screenY):(pStop.x=t.screenX,pStop.y=t.screenY)},kuim.swipeCheck=function(){var t=pStart.y-pStop.y,e=pStart.x-pStop.x;return kuim.isPullDown(t,e)},kuim.isPullDown=function(t,e){return t<0&&(Math.abs(e)<=100&&300<=Math.abs(t)||Math.abs(e)/Math.abs(t)<=.3&&60<=t)},document.addEventListener("touchstart",kuim.swipeStart,!1),document.addEventListener("touchend",t=>{kuim.swipeEnd(t),kuim.swipeCheck()&&(kuim.presentPageObj.page.getBoundingClientRect(),kuim.presentPageObj&&kuim.presentPageObj.pullToRefresh&&0<=kuim.presentPageObj.page.getBoundingClientRect().top&&kuim.loading(t=>{kuim.presentPageObj.pullToRefresh(t)}))},!1),flutter={log:t=>{window.print&&print.postMessage(t)}};