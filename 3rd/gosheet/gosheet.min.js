/*! For license information please see gosheet.min.js.LICENSE.txt */
(()=>{var t={48:(t,e,r)=>{var n=r(475).default;function o(){"use strict";t.exports=o=function(){return r},t.exports.__esModule=!0,t.exports.default=t.exports;var e,r={},i=Object.prototype,a=i.hasOwnProperty,s=Object.defineProperty||function(t,e,r){t[e]=r.value},l="function"==typeof Symbol?Symbol:{},c=l.iterator||"@@iterator",u=l.asyncIterator||"@@asyncIterator",h=l.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(e){f=function(t,e,r){return t[e]=r}}function d(t,e,r,n){var o=e&&e.prototype instanceof m?e:m,i=Object.create(o.prototype),a=new H(n||[]);return s(i,"_invoke",{value:j(t,r,a)}),i}function v(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}r.wrap=d;var y="suspendedStart",g="suspendedYield",w="executing",p="completed",_={};function m(){}function b(){}function R(){}var k={};f(k,c,(function(){return this}));var C=Object.getPrototypeOf,x=C&&C(C(I([])));x&&x!==i&&a.call(x,c)&&(k=x);var A=R.prototype=m.prototype=Object.create(k);function S(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function r(o,i,s,l){var c=v(t[o],t,i);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==n(h)&&a.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,s,l)}),(function(t){r("throw",t,s,l)})):e.resolve(h).then((function(t){u.value=t,s(u)}),(function(t){return r("throw",t,s,l)}))}l(c.arg)}var o;s(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}})}function j(t,r,n){var o=y;return function(i,a){if(o===w)throw new Error("Generator is already running");if(o===p){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var l=E(s,n);if(l){if(l===_)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===y)throw o=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=w;var c=v(t,r,n);if("normal"===c.type){if(o=n.done?p:g,c.arg===_)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=p,n.method="throw",n.arg=c.arg)}}}function E(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var i=v(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,_;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,_):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function H(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function I(t){if(t||""===t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(a.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(n(t)+" is not iterable")}return b.prototype=R,s(A,"constructor",{value:R,configurable:!0}),s(R,"constructor",{value:b,configurable:!0}),b.displayName=f(R,h,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,R):(t.__proto__=R,f(t,h,"GeneratorFunction")),t.prototype=Object.create(A),t},r.awrap=function(t){return{__await:t}},S(O.prototype),f(O.prototype,u,(function(){return this})),r.AsyncIterator=O,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new O(d(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(A),f(A,h,"Generator"),f(A,c,(function(){return this})),f(A,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=I,H.prototype={constructor:H,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var l=a.call(i,"catchLoc"),c=a.call(i,"finallyLoc");if(l&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,_):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),_},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),_}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:I(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),_}},r}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports},475:t=>{function e(r){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},312:(t,e,r)=>{var n=r(48)();t.exports=n;try{regeneratorRuntime=n}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};(()=>{"use strict";function t(t){if(Array.isArray(t))return t}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function o(t,r){if(t){if("string"==typeof t)return e(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,r):void 0}}function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(e,r){return t(e)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,s=[],l=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(t){c=!0,o=t}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(e,r)||o(e,r)||i()}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function c(t){var e=function(t,e){if("object"!==l(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===l(e)?e:String(e)}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,c(n.key),n)}}function h(t,e,r){return e&&u(t.prototype,e),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function f(t,e,r){return(e=c(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.r(n),r.d(n,{default:()=>ie});var d="gosheet",v=2;function y(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function g(e){return t(e)||y(e)||o(e)||i()}function w(){for(var t=document.createDocumentFragment(),e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.forEach((function(e){var r;r=e instanceof p?e._:"string"==typeof e?document.createTextNode(e):e,t.appendChild(r)})),t}var p=function(){function t(e,r){if(s(this,t),f(this,"_data",new Map),this._=e instanceof Node?e:document.createElement(e),r)if("string"==typeof r)for(var n=r.split(" "),o=0;o<n.length;o++)this._.classList.add(n[o]);else if(Array.isArray(r))this._.className=r.join(" ");else for(var i=0,l=Object.entries(r);i<l.length;i++){var c=a(l[i],2),u=c[0];c[1]&&this._.classList.add(u)}}return h(t,[{key:"element",value:function(){return this._}},{key:"data",value:function(t,e){return e?(this._data.set(t,e),this):this._data.get(t)}},{key:"on",value:function(t,e){var r=g(t.split(".")),n=r[0],o=r.slice(1);return this._.addEventListener(n,(function(t){e(t);for(var r=0;r<o.length;r+=1)"stop"===o[r]&&t.stopPropagation(),"prevent"===o[r]&&t.preventDefault()})),this}},{key:"focus",value:function(){return this._.focus(),this}},{key:"value",value:function(t){return void 0!==t?(this._.value=t,this):this._.value}},{key:"textContent",value:function(t){return this._.textContent=t,this}},{key:"html",value:function(t){return this._.innerHTML=t,this}},{key:"attr",value:function(t,e){return e?(this._.setAttribute(t,e),this):this._.getAttribute(t)}},{key:"css",value:function(t,e){var r=this._.style;return e?(r.setProperty(t,e),this):"string"==typeof t?r.getPropertyValue(t):(Object.keys(t).forEach((function(e){var n=t[e];"number"==typeof n&&(n="".concat(n,"px")),r.setProperty(e,n)})),this)}},{key:"rect",value:function(){return this._.getBoundingClientRect()}},{key:"offset",value:function(){var t=this._;return{x:t.offsetLeft,y:t.offsetTop,width:t.offsetWidth,height:t.offsetHeight}}},{key:"computedStyle",value:function(){return window.getComputedStyle(this._)}},{key:"show",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.css("display",t?"block":"none"),this}},{key:"hide",value:function(){return this.css("display","none"),this}},{key:"scrollx",value:function(t){var e=this._;return void 0!==t?(e.scrollLeft=t,this):e.scrollLeft}},{key:"scrolly",value:function(t){var e=this._;return void 0!==t?(e.scrollTop=t,this):e.scrollTop}},{key:"after",value:function(){return this._.after(w.apply(void 0,arguments)),this}},{key:"before",value:function(){return this._.before(w.apply(void 0,arguments)),this}},{key:"append",value:function(){return this._.append(w.apply(void 0,arguments)),this}},{key:"remove",value:function(){for(var e=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];n.forEach((function(r){e._.removeChild(r instanceof t?r._:r)}))}},{key:"cloneNode",value:function(){return this._.cloneNode(!0)}},{key:"firstChild",get:function(){var e=this._.firstChild;return e?new t(e):null}}]),t}();function _(t,e){return new p(t,e)}function m(t){return function(t){if(Array.isArray(t))return e(t)}(t)||y(t)||o(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function R(){return _("div","".concat(d,"-overlayer-area"))}var k=function(){function t(e){s(this,t),f(this,"_areaRects",[]),this._areas=[R(),R(),R(),R()],this._headerAreas=[R(),R(),R(),R()],e.append.apply(e,m(this._areas).concat(m(this._headerAreas)))}return h(t,[{key:"area",value:function(t,e){if(e){this._areaRects[t]=e;var r=e.x,n=e.y,o=e.height,i=e.width;return this._areas[t].css({left:r,top:n,width:i,height:o}),this}return this._areas[t]}},{key:"headerArea",value:function(t,e){if(e){var r=e.x,n=e.y,o=e.height,i=e.width;this._headerAreas[t].css({left:r,top:n,width:i,height:o})}return this._headerAreas[t]}},{key:"inAreas",value:function(t){var e,r=t.x,n=t.y,o=t.height,i=r+t.width,a=n+o,s=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return b(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}(this._areaRects);try{for(s.s();!(e=s.n()).done;){var l=e.value;if(r>=0&&i<=l.width&&n>=0&&a<=l.height)return!0}}catch(t){s.e(t)}finally{s.f()}return!1}}]),t}(),C="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function x(t){return C.charAt(t%C.length)}function A(t){for(var e=[];t>=0;)e.push(x(t)),t=parseInt(t/C.length+"",10)-1;return e.reverse().join("")}function S(t){for(var e=0,r=0;r<t.length;r++)e=26*e+t.charCodeAt(r)-64;return e-1}function O(t){for(var e="",r="",n=0;n<t.length;n+=1)t.charAt(n)>="0"&&t.charAt(n)<="9"?r+=t.charAt(n):e+=t.charAt(n).toUpperCase();return[S(e),parseInt(r,10)-1]}function j(t,e){return"".concat(A(t)).concat(e+1)}function E(t,e,r){var n=a(O(t),2);return j(n[0]+e,n[1]+r)}var P=function(){function t(e,r,n,o){s(this,t),this.startRow=e,this.startCol=r,this.endRow=n,this.endCol=o}return h(t,[{key:"start",get:function(){return[this.startRow,this.startCol]}},{key:"end",get:function(){return[this.endRow,this.endCol]}},{key:"rows",get:function(){return this.endRow-this.startRow}},{key:"cols",get:function(){return this.endCol-this.startCol}},{key:"multiple",get:function(){return this.cols>0||this.rows>0}},{key:"containsRow",value:function(t){return this.startRow<=t&&t<=this.endRow}},{key:"containsCol",value:function(t){return this.startCol<=t&&t<=this.endCol}},{key:"contains",value:function(t,e){return this.containsRow(t)&&this.containsCol(e)}},{key:"within",value:function(t){return this.startRow>=t.startRow&&this.startCol>=t.startCol&&this.endRow<=t.endRow&&this.endCol<=t.endCol}},{key:"position",value:function(t){if(this.startRow<=t.startRow&&this.endRow>=t.endRow){if(t.startCol>this.endCol)return"right";if(t.endCol<this.startCol)return"left"}else if(this.startCol<=t.startCol&&this.endCol>=t.endCol){if(t.startRow>this.endRow)return"down";if(t.endRow<this.startRow)return"up"}return"none"}},{key:"intersectsRow",value:function(t,e){return this.startRow<=e&&t<=this.endRow}},{key:"intersectsCol",value:function(t,e){return this.startCol<=e&&t<=this.endCol}},{key:"intersects",value:function(t){var e=t.startRow,r=t.startCol,n=t.endRow,o=t.endCol;return this.intersectsCol(r,o)&&this.intersectsRow(e,n)}},{key:"intersection",value:function(e){return new t(e.startRow<this.startRow?this.startRow:e.startRow,e.startCol<this.startCol?this.startCol:e.startCol,e.endRow>this.endRow?this.endRow:e.endRow,e.endCol>this.endCol?this.endCol:e.endCol)}},{key:"union",value:function(e){return new t(e.startRow<this.startRow?e.startRow:this.startRow,e.startCol<this.startCol?e.startCol:this.startCol,e.endRow>this.endRow?e.endRow:this.endRow,e.endCol>this.endCol?e.endCol:this.endCol)}},{key:"difference",value:function(e){if(!this.intersects(e))return[];var r=this.startRow,n=this.startCol,o=this.endRow,i=this.endCol,a=this.intersection(e);return[new t(r,n,a.startRow-1,i),new t(a.endRow+1,n,o,i),new t(a.startRow,n,a.endRow,a.startCol-1),new t(a.startRow,a.endCol+1,a.endRow,i)].filter((function(t){return t.rows>=0&&t.cols>=0}))}},{key:"touches",value:function(t){return t.startRow===this.startRow&&t.endRow===this.endRow&&(t.endCol+1===this.startCol||this.endCol+1===t.startCol)||t.startCol===this.startCol&&t.endCol===this.endCol&&(t.endRow+1===this.startRow||this.endRow+1===this.startCol)}},{key:"eachRow",value:function(t,e){var r=this.endRow;e&&r>e&&(r=e);for(var n=this.startRow;n<=r;n+=1)t(n);return this}},{key:"eachCol",value:function(t,e){var r=this.endCol;e&&r>e&&(r=e);for(var n=this.startCol;n<=r;n+=1)t(n);return this}},{key:"each",value:function(t){var e=this;return this.eachRow((function(r){e.eachCol((function(e){return t(r,e)}))})),this}},{key:"clone",value:function(){return new t(this.startRow,this.startCol,this.endRow,this.endCol)}},{key:"toString",value:function(){var t=j(this.startCol,this.startRow);return this.multiple&&(t+=":".concat(j(this.endCol,this.endRow))),t}},{key:"equals",value:function(t){return this.startRow===t.startRow&&this.startCol===t.startCol&&this.endRow===t.endRow&&this.endCol===t.endCol}}],[{key:"create",value:function(e,r,n,o){if(void 0!==n&&void 0!==o){var i=e,a=r,s=n,l=o;return e>n&&(i=n,s=e),r>o&&(a=o,l=r),new t(i,a,s,l)}return new t(e,r,e,r)}},{key:"with",value:function(t){var e=t.split(":"),r=a(O(e[0]),2),n=r[0],o=r[1];if(1===e.length)return this.create(o,n);var i=a(O(e[1]),2),s=i[0],l=i[1];return this.create(o,n,l,s)}}]),t}(),T=function(){function t(e,r){s(this,t),this.target=e;var n=e.getContext("2d");if(!n)throw new Error("getContext(2d) is null");this._ctx=n,this._scale=r,this._target=e}return h(t,[{key:"size",value:function(t,e){var r=this._target,n=this._scale;r.style.width="".concat(t,"px"),r.style.height="".concat(e,"px");var o=window.devicePixelRatio;return r.width=Math.floor(t*o),r.height=Math.floor(e*o),this._ctx.scale(o*n,o*n),this}},{key:"prop",value:function(t,e){var r=this;return e?(this._ctx[t]=e,this):"string"==typeof t?this._ctx[t]:(Object.entries(t).forEach((function(t){var e=a(t,2),n=e[0],o=e[1];null!=o&&(r._ctx[n]=o)})),this)}},{key:"measureTextWidth",value:function(t){return this.measureText(t).width}},{key:"line",value:function(t,e,r,n){return this.moveTo(t,e).lineTo(r,n).stroke(),this}},{key:"clearRect",value:function(t,e,r,n){return this._ctx.clearRect(t,e,r,n),this}},{key:"fillRect",value:function(t,e,r,n){return this._ctx.fillRect(t,e,r,n),this}},{key:"strokeRect",value:function(t,e,r,n){return this._ctx.strokeRect(t,e,r,n),this}},{key:"fillText",value:function(t,e,r,n){return this._ctx.fillText(t,e,r,n),this}},{key:"strokeText",value:function(t,e,r,n){return this._ctx.strokeText(t,e,r,n),this}},{key:"measureText",value:function(t){return this._ctx.measureText(t)}},{key:"getLineDash",value:function(){return this._ctx.getLineDash()}},{key:"setLineDash",value:function(t){return this._ctx.setLineDash(t),this}},{key:"createLinearGradient",value:function(t,e,r,n){return this._ctx.createLinearGradient(t,e,r,n)}},{key:"createRadialGradient",value:function(t,e,r,n,o,i){return this._ctx.createRadialGradient(t,e,r,n,o,i)}},{key:"createPattern",value:function(t,e){return this._ctx.createPattern(t,e)}},{key:"beginPath",value:function(){return this._ctx.beginPath(),this}},{key:"closePath",value:function(){return this._ctx.closePath(),this}},{key:"moveTo",value:function(t,e){return this._ctx.moveTo(t,e),this}},{key:"lineTo",value:function(t,e){return this._ctx.lineTo(t,e),this}},{key:"bezierCurveTo",value:function(t,e,r,n,o,i){return this._ctx.bezierCurveTo(t,e,r,n,o,i),this}},{key:"quadraticCurveTo",value:function(t,e,r,n){return this._ctx.quadraticCurveTo(t,e,r,n),this}},{key:"arc",value:function(t,e,r,n,o,i){return this._ctx.arc(t,e,r,n,o,i),this}},{key:"arcTo",value:function(t,e,r,n,o){return this._ctx.arcTo(t,e,r,n,o),this}},{key:"ellipse",value:function(t,e,r,n,o,i,a,s){return this._ctx.ellipse(t,e,r,n,o,i,a,s),this}},{key:"rect",value:function(t,e,r,n){return this._ctx.rect(t,e,r,n),this}},{key:"roundRect",value:function(t,e,r,n,o){return this.beginPath().moveTo(t+o,e).arcTo(t+r,e,t+r,e+n,o).arcTo(t+r,e+n,t,e+n,o).arcTo(t,e+n,t,e,o).arcTo(t,e,t+r,e,o).closePath(),this}},{key:"fill",value:function(t){return this._ctx.fill(t),this}},{key:"stroke",value:function(){return this._ctx.stroke(),this}},{key:"clip",value:function(t){return this._ctx.clip(t),this}},{key:"isPointInPath",value:function(t,e,r){return this._ctx.isPointInPath(t,e,r)}},{key:"isPointInStroke",value:function(t,e){return this._ctx.isPointInStroke(t,e)}},{key:"getTransform",value:function(){return this._ctx.getTransform()}},{key:"rotate",value:function(t){return this._ctx.rotate(t),this}},{key:"scale",value:function(t,e){return this._ctx.scale(t,e),this}},{key:"translate",value:function(t,e){return this._ctx.translate(t,e),this}},{key:"setTransform",value:function(t,e,r,n,o,i){return this._ctx.setTransform(t,e,r,n,o,i),this}},{key:"drawImage",value:function(t,e,r){return this._ctx.drawImage(t,e,r),this}},{key:"createImageData",value:function(t,e){return this._ctx.createImageData(t,e)}},{key:"getImageData",value:function(t,e,r,n){return this._ctx.getImageData(t,e,r,n)}},{key:"putImageData",value:function(t,e,r){return this._ctx.putImageData(t,e,r),this}},{key:"save",value:function(){return this._ctx.save(),this}},{key:"restore",value:function(){return this._ctx.restore(),this}}]),t}();function H(t,e,r,n){if(t&&e){var o="";return r&&(o+="italic "),n&&(o+="bold "),"".concat(o," ").concat(e,"pt ").concat(t)}}function I(t,e,r){var n,o,i,a,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Array.isArray(r)?n=o=i=a=r:(n=r.top,o=r.right,i=r.bottom,a=r.left),t.save().beginPath().translate(e.x,e.y),[n,o,i,a].forEach((function(r,n){if(r){var o,i=[],a=1;"thick"===r[0]?a=3:"medium"===r[0]?a=2:"dotted"===r[0]?i=[1,1]:"dashed"===r[0]&&(i=[2,2]);var l=0;s&&(l=a/2),(o=t.prop({strokeStyle:r[1],lineWidth:a}).setLineDash(i)).line.apply(o,m(function(t,r){return[[0-r,0,e.width+r,0],[e.width,0,e.width,e.height],[0-r,e.height,e.width+r,e.height],[0,0,0,e.height]][t]}(n,l)))}})),t.restore()}function L(t,e,r,n,o,i){var s="";e&&(s="string"==typeof e||"number"==typeof e?i("".concat(e)):i((e.value||"")+"",e.format));var l=n.fontSize,c=n.fontFamily,u=n.bold,h=n.italic,f=n.color,d=n.bgcolor,v=n.align,y=n.valign,g=n.underline,w=n.strikethrough,p=n.rotate,_=n.textwrap,b=n.padding;if(t.save().beginPath().translate(r.x,r.y),t.rect(0,0,r.width,r.height).clip(),d&&t.prop("fillStyle",d).fill(),p&&p>0&&t.rotate(p*(Math.PI/180)),void 0!==o){if(t.save(),!o(t,r,e,s))return void t.restore();t.restore()}if(s&&!/^\s*$/.test(s)){t.save().beginPath().prop({textAlign:v,textBaseline:y,font:H(c,l,h,u),fillStyle:f});var R=a(b||[5,5],2),k=R[0],C=R[1],x=function(t,e,r){switch(t){case"left":return r;case"center":return e/2;case"right":return e-r;default:return 0}}(v,r.width,k),A=s.split("\n"),S=r.width-2*k,O=[];A.forEach((function(e){var r=t.measureTextWidth(e);if(_&&r>S){for(var n={w:0,len:0,start:0},o=0;o<e.length;o+=1)n.w>S&&(O.push(e.substr(n.start,n.len)),n={w:0,len:0,start:o}),n.len+=1,n.w+=t.measureTextWidth(e[o])+1;n.len>0&&O.push(e.substr(n.start,n.len))}else O.push(e)}));var j=l/.75,E=(O.length-1)*j,P=[];g&&P.push("underline"),w&&P.push("strikethrough");var T=function(t,e,r,n,o){switch(t){case"top":return o;case"middle":var i=e/2-r/2,a=n/2+o;return i<a?a:i;case"bottom":return e-o-r;default:return 0}}(y,r.height,E,j,C);O.forEach((function(e){var r=t.measureTextWidth(e);t.fillText(e,x,T),P.forEach((function(e){t.line.apply(t,m(function(t,e,r,n,o,i,a){var s=0;"underline"===t?"top"===r?s=-a:"middle"===r&&(s=-a/2):"strikethrough"===t&&("top"===r?s=-a/2:"bottom"===r&&(s=a/2));var l=0;return"center"===e?l=i/2:"right"===e&&(l=i),[n-l,o-s,n-l+i,o-s]}(e,v,y,x,T,r,l)))})),T+=j})),t.restore()}t.restore()}function z(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function M(t,e,r){var n=g(e),o=n[0],i=n[1],a=n.slice(2),s=[],l=P.with(o),c=r.filter((function(t){return t.intersects(l)}));if(l.intersects(t.range)||c.length>0)if(c.length<=0)s.push([l,t.rect(l),i]);else{var u,h=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return z(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?z(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}(c);try{var f=function(){var e=u.value;if(!l.within(e)){if("outside"===i||"left"===i||"top"===i||"right"===i||"bottom"===i)return s.push([l,t.rect(l),i]),0;var r=c.filter((function(t){return!t.equals(e)}));if(l.difference(e).forEach((function(n){if(n.intersects(t.range)){var o=t.rect(n);s.push.apply(s,m(M(t,[n.toString(),i].concat(m(a)),r))),"inside"!==i&&"horizontal"!==i||(n.startRow<e.startRow&&n.endRow<e.startRow?s.push([n,o,"bottom"]):n.startRow>e.startRow&&n.endRow>e.startRow&&s.push([n,o,"top"])),"inside"!==i&&"vertical"!==i||(n.startCol<e.startCol&&n.endCol<e.startCol&&s.push([n,o,"right"]),n.startCol>e.startCol&&n.endCol>e.startCol&&s.push([n,o,"left"]))}})),"all"===i){var n=t.rect(e);l.startRow===e.startRow&&s.push([e,n,"top"]),l.endRow===e.endRow&&s.push([e,n,"bottom"]),l.startCol===e.startCol&&s.push([e,n,"left"]),l.endCol===e.endCol&&s.push([e,n,"right"])}return 0}l.startRow===e.startRow&&l.startCol===e.startCol&&"inside"!==i&&"horizontal"!==i&&"vertical"!==i&&s.push([e,t.rect(e),"all"===i?"outside":i])};for(h.s();!(u=h.n()).done&&0!==f(););}catch(t){h.e(t)}finally{h.f()}}return s}function W(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function B(t,e,r){var n=e.width,o=e.color;n>0&&(t.save().beginPath().prop({lineWidth:n-.5,strokeStyle:o}),r(),t.restore())}function D(t,e,r){var n=r.x,o=r.y,i=r.width,a=r.height;B(t,e,(function(){t.translate(n,o).line(i,0,i,a).line(0,a,i,a)}))}function F(t,e,r,n){if(r){var o,i,s,l,c,u,h=function(t){return t},d=n._headerStyle,v=n._headerGridline,y=n._styles,g=n._rowHeader,w=n._colHeader;if("row-header"===t){if(g.width<=0)return;o=g.cell,s=g.merges,i=g.cellRenderer}else if("col-header"===t){if(w.height<=0)return;o=w.cell,s=w.merges,i=w.cellRenderer}else o=n._cell,i=n._cellRenderer,h=n._formatter,d=n._style,v=n._gridline,y=n._styles,s=n._merges,l=n._borders,c=n._row,u=n._col;e.save().translate(r.x,r.y).prop("fillStyle",n._bgcolor).rect(0,0,r.width,r.height).fill().clip();var p,_,b=function(t,e,r){var n=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?W(Object(r),!0).forEach((function(e){f(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):W(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},d);if(c){var o=c(t);o&&void 0!==o.style&&Object.assign(n,y[o.style])}if(u){var i=u(e);i&&void 0!==i.style&&Object.assign(n,y[i.style])}return r instanceof Object&&void 0!==r.style&&Object.assign(n,y[r.style]),n},R=[],k=[],C=new Set;s&&(_=function(t){if(t.intersects(r.range)){var e=o(t.startRow,t.startCol),n=b(t.startRow,t.startCol,e),i=r.rect(t);k.push([e,i,n]),R.push(t),t.each((function(t,e){C.add("".concat(t,"_").concat(e))}))}},(p=s)&&p.length>0&&p.forEach((function(t){_(P.with(t))})));var x=function(r,n,o){"body"===t?(console.log(t),D(e,v,n),L(e,r,n,o,i,h)):(L(e,r,n,o,i,h),D(e,v,n))};r.each((function(t,e,r){if(!C.has("".concat(t,"_").concat(e))){var n=o(t,e);x(n,r,b(t,e,n))}})),k.forEach((function(t){return x.apply(void 0,m(t))})),function(t,e,r,n){r&&r.length>0&&r.forEach((function(r){var o=a(r,4),i=o[2],s=o[3];M(e,r,n).forEach((function(r){var n=a(r,3),o=n[0],l=n[1],c=n[2];!function(t,e,r,n,o,i,a,s){var l=[i,a];"outside"===o||"all"===o?I(t,n,l,!0):"left"===o?I(t,n,{left:l},s):"top"===o?I(t,n,{top:l},s):"right"===o?I(t,n,{right:l},s):"bottom"===o&&I(t,n,{bottom:l},s),"all"!==o&&"inside"!==o&&"horizontal"!==o&&"vertical"!==o||("horizontal"!==o&&r.eachCol((function(n){if(n<r.endCol){var o=r.clone();o.endCol=o.startCol=n,o.intersects(e.range)&&I(t,e.rect(o),{right:l},s)}})),"vertical"!==o&&r.eachRow((function(n){if(n<r.endRow){var o=r.clone();o.endRow=o.startRow=n,o.intersects(e.range)&&I(t,e.rect(o),{bottom:l},s)}})))}(t,e,o,l,c,i,s)}))}))}(e,r,l,R),e.restore()}}var G=function(){function t(e,r,n,o,i,a,l){var c=this;s(this,t),f(this,"rowMap",new Map),f(this,"colMap",new Map),f(this,"cellAtCache",null),this.range=e,this.x=r,this.y=n,this.width=o,this.height=i,this.rowHeight=a,this.colWidth=l;var u=0;e.eachRow((function(t){var e=a(t);c.rowMap.set(t,{y:u,height:e}),u+=e})),this.height<=0&&(this.height=u);var h=0;e.eachCol((function(t){var e=l(t);c.colMap.set(t,{x:h,width:e}),h+=e})),this.width<=0&&(this.width=h)}return h(t,[{key:"containsX",value:function(t){return t>=this.x&&t<this.x+this.width}},{key:"containsY",value:function(t){return t>=this.y&&t<this.y+this.height}},{key:"contains",value:function(t,e){return this.containsX(t)&&this.containsY(e)}},{key:"eachRow",value:function(t){var e=this;this.range.eachRow((function(r){var n=e.rowMap.get(r)||{y:0,height:0},o=n.y,i=n.height;i>0&&t(r,o,i)}))}},{key:"eachCol",value:function(t){var e=this;this.range.eachCol((function(r){var n=e.colMap.get(r)||{x:0,width:0},o=n.x,i=n.width;i>0&&t(r,o,i)}))}},{key:"each",value:function(t){var e=this;this.eachRow((function(r,n,o){e.eachCol((function(e,i,a){t(r,e,{x:i,y:n,width:a,height:o})}))}))}},{key:"rectRow",value:function(t,e){var r,n=this.rowMap,o=this.range,i=0,a=0;t>=o.startRow&&(i=(null===(r=n.get(t))||void 0===r?void 0:r.y)||0);for(var s=t;s<=e;s+=1){var l=this.rowHeight(s);l>0&&(s<o.startRow&&(i-=l),a+=l)}return{x:0,y:i,width:this.width,height:a}}},{key:"rectCol",value:function(t,e){var r,n=this.colMap,o=this.range,i=0,a=0;t>=o.startCol&&(i=(null===(r=n.get(t))||void 0===r?void 0:r.x)||0);for(var s=t;s<=e;s+=1){var l=this.colWidth(s);l>0&&(s<o.startCol&&(i-=l),a+=l)}return{x:i,y:0,width:a,height:this.height}}},{key:"rect",value:function(t){var e=this.rectRow(t.startRow,t.endRow),r=e.y,n=e.height,o=this.rectCol(t.startCol,t.endCol);return{x:o.x,y:r,width:o.width,height:n}}},{key:"cellAt",value:function(t,e){var r=this.cellAtCache;if(null!=r&&t>r.x&&t<=r.x+r.width&&e>r.y&&e<=r.y+r.height)return r;for(var n=this.range,o={row:n.startRow,col:n.startCol,x:this.x,y:this.y,width:0,height:0};o.y<e;){var i=this.rowHeight(o.row++);o.y+=i,o.height=i}for(o.y-=o.height,o.row--;o.x<t;){var a=this.colWidth(o.col++);o.x+=a,o.width=a}return o.x-=o.width,o.col--,this.cellAtCache=o,o}}],[{key:"create",value:function(e,r,n,o,i,a,s,l,c,u){return new t(new P(e,r,n,o),i,a,s,l,c,u)}}]),t}();function V(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function N(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?V(Object(r),!0).forEach((function(e){f(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function K(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return q(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?q(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function q(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var $=function(){function t(e){s(this,t),this._render=e;for(var r=[e._rowHeader.width,e._colHeader.height],n=r[0],o=r[1],i=a(e._freeze,2),l=i[0],c=i[1],u=e._startRow,h=e._startCol,f=e._rows,d=e._cols,v=e._width,y=e._height,g=function(t){return e.rowHeightAt(t)},w=function(t){return e.colWidthAt(t)},p=G.create(u,h,l-1,c-1,n,o,0,0,g,w),_=l+e._scrollRows,m=c+e._scrollCols,b=p.height+o,R=_;b<y&&R<f;)b+=g(R),R+=1;for(var k=p.width+n,C=m;k<v&&C<d;)k+=w(C),C+=1;var x=n+p.width,A=o+p.height,S=v-x,O=y-A;C===d&&(S-=v-k),R===f&&(O-=y-b),C-=1,R-=1;var j=G.create(_,m,R,C,x,A,S,O,g,w),E=G.create(u,m,l-1,C,x,o,S,0,g,w),P=G.create(_,h,R,c-1,n,A,0,O,g,w);this.areas=[E,p,P,j];var T=e._rowHeader,H=e._colHeader,I=function(){return H.height/H.rows},L=function(){return T.width/T.cols};this.headerAreas=[G.create(0,E.range.startCol,H.rows-1,E.range.endCol,j.x,0,j.width,0,I,w),G.create(0,p.range.startCol,H.rows-1,p.range.endCol,p.x,0,p.width,0,I,w),G.create(p.range.startRow,0,p.range.endRow,T.cols-1,0,p.y,0,p.height,g,L),G.create(P.range.startRow,0,P.range.endRow,T.cols-1,0,j.y,0,j.height,g,L)]}return h(t,[{key:"inAreas",value:function(t,e){var r,n=K(this.areas);try{for(n.s();!(r=n.n()).done;)if(r.value.range.contains(t,e))return!0}catch(t){n.e(t)}finally{n.f()}return!1}},{key:"cellAt",value:function(t,e){var r=this.areas[1],n=a(this.headerAreas,4),o=n[0],i=n[1],s=n[2],l=n[3];if(t<r.x&&e<r.y)return{placement:"all",row:0,col:0,x:0,y:0,width:r.x,height:r.y};if(t<r.x)return N({placement:"row-header"},(s.containsY(e)?s:l).cellAt(t,e));if(e<r.y)return N({placement:"col-header"},(i.containsX(t)?i:o).cellAt(t,e));var c,u=K(this.areas);try{for(u.s();!(c=u.n()).done;){var h=c.value;if(h.contains(t,e))return N({placement:"body"},h.cellAt(t,e))}}catch(t){u.e(t)}finally{u.f()}return null}}]),t}(),Y=function(){function t(e,r,n){s(this,t),f(this,"_bgcolor","#ffffff"),f(this,"_width",0),f(this,"_height",0),f(this,"_scale",1),f(this,"_rows",100),f(this,"_cols",26),f(this,"_rowHeight",22),f(this,"_colWidth",100),f(this,"_startRow",0),f(this,"_startCol",0),f(this,"_scrollRows",0),f(this,"_scrollCols",0),f(this,"_row",(function(){})),f(this,"_col",(function(){})),f(this,"_cell",(function(){})),f(this,"_cellRenderer",(function(){return!0})),f(this,"_formatter",(function(t){return t})),f(this,"_merges",[]),f(this,"_borders",[]),f(this,"_styles",[]),f(this,"_gridline",{width:1,color:"#e6e6e6"}),f(this,"_style",{align:"left",valign:"middle",textwrap:!1,underline:!1,strikethrough:!1,color:"#0a0a0a",bold:!1,italic:!1,rotate:0,fontSize:10,fontFamily:"Source Sans Pro"}),f(this,"_rowHeader",{width:60,cols:1,cell:function(t,e){return t+1}}),f(this,"_colHeader",{height:24,rows:1,cell:function(t,e){return A(e)}}),f(this,"_headerGridline",{width:1,color:"#e6e6e6"}),f(this,"_headerStyle",{bgcolor:"#f4f5f8cc",align:"center",valign:"middle",textwrap:!0,underline:!1,strikethrough:!1,color:"#585757",bold:!1,italic:!1,rotate:0,fontSize:10,fontFamily:"Source Sans Pro"}),f(this,"_freeze",[0,0]),f(this,"_freezeGridline",{width:2,color:"#d8d8d8"}),f(this,"_viewport",null);var o="string"==typeof e?document.querySelector(e):e;if(!o)throw new Error("target error");this._target=o,this._width=r,this._height=n}return h(t,[{key:"render",value:function(){return this._viewport=new $(this),function(t){var e=t._width,r=t._height,n=t._target,o=t._scale,i=t._viewport,s=t._freeze,l=t._rowHeader,c=t._colHeader;if(i){var u=new T(n,o);u.size(e,r);var h=a(i.areas,4),f=h[0],d=h[1],v=h[2],y=h[3],g=a(i.headerAreas,4),w=g[0],p=g[1],_=g[2],m=g[3];F("body",u,y,t),F("body",u,f,t),F("col-header",u,w,t),F("body",u,v,t),F("row-header",u,m,t),F("body",u,d,t),F("col-header",u,p,t),F("row-header",u,_,t);var b=a(s,2),R=b[0],k=b[1];(k>0||R>0)&&B(u,t._freezeGridline,(function(){k>0&&u.line(0,y.y,e,y.y),R>0&&u.line(y.x,0,y.x,r)}));var C=d.x,x=d.y;if(C>0&&x>0){var A=c.height,S=l.width,O=t._headerStyle.bgcolor;O&&u.save().prop({fillStyle:O}).rect(0,0,S,A).fill().restore(),B(u,t._headerGridline,(function(){u.line(0,A,S,A).line(S,0,S,A)}))}}}(this),this}},{key:"bgcolor",value:function(t){return this._bgcolor=t,this}},{key:"width",value:function(t){return this._width=t,this}},{key:"height",value:function(t){return this._height=t,this}},{key:"scale",value:function(t){return this._scale=t,this}},{key:"rows",value:function(t){return this._rows=t,this}},{key:"cols",value:function(t){return this._cols=t,this}},{key:"rowHeight",value:function(t){return this._rowHeight=t,this}},{key:"colWidth",value:function(t){return this._colWidth=t,this}},{key:"startRow",value:function(t){return this._startRow=t,this}},{key:"startCol",value:function(t){return this._startCol=t,this}},{key:"scrollRows",value:function(t){return this._scrollRows=t,this}},{key:"scrollCols",value:function(t){return this._scrollCols=t,this}},{key:"row",value:function(t){return this._row=t,this}},{key:"col",value:function(t){return this._col=t,this}},{key:"cell",value:function(t){return this._cell=t,this}},{key:"cellRenderer",value:function(t){return this._cellRenderer=t,this}},{key:"formatter",value:function(t){return this._formatter=t,this}},{key:"merges",value:function(t){return this._merges=t,this}},{key:"styles",value:function(t){return this._styles=t,this}},{key:"borders",value:function(t){return this._borders=t,this}},{key:"gridline",value:function(t){return t&&Object.assign(this._gridline,t),this}},{key:"style",value:function(t){return t&&Object.assign(this._style,t),this}},{key:"rowHeader",value:function(t){return t&&Object.assign(this._rowHeader,t),this}},{key:"colHeader",value:function(t){return t&&Object.assign(this._colHeader,t),this}},{key:"headerGridline",value:function(t){return t&&Object.assign(this._headerGridline,t),this}},{key:"headerStyle",value:function(t){return t&&Object.assign(this._headerStyle,t),this}},{key:"freeze",value:function(t){return t&&(this._freeze=O(t).reverse()),this}},{key:"freezeGridline",value:function(t){return t&&Object.assign(this._freezeGridline,t),this}},{key:"rowHeightAt",value:function(t){var e=this._row;if(e){var r=e(t);if(r)return!0===r.hide?0:r.height}return this._rowHeight}},{key:"colWidthAt",value:function(t){var e=this._col;if(e){var r=e(t);if(r)return!0===r.hide?0:r.width}return this._colWidth}},{key:"viewport",get:function(){return this._viewport}}],[{key:"create",value:function(e,r,n){return new t(e,r,n)}}]),t}();try{window&&(window.gosheet=window.gosheet||{},window.gosheet.table_renderer=Y.create)}catch(t){}var U=function(){function t(){s(this,t),f(this,"_",[]),f(this,"_indexes",new Map),f(this,"_formulas",[]),f(this,"_formulaParser",(function(t){return t})),f(this,"_formatter",(function(t){return t}))}return h(t,[{key:"formulaParser",value:function(t){return this._formulaParser=t,this}},{key:"formatter",value:function(t){return this._formatter=t,this}},{key:"load",value:function(t){var e=t.cells;e&&(this._=e,this.resetIndexes())}},{key:"get",value:function(t,e){var r=this._indexes;if(r.has(t)){var n=r.get(t).get(e);return void 0!==n?this._[n]:null}return null}},{key:"remove",value:function(t,e){var r=this._indexes;if(r.has(t)){var n=r.get(t),o=n.get(e);void 0!==o&&(this._.splice(o,1),n.delete(e))}return this}},{key:"set",value:function(t,e,r){var n=this.get(t,e);if(null===n){if(null!=r){var o=this._.push([t,e,r])-1;this.updateIndex(t,e,o),this.addFormula(r,o)}}else{var i=n[2],a=Q(i),s=Q(r);""===s?(i instanceof Object&&Object.keys(i).length>1?delete i.value:this.remove(t,e),this.resetFormulas()):(i instanceof Object?Object.assign(i,r instanceof Object?r:{value:r}):n[2]=r,s!==a&&this.resetFormulas())}}},{key:"resetIndexes",value:function(){for(var t=this._,e=0;e<t.length;e+=1){var r=a(t[e],3),n=r[0],o=r[1],i=r[2];this.updateIndex(n,o,e),this.addFormula(i,e)}}},{key:"updateIndex",value:function(t,e,r){var n=this._indexes;n.has(t)||n.set(t,new Map),n.get(t).set(e,r)}},{key:"addFormula",value:function(t,e){t instanceof Object&&t.formula&&(t.value=this._formulaParser(t.formula),this._formulas.push(e))}},{key:"resetFormulas",value:function(){var t=this;this._formulas.forEach((function(e){var r=a(t._[e],3)[2];r instanceof Object&&r.formula&&(r.value=t._formulaParser(r.formula))}))}}]),t}();function X(t){return t instanceof Object?t.value:t}function Q(t){var e=X(t);return"".concat(null!=e?e:"")}function Z(t,e,r,n,o){var i=t.scroll,a="row"===n?0:1,s="row"===n?3:2,l=i[s],c=!1,u=i[a],h=0,f=t.freeze;if(f&&(h=O(f)["row"===n?1:0]),r>0)if("+"===e)for(var d=u;!(l>=r);d+=1)l+=o(h+d),t.scroll[a]=d+1,c=!0;else for(var v=u;!(l<=r);v-=1){var y=o(h+v-1);if(l-=y,t.scroll[a]=v-1,c=!0,y>0)break}else t.scroll[a]=0,l=0,c=!0;return i[s]=l,c}function J(t,e){var r=t.merges;if(r)for(var n=P.with(e),o=0;o<r.length;o+=1)if(P.with(r[o]).equals(n))return!0;return!1}function tt(t,e){var r=P.with(e);if(r.multiple){t.merges||(t.merges=[]);var n=t.merges;n.length<=0||n.forEach((function(t,e){P.with(t).within(r)&&n.splice(e,1)})),n.push(e)}}function et(t,e){var r=t.merges;if(r)for(var n=0;n<r.length;n+=1)if(r[n]===e)return void r.splice(n,1)}function rt(t,e){var r=t.merges;if(r)for(var n=0;n<r.length;n+=1){var o=P.with(r[n]);o.intersects(e)&&(e=o.union(e))}return e}function nt(t,e,r){for(var n=0,o=t;o<e;o+=1)n+=r(o);return n}function ot(t,e){var r=Object.keys(t);if(r.length!==Object.keys(e).length)return!1;for(var n=0;n<r.length;n+=1){var o=r[n],i=t[o],a=e[o];if(void 0===a)return!1;if("string"==typeof i||"number"==typeof i||"boolean"==typeof i){if(i!==a)return!1}else if(Array.isArray(i)){if(i.length!==a.length)return!1;for(var s=0;s<i.length;s+=1)if(!ot(i[s],a[s]))return!1}else if("function"!=typeof i&&!Array.isArray(i)&&i instanceof Object&&!ot(i,a))return!1}return!0}function at(t,e){if(t.styles||(t.styles=[]),e)for(var r=0;r<t.styles.length;r+=1)if(ot(t.styles[r],e))return r;return t.styles.push(e)-1}function st(t,e,r){var n=t.cols[e]||{width:t.colWidth};return r?t.cols[e]=Object.assign(n,r):n}function lt(t,e,r){if(!r){var n=st(t,e);return n.hide?0:n.width}var o=t.cols;o[e]?o[e].width=r:o[e]={width:r}}function ct(t,e,r){var n=t.cols;if(1===arguments.length){var o=n.len*t.colWidth;for(var i in n)if("len"!==i){var a=lt(t,parseInt(i,10));a>0&&(o+=a,o-=t.colWidth)}return o}return nt(void 0!==e?e:0,void 0!==r?r:n.len,(function(e){return lt(t,e)}))}function ut(t,e,r){for(;;){if(!st(t,e).hide)return e;e+=r}}function ht(t,e,r){var n=t.rows[e]||{height:t.rowHeight};return r?t.rows[e]=Object.assign(n,r):n}function ft(t,e,r){if(!r){var n=ht(t,e);return n.hide?0:n.height}var o=t.rows;o[e]?o[e].height=r:o[e]={height:r}}function dt(t,e,r){var n=t.rows;if(1===arguments.length){var o=n.len*t.rowHeight;for(var i in n)if("len"!==i){var a=ft(t,parseInt(i,10));a>0&&(o+=a,o-=t.rowHeight)}return o}return nt(void 0!==e?e:0,void 0!==r?r:n.len,(function(e){return ft(t,e)}))}function vt(t,e,r){for(;;){if(!ht(t,e).hide)return e;e+=r}}function yt(t,e){return"string"==typeof t?t.replace(/([0-9]+$)|(([0-9]+)[^0-9]+$)/g,(function(t){return t.replace(/[0-9]+/,(function(t){return"".concat(parseInt(t)+e)}))})):t+e}function gt(t,e,r){t.addEventListener(e,r)}function wt(t,e,r){t.removeEventListener(e,r)}var pt=function(){function t(){s(this,t),f(this,"_events",new Map)}return h(t,[{key:"on",value:function(t,e){var r=this._events;return r.has(t)||r.set(t,[]),r.get(t).push(e),this}},{key:"off",value:function(t,e){var r=this._events;if(r.has(t)){var n=r.get(t);if(e){var o=n.findIndex(it,it===e);-1!==o&&n.splice(o,1)}else n.length=0}return this}},{key:"emit",value:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var o=this._events;return o.has(t)&&o.get(t).forEach((function(t){return t.apply(void 0,r)})),this}}]),t}(),_t=function(){function t(e,r,n,o){var i=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};s(this,t),f(this,"_cell",null),this._type=e,this._minValue=n,this._lineLength=o,this._change=a,this._=_("div","".concat(d,"-resizer ").concat(e)).append(this._hover=_("div","hover").on("mousedown.stop",(function(t){return function(t,e){var r=t._type,n=t._cell,o=t._minValue,i=t._,a=t._line,s=t._change,l=0;a.show();var c=function(t){null!==e&&1===t.buttons&&n&&("row"===r?(l+=t.movementY)+n.height>=o?i.css("top","".concat(n.y+n.height+l,"px")):l=o-n.height:(l+=t.movementX)+n.width>=o?i.css("left","".concat(n.x+n.width+l,"px")):l=o-n.width)};gt(window,"mousemove",c),gt(window,"mouseup",(function t(){wt(window,"mousemove",c),wt(window,"mouseup",t),a.hide(),i.hide(),n&&0!=l&&s(l,n)}))}(i,t)})),this._line=_("div","line")),r.append(this._)}return h(t,[{key:"show",value:function(t){this._cell=t;var e=this._type,r=t.x,n=t.y,o=t.width,i=t.height;this._.css("left","".concat("row"===e?r:r+o-5,"px")).css("top","".concat("row"===e?n+i-5:n,"px")).show();var a="row"===e?"width":"height";this._hover.css(a,"".concat(t[a],"px")),this._line.css(a,"".concat(this._lineLength(),"px"))}},{key:"hide",value:function(){this._.hide()}}]),t}();function mt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var bt=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];s(this,t),f(this,"_rect",null),f(this,"_target",null),this._=_("div","".concat(d,"-").concat(e)),r&&this.show()}return h(t,[{key:"append",value:function(t){return this._.append(t),this}},{key:"offset",value:function(){if(this._rect&&this._target){var t=this._target.offset(),e=this._rect,r=e.x,n=e.y,o=e.width,i=e.height;return{x:r+t.x,y:n+t.y,width:o,height:i}}return null}},{key:"rect",value:function(t){return this._rect=t,this._.css({left:t.x,top:t.y,width:t.width,height:t.height}),this}},{key:"target",value:function(t){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&t.append(this._),this._target=t,this}},{key:"show",value:function(){return this._.show(),this}},{key:"clear",value:function(){var t=this._target,e=this._;t&&(t.remove(e),this._target=null)}}]),t}(),Rt=function(){function t(e){s(this,t),f(this,"_placement","body"),f(this,"_editable",!1),f(this,"_ranges",[]),f(this,"_rowHeaderRanges",[]),f(this,"_colHeaderRanges",[]),f(this,"_areas",[]),f(this,"_focus",[0,0]),f(this,"_focusRange",null),f(this,"_focusArea",null),f(this,"_move",[0,0]),f(this,"_copyRange",null),f(this,"_copyAreas",[]),f(this,"_autofillRange",null),f(this,"_autofillAreas",[]),f(this,"_autofillTrigger",(function(t){})),this._editable=e}return h(t,[{key:"currentRange",get:function(){return this._ranges.at(-1)}},{key:"placement",value:function(t){return this._placement=t,this}},{key:"focus",value:function(t,e,r){return this._focus=[t,e],this._focusRange=r,this._move=[t,e],this}},{key:"move",value:function(t,e){return this._move=[t,e],this}},{key:"autofillRange",value:function(t){return this._autofillRange=t,this}},{key:"autofillTrigger",value:function(t){return this._autofillTrigger=t,this}},{key:"addRange",value:function(t){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(this._ranges.length=0,this.clear()),this._ranges.push(t),Ct(this),this}},{key:"updateLastRange",value:function(t){var e=this._focusRange;e&&(this._ranges.splice(-1,1,t(e)),Ct(this))}},{key:"addAreaOutline",value:function(t,e){var r=new bt("selector",!0).rect(xt(t,v)).target(e);"body"===this._placement&&r.append(_("div","corner").attr("draggable","false").on("mousedown",this._autofillTrigger)),this._areas.push(r)}},{key:"addArea",value:function(t,e){return this._areas.push(new bt("selector-area",!0).rect(t).target(e)),this}},{key:"addRowHeaderArea",value:function(t,e){return this._areas.push(new bt("selector-area row-header",!0).rect(t).target(e)),this}},{key:"addColHeaderArea",value:function(t,e){return this._areas.push(new bt("selector-area col-header",!0).rect(t).target(e)),this}},{key:"addCopyArea",value:function(t,e){return this._copyAreas.push(new bt("selector-copy",!0).rect(xt(t,v)).target(e)),this}},{key:"addAutofillArea",value:function(t,e){return this._autofillAreas.push(new bt("selector-autofill",!0).rect(xt(t,v)).target(e)),this}},{key:"setFocusArea",value:function(t,e){return this._focusArea=new bt("",!0).rect(t).target(e,!1),this}},{key:"showCopy",value:function(){this._copyRange=this.currentRange}},{key:"clearCopy",value:function(){this._copyRange=null,this._copyAreas.forEach((function(t){t.clear()})),this._copyAreas.length=0}},{key:"clear",value:function(){[this._areas,this._autofillAreas,this._copyAreas].forEach((function(t){t.forEach((function(t){return t.clear()})),t.length=0}))}}]),t}();function kt(t,e,r){t.sort(e);var n=t[0],o=[];1===t.length&&o.push(n);for(var i=1;i<t.length;i+=1){var a=t[i];r(n,a)?n=n.union(a):(o.push(n),n=a)}return t.length>1&&o.push(n),o}function Ct(t){var e,r=[],n=[],o=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return mt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?mt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}(t._ranges);try{for(o.s();!(e=o.n()).done;){var i=e.value;if(i){var a=i.startRow,s=i.startCol,l=i.endRow,c=i.endCol;(a>=0||l>=0)&&r.push(P.create(a,0,l,0)),(s>=0||c>=0)&&n.push(P.create(0,s,0,c))}}}catch(t){o.e(t)}finally{o.f()}t._rowHeaderRanges=kt(r,(function(t,e){return t.startRow-e.startRow}),(function(t,e){return t.intersectsRow(e.startRow,e.endRow)})),t._colHeaderRanges=kt(n,(function(t,e){return t.startCol-e.startCol}),(function(t,e){return t.intersectsCol(e.startCol,e.endCol)}))}function xt(t,e){return{x:t.x-e/2,y:t.y-e/2,width:t.width-e,height:t.height-e}}var At={vertical:"height",horizontal:"width"},St=function(){function t(e,r){var n=this;s(this,t),f(this,"_value",0),f(this,"_maxValue",0),f(this,"_lastOffset",0),f(this,"_change",null),this._type=e,this._content=_("div","content"),this._=_("div","".concat(d,"-scrollbar ").concat(e)).append(this._content).on("scroll.stop",(function(t){var r=t.target,o=r.scrollTop,i=r.scrollLeft;if(n._change){var a="vertical"===e?o:i,s=a>n._value?"+":"-";n._change(s,a,t),n._value=a}})),r.append(this._)}return h(t,[{key:"value",get:function(){return this._value}},{key:"change",value:function(t){return this._change=t,this}},{key:"scrollBy",value:function(t){return t&&this.scroll(this._value+t),this}},{key:"scrollToStart",value:function(){return this.scroll(0),this}},{key:"scrollToEnd",value:function(){return this.scroll(this._maxValue),this}},{key:"scroll",value:function(t){var e=this._,r=this._type,n=this._maxValue;return void 0!==t?(t<0?t=0:t>n&&(t=n),"vertical"===r?e.scrolly(t):e.scrollx(t),this):"vertical"===r?e.scrolly():e.scrollx()}},{key:"resize",value:function(t,e){if(e>t-1){var r=At[this._type];this._content.css(r,"".concat(e,"px")),this._.css(r,"".concat(t,"px")).show(),this._maxValue=e-t}else this._.hide();return this}}]),t}();const Ot=function(t){var e=t._editor,r=t._selector;if(e&&r){var n=r._focusArea;if(e.visible&&n){var o=n._rect,i=n._target;o&&i?e.rect(o).target(i).show():e.rect({x:-100,y:-100,width:0,height:0}).show()}}},jt=function(t){var e=t._selector;if(e){var r=e._focusRange,n=e._focusArea;if(r&&n){var o=n._rect,i=n._target,a=r.startRow,s=r.startCol,l=t.cell(a,s),c=function(t,e){var r="text";e instanceof Object&&e.type&&(r=e.type);var n=t._editors.get(r);return"select"===r&&e instanceof Object&&e.options&&n.options(e.options),n.changer((function(e){null!==e&&zt.setCellValue(t,e)})),n.moveChanger((function(e){var r=t._selector;"none"!==e&&r&&(zt.move(t,!0,e,1),t._canvas.focus())})),n}(t,l);t._editor=c,c&&o&&i&&(c.cellIndex(a,s).rect(o).target(i).show(),l&&c.value(l))}}},Et={init:function(t){t._vScrollbar=new St("vertical",t._container).change((function(e,r){(function(t,e,r){return e&&void 0!==r?Z(t,e,r,"row",(function(e){return ht(t,e).height})):t.scroll[3]})(t._data,e,r)&&(t.render(),zt.reset(t),Ot(t))})),t._hScrollbar=new St("horizontal",t._container).change((function(e,r){(function(t,e,r){return e&&void 0!==r?Z(t,e,r,"col",(function(e){return st(t,e).width})):t.scroll[2]})(t._data,e,r)&&(t.render(),zt.reset(t),Ot(t))}))},resize:function(t){var e=t._contentRect,r=e.x,n=e.y,o=e.height,i=e.width;t._vScrollbar&&t._vScrollbar.resize(t._height(),o+n),t._hScrollbar&&t._hScrollbar.resize(t._width(),i+r)},autoMove:function(t,e,r){if(e){var n=t._selector,o=t._vScrollbar,i=t._hScrollbar,s=t._data,l=t._renderer.viewport;if(l&&n){var c=a(l.areas,4),u=c[1],h=c[3].range,f=u.range;if(o){var d=function(e,r,n){for(var o=t.rowsHeight(r,n+1),i=0,a=e;i<o;a+=1)i+=t.rowHeight(a);return i};r?e.endRow===r.endRow?e.startRow<r.startRow?e.startRow>f.endRow&&e.startRow<h.startRow&&o.scrollBy(-t.rowsHeight(e.startRow,h.startRow)):e.startRow>r.startRow&&e.startRow>=h.endRow&&o.scrollBy(d(h.startRow,h.endRow,e.startRow)):e.startRow===r.startRow&&(e.endRow>r.endRow?e.endRow>=h.endRow&&o.scrollBy(d(h.startRow,h.endRow,e.endRow)):e.endRow<r.endRow&&e.endRow<h.startRow&&o.scrollBy(-t.rowsHeight(e.endRow,h.startRow))):e.endRow===s.rows.len-1?o.scrollToEnd():0===e.startRow?o.scrollToStart():e.endRow>=h.endRow?o.scrollBy(d(h.startRow,h.endRow,e.endRow)):e.startRow>f.endRow&&e.startRow<h.startRow&&o.scrollBy(-t.rowsHeight(e.startRow,h.startRow))}if(i){var v=function(e,r,n){for(var o=t.colsWidth(r,n+1),i=0,a=e;i<o;a+=1)i+=t.colWidth(a);return i};r?e.endCol===r.endCol?e.startCol<r.startCol?e.startCol>f.endCol&&e.startCol<h.startCol&&i.scrollBy(-t.colsWidth(e.startCol,h.startCol)):e.startCol>r.startCol&&e.startCol>=h.endCol&&i.scrollBy(v(h.startCol,h.endCol,e.startCol)):e.startCol===r.startCol&&(e.endCol>r.endCol?e.endCol>=h.endCol&&i.scrollBy(v(h.startCol,h.endCol,e.endCol)):e.endCol<r.endCol&&e.endCol<h.startCol&&i.scrollBy(-t.colsWidth(e.endCol,h.startCol))):e.endCol===s.cols.len-1?i.scrollToEnd():0===e.startCol?i.scrollToStart():e.endCol>=h.endCol?i.scrollBy(v(h.startCol,h.endCol,e.endCol)):e.startCol>f.endCol&&e.startCol<h.startCol&&i.scrollBy(-t.colsWidth(e.startCol,h.startCol))}}}}};function Pt(t,e,r,n){var o=t._selector,i=t._data,a=P.create(e,r),s=rt(i,a);o&&o.focus(e,r,s).addRange("body"===o._placement?s:a,n)}function Tt(t,e,r){var n=t._selector,o=t._data;n&&n.move(e,r).updateLastRange((function(t){return rt(o,t.union(P.create(e,r)))}))}function Ht(t){var e=t._selector,r=t._overlayer,n=t._renderer,o=n._rowHeader,i=n._colHeader,a=n.viewport;if(e&&a){var s=e._placement;e.clear();var l=o.width,c=i.height,u=function(t,e){var r=t.range;return"body"===s?r.intersects(e):"col-header"===s?r.intersectsCol(e.startCol,e.endCol):"row-header"!==s||r.intersectsRow(e.startRow,e.endRow)},h=function(t,e,r){var n=t.rect(e);return"col-header"===s?((n=t.rectCol(e.startCol,e.endCol)).height+=v,2!==r&&3!==r||(n.y-=v)):"row-header"===s&&((n=t.rectRow(e.startRow,e.endRow)).width+=v,0!==r&&3!==r||(n.x-=v)),n};a.areas.forEach((function(t,n){var o=r._areas[n],i=e._ranges,a=e._focusRange,l=e._copyRange,c=e._autofillRange;i.forEach((function(r,l){var c,f,d,v=u(t,r),y=h(t,r,n);if(v)if(l===i.length-1){if(("all"!==s||t.range.intersects(r))&&e.addAreaOutline(y,o),a){t.range.intersects(a)&&e.setFocusArea(t.rect(a),o);var g=(c=r,f=t.range,d=c.clone(),"all"!==s&&"row-header"!==s||(d.endCol=f.endCol,c.startCol<f.startCol&&(d.startCol=f.startCol)),"all"!==s&&"col-header"!==s||(d.endRow=f.endRow,c.startRow<f.startRow&&(d.startRow=f.startRow)),d),w=g.difference(a);w.length>0?w.forEach((function(r){(v=u(t,r))&&e.addArea(t.rect(r),o)})):"body"===s&&r.equals(a)||e.addArea(h(t,g,n),o)}}else e.addArea(y,o)})),l&&t.range.intersects(l)&&e.addCopyArea(t.rect(l),o),c&&t.range.intersects(c)&&e.addAutofillArea(t.rect(c),o)})),a.headerAreas.forEach((function(t,n){var o=r._headerAreas[n],i=t.width,a=t.height;n<=1?"row-header"===s||"all"===s?e.addColHeaderArea({x:0,y:0,width:i,height:c},o):e._colHeaderRanges.forEach((function(r){t.range.intersectsCol(r.startCol,r.endCol)&&e.addColHeaderArea(t.rectCol(r.startCol,r.endCol),o)})):"col-header"===s||"all"===s?e.addRowHeaderArea({x:0,y:0,width:l,height:a},o):e._rowHeaderRanges.forEach((function(r){t.range.intersectsRow(r.startRow,r.endRow)&&e.addRowHeaderArea(t.rectRow(r.startRow,r.endRow),o)}))}))}}function It(t,e,r,n){if(!function(t,e){var r=t._selector,n=t._data;if(r){var o=r._autofillRange;if(o)return"up"===e?o.startRow=vt(n,o.startRow-1,-1):"down"===e?o.endRow=vt(n,o.endRow+1,1):"left"===e?o.startCol=ut(n,o.startCol-1,-1):"right"===e&&(o.endCol=ut(n,o.endCol+1,1)),Et.autoMove(t,o),Ht(t),!0}return!1}(t,r)){var o=t._selector,i=t._data,s=t._renderer.viewport;if(o&&s){var l=o._focusRange;if(l){var c,u=l.startRow,h=l.startCol,f=l.endRow,d=l.endCol,v=i.rows,y=i.cols,g=a(o._move,2),w=g[0],p=g[1];e||(u=f=w,h=d=p);var _=null===(c=o.currentRange)||void 0===c?void 0:c.clone();n?"up"===r?w=vt(i,u-n,-1):"down"===r?w=vt(i,f+n,1):"left"===r?p=ut(i,h-n,-1):"right"===r&&(p=ut(i,d+n,1)):"up"===r?w=0:"down"===r?w=v.len-1:"left"===r?p=0:"right"===r&&(p=y.len-1),w>=0&&w<=v.len-1&&p>=0&&p<=y.len-1&&(e?Pt(t,w,p,!0):(Tt(t,w,p),o._move=[w,p])),o.placement("body"),Et.autoMove(t,o.currentRange,e?void 0:_),Ht(t)}}}}function Lt(t,e,r){var n,o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){},a=t._selector,s=t._renderer;if(a){var l=a._placement,c={row:0,col:0};if("all"!==l){var u=t._canvas.rect(),h=u.left,f=u.top,d=[0,0],v=null,y=function(){null!==v&&(clearInterval(v),v=null)};gt(n=window,"mousemove",o=function(n){var o,i=0,u=0;n.x>0&&(i=n.x-h),n.y>0&&(u=n.y-f),"row-header"===l&&(i=1),"col-header"===l&&(u=1);var g=null===(o=a.currentRange)||void 0===o?void 0:o.clone();if("CANVAS"===n.target.tagName){var w,p=null===(w=s.viewport)||void 0===w?void 0:w.cellAt(i,u);if(p){var _=p.row,m=p.col;_==c.row&&m===c.col||(e(_,m),"body"===l&&Et.autoMove(t,r(a),g),Ht(t),c.row=_,c.col=m)}y()}else if(null===v){var b=n.x-d[0],R=n.y-d[1];b>=0&&R>=0&&(v=setInterval((function(){var e=r(a);if(e){var n=e.endRow,o=e.endCol;b>R?(It(t,!1,"right",1),t.isLastRow(n)&&y()):(It(t,!1,"down",1),t.isLastCol(o)&&y())}}),120))}d=[n.x,n.y]}),gt(n,"mouseup",(function t(e){y(),i(a),wt(n,"mousemove",o),wt(n,"mouseup",t)}))}}}const zt={init:function(t){t._selector=new Rt(!!t._editable).autofillTrigger((function(e){var r=t._selector;r&&Lt(t,(function(t,e){var n=r.currentRange;if(n){var o=n.clone();if(o.contains(t,e))r.autofillRange(null);else{var i=[o.startRow-t,t-o.endRow,o.startCol-e,e-o.endCol],a=i.indexOf(Math.max.apply(null,i));1===a?(o.startRow=o.endRow+1,o.endRow=t):0===a?(o.endRow=o.startRow-1,o.startRow=t):3===a?(o.startCol=o.endCol+1,o.endCol=e):2===a&&(o.endCol=o.startCol-1,o.startCol=e),r.autofillRange(o)}}}),(function(t){return t._autofillRange}),(function(e){t.copy(e._autofillRange,!0).render(),r.autofillRange(null),Ht(t)}))}))},setCellValue:function(t,e){var r=t._selector;r&&(r.clearCopy(),r._ranges.forEach((function(r){r&&r.each((function(r,n){t.cell(r,n,e)}))})),t.render())},addRange:Pt,unionRange:Tt,reset:Ht,move:It,bindMousemove:Lt,showCopy:function(t){t._selector&&(t._selector.showCopy(),Ht(t))},clearCopy:function(t){t._selector&&(t._selector.clearCopy(),Ht(t))}},Mt=function(t){t._rowResizer=new _t("row",t._container,t._minRowHeight,(function(){return t._width()}),(function(e,r){var n=r.row,o=r.height;t.rowHeight(n,o+e).render(),zt.reset(t),t._canvas.focus()})),t._colResizer=new _t("col",t._container,t._minColWidth,(function(){return t._height()}),(function(e,r){var n=r.col,o=r.width;t.colWidth(n,o+e).render(),zt.reset(t),t._canvas.focus()}))};function Wt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Bt(t){t._canvas.on("mousedown",(function(e){return function(t,e){var r=t._selector,n=t._renderer,o=t._editor,i=(t._emitter,n.viewport);if(o&&o.changed(),r&&i){var a=e.offsetX,s=e.offsetY;e.ctrlKey,e.metaKey,e.shiftKey,i.cellAt(a,s)&&i._render.render()}}(t,e)})).on("mousemove",(function(e){return function(t,e){var r=t._rowResizer,n=t._colResizer,o=t._renderer.viewport,i=e.buttons,a=e.offsetX,s=e.offsetY;if(o&&0===i){var l=t._renderer,c=l._rowHeader,u=l._colHeader;if(r&&c.width>0)if(a<c.width&&s>u.height){var h=o.cellAt(a,s);h&&r.show(h)}else r.hide();if(n&&u.height>0)if(s<u.height&&a>c.width){var f=o.cellAt(a,s);f&&n.show(f)}else n.hide()}}(t,e)})).on("keydown",(function(e){return function(t,e){var r=e.ctrlKey,n=e.shiftKey,o=e.metaKey,i=e.altKey,a=e.code,s=null;if("Enter"!==a||r||o||i)if("Tab"!==a||r||o||i)if(a.startsWith("Arrow"))s=a.substring(5).toLowerCase();else if(r||o||i||!(a.startsWith("Key")||a.startsWith("Digit")||["Minus","Equal","Space","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"].includes(a)))if("KeyC"===a&&(r||o)){var l=t._selector;if(t._copyable&&l){var c={},u=l.currentRange;u&&(zt.showCopy(t),["text/plain","text/html"].forEach((function(e){var r=u.toString(),n="text/html"===e?t.toHtml(r):function(t,e){var r=P.with(e),n="";return r.eachRow((function(e){r.eachCol((function(r){var o=t.cellValueString(e,r);o.includes("\n")&&(o='"'.concat(o,'"')),n+="".concat(o,"\t")})),n+="\n"})),n}(t,r);c[e]=new Blob([n],{type:e})})),navigator.clipboard.write([new ClipboardItem(c)]).then((function(){return console.log("clipboard has writed success")}),(function(t){return console.log("clipboard has wirted failure: ",t)})))}}else"KeyV"===a&&(r||o)?t._editable&&navigator.clipboard.read().then((function(e){if(e.length>0){var r=e[0],o=n;o||(o=!Dt(r,"text/html",(function(e){t.fill(e).render()}))),o&&Dt(r,"text/plain",(function(e){t.fill(function(t){var e,r=[],n=0,o=0,i="",a=0,s=function(){r[n]=r[n]||[],r[n][o]=i,i=""},l=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return Wt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Wt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}(t);try{for(l.s();!(e=l.n()).done;){var c=e.value;"\t"!==c?"\n"!==c||1===a?'"'!==c?"\r"!==c&&(i+=c):a+=1:(s(),n+=1,o=0):(s(),o+=1,a=0)}}catch(t){l.e(t)}finally{l.f()}return o>0&&s(),r.length<=0&&r.push([t]),r}(e)).render()}))}})):"Escape"===a&&zt.clearCopy(t);else jt(t),e.preventDefault();else s=n?"left":"right";else s=n?"up":"down";s&&(zt.move(t,!(a.startsWith("Arrow")&&n),s,o||r?void 0:1),e.preventDefault())}(t,e)})).on("wheel.prevent",(function(e){return function(t,e){var r=e.deltaX,n=e.deltaY,o=t._hScrollbar,i=t._vScrollbar;Math.abs(r)>Math.abs(n)?o&&o.scrollBy(r):i&&i.scrollBy(n)}(t,e)})).on("dblclick.prevent",(function(){jt(t)}))}function Dt(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){};return!!t.types.includes(e)&&(t.getType(e).then((function(t){t.text().then((function(t){r(t)}))})),!0)}function Ft(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return Gt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Gt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Gt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Vt(t,e,r){if(t.hasAttribute(e)){var n=t.getAttribute(e);null!=n&&r(n)}}function Nt(t,e,r,n){var o=t.style.getPropertyValue(e),i=null!==o&&""!==o&&o!==r;return i&&n(o),i}function Kt(t,e,r,n){var o=t.style.getPropertyValue(e);o===r&&n(o)}function qt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $t(t){return $t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$t(t)}function Yt(){return Yt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$t(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Yt.apply(this,arguments)}function Ut(t,e){return Ut=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ut(t,e)}function Xt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ut(t,e)}function Qt(t,e){if(e&&("object"===l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return qt(t)}var Zt=function(){function t(e){s(this,t),f(this,"_target",null),f(this,"_rect",null),f(this,"_visible",!1),f(this,"_moveChanger",(function(){})),f(this,"_changer",(function(){})),this._=_("div",e)}return h(t,[{key:"visible",get:function(){return this._visible}},{key:"target",value:function(t){return t.append(this._),this._target=t,this}},{key:"cellIndex",value:function(t,e){return this}},{key:"value",value:function(t){return this._value=t,this}},{key:"changed",value:function(){this._changer(this._value),this.hide()}},{key:"rect",value:function(t){if(t){this._visible=!0,this._rect=t;var e=t.x,r=t.y,n=t.width,o=t.height;this._.css({left:e-v/2,top:r-v/2,width:n-v,height:o-v}).show()}return this}},{key:"show",value:function(){return this._.show(),this}},{key:"hide",value:function(){return this._visible=!1,this.value(""),this._.hide(),this}},{key:"moveChanger",value:function(t){return this._moveChanger=t,this}},{key:"changer",value:function(t){return this._changer=t,this}}]),t}();var Jt=function(t){Xt(o,t);var e,r,n=(e=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=$t(e);if(r){var o=$t(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Qt(this,t)});function o(){var t;return s(this,o),f(qt(t=n.call(this,"".concat(d,"-editor"))),"_text",_("textarea","")),f(qt(t),"_textMeasure",_("div","measure")),f(qt(t),"_editing",!1),t._.append(t._text,t._textMeasure),t._text.on("keydown",(function(e){!function(t,e){var r=e.code,n=e.shiftKey,o=e.metaKey,i=e.altKey,a=e.ctrlKey,s=e.target,l=function(e){t._moveChanger(e),t.hide()};"Enter"===r?(a||o||i?(s.value+="\n",t.value(s.value)):l(n?"up":"down"),e.preventDefault()):"Tab"!==r||a||o||i||(l(n?"left":"right"),e.preventDefault())}(qt(t),e)})).on("input",(function(e){var r=e.target.value;t._editing=!0,t._value=r,t._changer(r),te(qt(t))})),t}return h(o,[{key:"value",value:function(t){return Yt($t(o.prototype),"value",this).call(this,t),this._text.value(Q(t)||""),te(this),this}},{key:"rect",value:function(t){var e=this;return Yt($t(o.prototype),"rect",this).call(this,t),t&&setTimeout((function(){var t=e._value,r=0;null!==t&&(r=Q(t).length);var n=e._text.element();n.focus(),n.setSelectionRange(r,r)}),0),this}},{key:"hide",value:function(){return Yt($t(o.prototype),"hide",this).call(this),this._editing=!1,this}}]),o}(Zt);function te(t){var e=t._,r=t._value,n=t._rect,o=t._textMeasure,i=t._target;if("string"==typeof r){var a=r.replace("\n","<br/>");if(r.endsWith("\n")&&(a+="T"),o.html(a),n&&i){var s=parseInt(o.computedStyle().getPropertyValue("padding")),l=i.offset(),c=l.width-n.x-v,u=l.height-n.y-v;e.css("max-width","".concat(c,"px")),o.css("max-width","".concat(c-2*s,"px"));var h=o.rect(),f=h.width,d=h.height;f>n.width-v&&e.css({width:f}),d>n.height&&d<=u?e.css({height:d}):d<n.height&&e.css({height:n.height-v})}}}function ee(t,e,r,n,o,i,a){try{var s=t[i](a),l=s.value}catch(t){return void r(t)}s.done?e(l):Promise.resolve(l).then(n,o)}var re=r(312),ne=r.n(re);var oe=function(t){Xt(l,t);var e,r,n,o,i=(n=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=$t(n);if(o){var r=$t(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Qt(this,t)});function l(){var t;return s(this,l),f(qt(t=i.call(this,"".concat(d,"-select"))),"_width",300),f(qt(t),"_height",320),f(qt(t),"_position","bottom-right"),f(qt(t),"_options",null),t._searchInput=_("input").on("input",(function(e){var r=e.target;return t.query(r.value)})),t._content=_("ul","".concat(d,"-select-content")),t._.append(_("div","".concat(d,"-select-input")).append(t._searchInput),t._content),t}return h(l,[{key:"query",value:(e=ne().mark((function t(e){var r=this;return ne().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==this._options){t.next=2;break}return t.abrupt("return");case 2:return this._content.html(""),t.next=5,this._options(e).then((function(t){var e;t&&Array.isArray(t)&&(e=r._content).append.apply(e,m(t.map((function(t){var e=_("li","item").on("click",(function(){r._changer(Array.isArray(t)?{key:t[0],value:t[1]}:t),r.hide()}));if("string"==typeof t)e.append(t);else if(Array.isArray(t)){var n=a(t,3),o=(n[0],n[1]),i=n[2];e.append(o,t.length>2?_("label").append(i):"")}return e}))))}));case 5:case"end":return t.stop()}}),t,this)})),r=function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(t){ee(i,n,o,a,s,"next",t)}function s(t){ee(i,n,o,a,s,"throw",t)}a(void 0)}))},function(t){return r.apply(this,arguments)})},{key:"options",value:function(t){return this._options=t,this}},{key:"position",value:function(t){return this._position=t,this}},{key:"rect",value:function(t){if(t){var e=this._position;this._rect=t,this._visible=!0;var r=t.x,n=t.y,o=t.width,i=r,a=n+t.height;"top-right"!==e&&"bottom-right"!==e||(i+=o-this._width),"top-right"!==e&&"top-left"!==e||(a-=this._height),this._.css({left:i,top:a,width:this._width,height:this._height})}return this}},{key:"show",value:function(){return this.query(""),Yt($t(l.prototype),"show",this).call(this),this}}]),l}(Zt),ie=function(){function t(e,r,n,o){s(this,t),f(this,"_rendererOptions",{}),f(this,"_copyable",!1),f(this,"_editable",!1),f(this,"_minRowHeight",25),f(this,"_minColWidth",60),f(this,"_contentRect",{x:0,y:0,width:0,height:0}),f(this,"_cells",new U),f(this,"_vScrollbar",null),f(this,"_hScrollbar",null),f(this,"_rowResizer",null),f(this,"_colResizer",null),f(this,"_editor",null),f(this,"_editors",new Map),f(this,"_selector",null),f(this,"_emitter",new pt),this._width=r,this._height=n;var i="string"==typeof e?document.querySelector(e):e;if(null===i)throw new Error("first argument error");if(this._container=_(i,"".concat(d,"-container")).css({height:n(),width:r()}),this._data={rows:{len:100},cols:{len:26},rowHeight:25,colWidth:100,scroll:[0,0,0,0],style:{color:"#333",align:"left",valign:"middle",textwrap:!1,bold:!1,italic:!1,fontFamily:"Roboto",fontSize:10,underline:!1,strikethrough:!1},styles:[],borders:[],merges:[],cells:[]},o){var a=o.minColWidth,l=o.minRowHeight,c=o.renderer,u=o.data;if(a&&(this._minColWidth=a),l&&(this._minRowHeight=l),c&&(this._rendererOptions=c),u){var h=u.cols,v=u.rows,y=u.rowHeight,g=u.colWidth,w=this._data;h&&(w.cols.len=h),v&&(w.rows.len=v),y&&(w.rowHeight=y),g&&(w.colWidth=g)}}var p=document.createElement("canvas");this._canvas=_(p).attr("tabIndex","1"),this._container.append(p),this._renderer=new Y(p,r(),n()),this._overlayer=new k(this._container),ae(this),null!=o&&o.selectable&&zt.init(this),null!=o&&o.scrollable&&Et.init(this),null!=o&&o.resizable&&Mt(this),null!=o&&o.editable&&(this._editable=!0),this._copyable=(null==o?void 0:o.copyable)||!1,this._editors.set("text",new Jt),this._editors.set("select",new oe),Bt(this)}return h(t,[{key:"contentRect",value:function(){return this._contentRect}},{key:"container",value:function(){return this._container}},{key:"resize",value:function(){this._container.css({height:this._height(),width:this._width()}),this.render()}},{key:"freeze",value:function(t){return this._data.freeze=t,this}},{key:"isMerged",value:function(t){var e=this;if(t)return J(this._data,t);var r=this._selector;return!!r&&r._ranges.every((function(t){return J(e._data,t.toString())}))}},{key:"merge",value:function(t){var e=this;if(t)tt(this._data,t);else{var r=this._selector;r&&r._ranges.forEach((function(t){return tt(e._data,t.toString())}))}return this}},{key:"unmerge",value:function(t){var e=this;if(t)et(this._data,t);else{var r=this._selector;r&&r._ranges.forEach((function(t){return et(e._data,t.toString())}))}return this}},{key:"row",value:function(t,e){return e?(e.height&&this.rowHeight(t,e.height),ht(this._data,t,e),this):ht(this._data,t)}},{key:"rowHeight",value:function(t,e){var r=ft(this._data,t);return e?(r!==e&&(ft(this._data,t,e),this._contentRect.height+=e-r),this):r}},{key:"rowsHeight",value:function(t,e){return dt(this._data,t,e)}},{key:"isLastRow",value:function(t){return function(t,e){return t.rows.len-1===e}(this._data,t)}},{key:"col",value:function(t,e){return e?(e.width&&this.colWidth(t,e.width),st(this._data,t,e),this):st(this._data,t)}},{key:"colWidth",value:function(t,e){var r=lt(this._data,t);return e?(r!==e&&(lt(this._data,t,e),this._contentRect.width+=e-r),this):r}},{key:"colsWidth",value:function(t,e){return ct(this._data,t,e)}},{key:"isLastCol",value:function(t){return function(t,e){return t.cols.len-1===e}(this._data,t)}},{key:"formulaParser",value:function(t){return this._cells.formulaParser(t),this}},{key:"formatter",value:function(t){return this._cells.formatter(t),this}},{key:"style",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=t.styles[e];return r?Object.assign({},t.style,t.styles[e]||{}):n}(this._data,t,e)}},{key:"addStyle",value:function(t){return at(this._data,t)}},{key:"clearStyles",value:function(){return this._data.styles.length=0,this}},{key:"addBorder",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return function(t,e){t.borders||(t.borders=[]);for(var r,n=P.with(e[0]),o=t.borders,i=function(){var t=g(o[a]),r=t[0],i=t.slice(1),s=P.with(r);return s.intersects(n)?(s.within(n)||(o.push(e),s.difference(n).forEach((function(t){o.push([t.toString()].concat(m(i)))}))),o.splice(a,1),{v:void 0}):i.every((function(t,r){return t===e[r+1]}))&&s.touches(n)?(o[a][0]=s.union(n).toString(),{v:void 0}):void 0},a=0;a<o.length;a+=1)if(r=i())return r.v;o.push(e)}(this._data,e),this}},{key:"clearBorder",value:function(t){return function(t,e){var r=t.borders;if(r){for(var n=[],o=P.with(e),i=function(t){var e=g(r[t]),i=e[0],s=e.slice(1),l=P.with(i);l.intersects(o)&&(l.within(o)||l.difference(o).forEach((function(t){n.push([t.toString()].concat(m(s)))})),r.splice(t,1),t-=1),a=t},a=0;a<r.length;a+=1)i(a);r.push.apply(r,n)}}(this._data,t),this}},{key:"clearBorders",value:function(){return this._data.borders.length=0,this}},{key:"cell",value:function(t,e,r){var n=this._cells;if(r)return n.set(t,e,r),this;var o=n.get(t,e);return null!=o?o[2]:o}},{key:"cellValue",value:function(t,e){return X(this.cell(t,e))}},{key:"cellValueString",value:function(t,e){return Q(this.cell(t,e))}},{key:"render",value:function(){var t=this,e=this._data,r=this._renderer,n=this._overlayer;for(var o in this._rendererOptions){var i=this._rendererOptions[o];i&&r[o](i)}r.scrollRows(e.scroll[0]).scrollCols(e.scroll[1]).merges(e.merges).freeze(e.freeze).styles(e.styles).borders(e.borders).rows(e.rows.len).cols(e.cols.len).row((function(t){return ht(e,t)})).col((function(t){return st(e,t)})).cell((function(e,r){return t.cell(e,r)})).formatter(this._cells._formatter).render();var a=r.viewport;return a&&(a.areas.forEach((function(t,e){n.area(e,t)})),a.headerAreas.forEach((function(t,e){n.headerArea(e,t)})),Et.resize(this)),this}},{key:"data",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){return t?(Object.assign(this._data,t),this._cells.load(this._data),ae(this),this):this._data}))},{key:"copy",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return this;var n=function(t,e){return{range:"string"==typeof t?P.with(t):t,cells:e._cells,data:e._data}},o=function(t){var e=t._selector;if(!e)return null;var r=e.currentRange;return void 0===r?null:n(r,t)};return function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t&&e){var n=t.range.position(e.range);if("none"!==n){var o=t.range,i=o.rows,a=o.cols;e.range.each((function(o,s){var l=t.range.startRow,c=t.range.startCol,u=void 0,h=void 0,f=[o-e.range.startRow,s-e.range.startCol];["up","left"].includes(n)&&(f=[e.range.endRow-o,e.range.endCol-s]),"down"===n||"up"===n?i<=0&&r&&(u=n,h=f[0]+1,"up"===n&&(h=0-h)):a<=0&&r&&(u=n,h=f[1]+1,"left"===n&&(h=0-h));var d=f[1]%(a+1),v=f[0]%(i+1);["up","left"].includes(n)?(l=t.range.endRow-v,c=t.range.endCol-d):(l+=v,c+=d),function(t,e,r,n,o,i,a,s){var l=o.cells.get(t,e);if(null!==l&&void 0!==l[2]&&null!==l[2]){var c=l[2];if(c instanceof Object){if(void 0!==(c=Object.assign({},c)).style&&o.cells!==i.cells){var u=Object.assign({},o.data.styles[c.style]);c.style=at(i.data,u)}void 0!==a&&void 0!==s&&(c.formula?c.formula=c.formula.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){return["left","top"].includes(a)?E(t,s,0):E(t,0,s)})):c.value&&(c.value=yt(c.value,s)))}else void 0!==s&&(c=yt(c,s));i.cells.set(r,n,c)}else i.cells.remove(t,e)}(l,c,o,s,t,e,u,h)}))}}}(o(this),e instanceof t?o(e):n(e,this),r),this}},{key:"fill",value:function(t,e){var r=this._selector,n=0,o=0;if(e){var i=a(O(e),2);o=i[0],n=i[1]}else{if(!r)return this;var s=a(r._focus,2);n=s[0],o=s[1]}var l=0,c=0;if(Array.isArray(t)){for(var u=0;u<t.length;u+=1){var h=t[u];c=o+h.length-1;for(var f=0;f<h.length;f+=1)this.cell(n+u,o+f,h[f])}l=n+t.length-1}else if("string"==typeof t){var d=function(t,e,r){var n=a(r,2),o=n[0],i=n[1],s=[0,0];if(e&&e.includes("</table>")){var l=t._data.style,c=document.createElement("template");c.innerHTML=e;var u=[],h=c.content.querySelectorAll("tr");s[0]=o+h.length-1;var f=[];if(h.forEach((function(e,r){var n=e.querySelectorAll("td");0===r&&(s[1]=i+n.length-1);for(var a=null,c=[],h=function(){var e=n[d],h=r+o,f=d+i;u.length>0&&u.forEach((function(t){t.containsRow(h)&&t.startCol<=f&&(f+=t.cols,t.startRow!==h&&(f+=1))}));var v=j(f,h),y=1,w=1;if(Vt(e,"rowspan",(function(t){return y=parseInt(t)})),Vt(e,"colspan",(function(t){return w=parseInt(t)})),y>1||w>1){var p=P.create(h,f,h+y-1,f+w-1);t.merge(p.toString()),u.push(p)}0===r&&(s[1]+=w-1);var _={};Nt(e,"background-color","",(function(t){return _.bgcolor=t})),Nt(e,"color",l.color,(function(t){return _.color=t})),Nt(e,"text-align",l.align,(function(t){return _.align=t})),Nt(e,"vertical-align",l.valign,(function(t){return _.valign=t})),Kt(e,"white-space","normal",(function(t){return _.textwrap=!0})),Kt(e,"text-decoration","underline",(function(t){return _.underline=!0})),Kt(e,"text-decoration","line-through",(function(t){return _.strikethrough=!0})),Kt(e,"font-style","italic",(function(t){return _.italic=!0})),Nt(e,"font-weight","normal",(function(t){("bold"===t||parseInt(t)>=700)&&(_.bold=!0)})),Nt(e,"font-family",l.fontFamily,(function(t){return _.fontFamily=t})),Nt(e,"font-size",l.fontSize,(function(t){return _.fontSize=parseInt(t)}));var b=function(t){var e,r=g(t.split(" ").map((function(t){return t.trim()}))),n=r[0],o=r[1],i=r.slice(2),a="thin";if("solid"===o){var s=parseInt(n);n.includes("pt")&&(s=(e=parseInt(n))<=.75?1:e<=1.5?2:e<=2.25?3:e<=3?4:e<=3.75?5:e<=4.5?6:96/72*e),2===s?a="medium":3===s&&(a="thick")}else a=o;return[a,i.join("")]},R=[],k=null;Nt(e,"border-width","",(function(t){return R.push(t)})),Nt(e,"border-style","",(function(t){return R.push(t)})),Nt(e,"border-color","",(function(t){return R.push(t)})),R.length>=3?k=[v,"all"].concat(m(b(R.join(" ")))):Nt(e,"border","none",(function(t){return k=[v,"all"].concat(m(b(t)))}))||["top","right","bottom","left"].forEach((function(t){Nt(e,"border-".concat(t),"none",(function(e){return k=[v,t].concat(m(b(e)))}))})),null===a?null!==k&&(a=k):null!==k&&k[1]===a[1]&&k[2]===a[2]&&k[3]===a[3]?a[0]="".concat(a[0].split(":")[0],":").concat(v):(c.push(a),a=k);var C=e.innerHTML.replace(/<br(\/){0,1}>/gi,"\n").replace(/(<([^>]+)>|)/gi,"").replace("&nbsp;"," "),x={};Object.keys(_).length>0&&(x.style=t.addStyle(_)),null===C||/^\s*$/.test(C)||(x.value=C),Object.keys(x).length>0&&t.cell(h,f,x)},d=0;d<n.length;d+=1)h();null!=a&&c.push(a);var v=f.at(-1);if(v&&v.length>0)if(1===v.length&&1===c.length&&"all"===v[0][1]&&v[0][1]===c[0][1]&&v[0][2]===c[0][2]&&v[0][3]===c[0][3]){var y=P.with(v[0][0]);y.endRow+=1,v[0][0]=y.toString()}else f.push(c);else f.push(c)})),f.length>0){var d,v=Ft(f);try{for(v.s();!(d=v.n()).done;)d.value.forEach((function(e){return t.addBorder.apply(t,m(e))}))}catch(t){v.e(t)}finally{v.f()}}}return s}(this,t,[n,o]),v=a(d,2);l=v[0],c=v[1]}return(l>0||c>0)&&(zt.unionRange(this,l,c),zt.reset(this)),this}},{key:"toHtml",value:function(t){return function(t,e){var r,n='<table xmlns="http://www.w3.org/1999/xhtml" style="border-spacing: 0; border-collapse: collapse;">',o=P.with(e),i=t._data.merges.map((function(t){return P.with(t)})).filter((function(t){return t.intersects(o)})),s=new Map,l=Ft(t._data.borders);try{var c=function(){var t=a(r.value,4),e=t[0],n=t[1],i=t[2],l=t[3],c=P.with(e);if(c.intersects(o)){var u=c.startRow,h=c.startCol,f=c.endRow,d=c.endCol;c.each((function(t,e){var r=function(t,e){return"dashed"===t||"dotted"===t?"1px ".concat(t," ").concat(e):"".concat("thick"===t?3:"medium"===t?2:1,"px solid ").concat(e)}(i,l),o=[];"all"===n&&o.push("border"),"outside"!==n&&"left"!==n||e===h&&o.push("border-left"),"outside"!==n&&"right"!==n||e===d&&o.push("border-right"),"outside"!==n&&"top"!==n||t===u&&o.push("border-top"),"outside"!==n&&"bottom"!==n||t===f&&o.push("border-bottom"),"inside"!==n&&"vertical"!==n||e>=h&&e<d&&o.push("border-right"),"inside"!==n&&"horizontal"!==n||t>=u&&t<f&&o.push("border-bottom"),o.length>0&&s.set("".concat(t,"_").concat(e),o.map((function(t){return"".concat(t,":").concat(r,";")})).join(""))}))}};for(l.s();!(r=l.n()).done;)c()}catch(t){l.e(t)}finally{l.f()}return n+="<colgroup>",o.eachCol((function(e){n+='<col width="'.concat(t.colWidth(e),'"/>')})),n+="</colgroup>",n+="<tbody>",o.eachRow((function(e){n+='<tr style="height: '.concat(t.rowHeight(e),'px;">'),o.eachCol((function(r){var o,a,l,c=t.cell(e,r),u=P.create(e,r),h=!1,f=1,d=1,v=Ft(i);try{for(v.s();!(o=v.n()).done;){var y=o.value;if(y.startRow===e&&y.startCol===r){f=y.rows+1,d=y.cols+1;break}if(y.intersects(u)){h=!0;break}}}catch(t){v.e(t)}finally{v.f()}if(!h){n+="<td",f>1&&(n+=' rowspan="'.concat(f,'"')),d>1&&(n+=' colspan="'.concat(d,'"'));var g="",w="".concat(e,"_").concat(r);s.has(w)&&(g+=s.get(w)),c&&c instanceof Object&&void 0!==c.style&&(g+=(l="",(a=t.style(c.style,!0)).bgcolor&&(l+="background-color: ".concat(a.bgcolor,";")),a.color&&(l+="color: ".concat(a.color,";")),a.align&&(l+="text-align: ".concat(a.align,";")),a.valign&&(l+="vertical-align: ".concat(a.valign,";")),!0===a.textwrap&&(l+="white-space: normal;"),!0===a.underline&&(l+="text-decoration: underline;"),!0===a.strikethrough&&(l+="text-decoration: line-through;"),!0===a.bold&&(l+="font-weight: bold;"),!0===a.italic&&(l+="font-style: italic;"),a.fontFamily&&(l+="font-family: ".concat(a.fontFamily,";")),a.fontSize&&(l+="font-size: ".concat(a.fontSize,"pt;")),l)),""!==g&&(n+=' style="'.concat(g,'"')),n+=">".concat(t.cellValueString(e,r),"</td>")}})),n+="</tr>"})),n+"</tbody></table>"}(this,t)}},{key:"toArrays",value:function(t){var e=this,r=P.with(t),n=[];return r.eachRow((function(t){var o=[];r.eachCol((function(r){o.push(e.cellValue(t,r))})),n.push(o)})),n}},{key:"onClick",value:function(t){return this._emitter.on("click",t),this}},{key:"addEditor",value:function(t,e){return this._editors.set(t,e),this}}],[{key:"create",value:function(e,r,n,o){return new t(e,r,n,o)}}]),t}();function ae(t){t._contentRect={x:t._renderer._rowHeader.width,y:t._renderer._colHeader.height,width:ct(t._data),height:dt(t._data)}}window&&(window.gosheet=window.gosheet||{},window.gosheet.spreadsheet=ie.create)})(),module.exports=n})();